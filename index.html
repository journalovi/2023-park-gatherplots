<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Deokgun Park">
<meta name="author" content="Sung-Hee Kim">
<meta name="author" content="Niklas Elmqvist">

<title>Gatherplot: A Non-Overlapping Scatterplot</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script type="module" src="index_files/libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="index_files/libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#intro" id="toc-intro" class="nav-link active" data-scroll-target="#intro"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background"><span class="header-section-number">2</span> Background</a>
  <ul class="collapse">
  <li><a href="#appearance-based-methods" id="toc-appearance-based-methods" class="nav-link" data-scroll-target="#appearance-based-methods">Appearance-based Methods</a></li>
  <li><a href="#distortion-based-methods" id="toc-distortion-based-methods" class="nav-link" data-scroll-target="#distortion-based-methods">Distortion-based Methods</a></li>
  <li><a href="#data-aware-methods" id="toc-data-aware-methods" class="nav-link" data-scroll-target="#data-aware-methods">Data-aware Methods</a></li>
  <li><a href="#visualizing-categorical-variables" id="toc-visualizing-categorical-variables" class="nav-link" data-scroll-target="#visualizing-categorical-variables">Visualizing Categorical Variables</a></li>
  </ul></li>
  <li><a href="#gather" id="toc-gather" class="nav-link" data-scroll-target="#gather"><span class="header-section-number">3</span> The Gather Transformation</a>
  <ul class="collapse">
  <li><a href="#definition-the-gather-transformation" id="toc-definition-the-gather-transformation" class="nav-link" data-scroll-target="#definition-the-gather-transformation">Definition: The Gather Transformation</a></li>
  <li><a href="#using-the-gather-transformation" id="toc-using-the-gather-transformation" class="nav-link" data-scroll-target="#using-the-gather-transformation">Using the Gather Transformation</a></li>
  </ul></li>
  <li><a href="#gatherplots" id="toc-gatherplots" class="nav-link" data-scroll-target="#gatherplots"><span class="header-section-number">4</span> Gatherplots: A 2D Gathering Representation</a>
  <ul class="collapse">
  <li><a href="#layout" id="toc-layout" class="nav-link" data-scroll-target="#layout">Layout</a></li>
  <li><a href="#managing-continuous-variables" id="toc-managing-continuous-variables" class="nav-link" data-scroll-target="#managing-continuous-variables">Managing Continuous Variables</a></li>
  <li><a href="#undefined-axis-mapping" id="toc-undefined-axis-mapping" class="nav-link" data-scroll-target="#undefined-axis-mapping">Undefined Axis Mapping</a></li>
  <li><a href="#visual-design" id="toc-visual-design" class="nav-link" data-scroll-target="#visual-design">Visual Design</a></li>
  <li><a href="#interaction" id="toc-interaction" class="nav-link" data-scroll-target="#interaction">Interaction</a></li>
  <li><a href="#implementation-1" id="toc-implementation-1" class="nav-link" data-scroll-target="#implementation-1">Implementation</a></li>
  </ul></li>
  <li><a href="#sec-eval" id="toc-sec-eval" class="nav-link" data-scroll-target="#sec-eval"><span class="header-section-number">5</span> Evaluation</a>
  <ul class="collapse">
  <li><a href="#experimental-design" id="toc-experimental-design" class="nav-link" data-scroll-target="#experimental-design">Experimental Design</a></li>
  <li><a href="#participants" id="toc-participants" class="nav-link" data-scroll-target="#participants">Participants</a></li>
  <li><a href="#task" id="toc-task" class="nav-link" data-scroll-target="#task">Task</a></li>
  <li><a href="#dataset" id="toc-dataset" class="nav-link" data-scroll-target="#dataset">Dataset</a></li>
  <li><a href="#hypotheses" id="toc-hypotheses" class="nav-link" data-scroll-target="#hypotheses">Hypotheses</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion"><span class="header-section-number">6</span> Discussion</a></li>
  <li><a href="#conclusion-and-future-work" id="toc-conclusion-and-future-work" class="nav-link" data-scroll-target="#conclusion-and-future-work"><span class="header-section-number">7</span> Conclusion and Future Work</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#research-material-statements" id="toc-research-material-statements" class="nav-link" data-scroll-target="#research-material-statements">Research Material Statements</a></li>
  <li><a href="#authorship" id="toc-authorship" class="nav-link" data-scroll-target="#authorship">Authorship</a></li>
  <li><a href="#license" id="toc-license" class="nav-link" data-scroll-target="#license">License</a></li>
  <li><a href="#conflict-of-interest" id="toc-conflict-of-interest" class="nav-link" data-scroll-target="#conflict-of-interest">Conflict of Interest</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Gatherplot: A Non-Overlapping Scatterplot</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Deokgun Park <a href="mailto:deokgun.park@uta.edu" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0003-0054-9944" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of Texas at Arlington
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Sung-Hee Kim <a href="mailto:sungheekim02@gmail.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0002-9716-8349" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Dong-eui University
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Niklas Elmqvist <a href="mailto:elm@cs.au.dk" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0001-5805-5301" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Aarhus University
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  


</header>


<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Under Review
</div>
</div>
<div class="callout-body-container callout-body">
<p>This paper is under review on the experimental track of the <a href="https://www.journalovi.org/">Journal of Visualization and Interaction</a>.</p>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Abstract
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<section id="introduction" class="level6">
<h6 class="anchored" data-anchor-id="introduction">Introduction</h6>
<p>Scatterplots are a common tool for exploring multidimensional datasets, especially in the form of scatterplot matrices (SPLOMs). However, scatterplots suffer from overplotting when categorical variables are mapped to one or two axes, or the same continuous variable is used for both axes. Previous methods such as histograms or violin plots use aggregation, which makes brushing and linking difficult.</p>
</section>
<section id="conclusion" class="level6">
<h6 class="anchored" data-anchor-id="conclusion">Conclusion</h6>
<p>We propose gatherplots, an extension of scatterplots to manage the overplotting problem. Gatherplots are a form of <em>unit visualization</em>, which avoid aggregation and maintain the identity of individual objects to ease visual perception. In gatherplots, every visual mark that maps to the same position coalesces to form a packed entity, thereby making it easier to see the overview of data groupings. The size and aspect ratio of marks can also be changed dynamically to make it easier to compare the composition of different groups. In the case of a categorical variable vs.&nbsp;a categorical variable, we propose a heuristic to decide bin sizes for optimal space usage. Results from a crowdsourced user study show that gatherplots enable people to assess data distribution more correctly than when using jittered scatterplots.</p>
</section>
<section id="materials" class="level6">
<h6 class="anchored" data-anchor-id="materials">Materials</h6>
<p>Source code for Gatherplots can be found at <a href="https://github.com/intuinno/gatherplot">https://github.com/intuinno/gatherplot</a>. Research materials associated with the crowdsourced user study can be found on OSF at <a href="https://osf.io/bk9cx/">https://osf.io/bk9cx/</a>.</p>
</section>
<section id="data-collection" class="level6">
<h6 class="anchored" data-anchor-id="data-collection">Data Collection</h6>
<p>We conducted a crowdsourced user study on <a href="https://www.mturk.com/">Amazon Mechanical Turk</a> involving participants drawn from the general population. We collected completion time, accuracy, and confidence for five different retrieval, ranking, and comparison tasks under four conditions: scatterplots with jittering, gatherplots with absolute mode, gatherplots with normalized mode, and gatherplots with a toggle to switch between absolute and normalized mode.</p>
</section>
<section id="data-analysis" class="level6">
<h6 class="anchored" data-anchor-id="data-analysis">Data Analysis</h6>
<p>Data collected from the crowdsourced survey were analyzed with respect to the accuracy (correct or incorrect), time spent, and confidence of estimation. Based on our hypotheses, we analyzed the different modes of layout for each type of question: retrieve value, absolute value task, and relative value task.</p>
</section>
<section id="analysis-results" class="level6">
<h6 class="anchored" data-anchor-id="analysis-results">Analysis Results</h6>
<p>Gatherplots outperform jittering for accuracy as well as for the subjective confidence measure.</p>
</section>
<section id="implementation" class="level6">
<h6 class="anchored" data-anchor-id="implementation">Implementation</h6>
<p>We implemented a web-based demonstration of Gatherplots using <a href="https://d3js.org/">D3</a> as well as using <a href="https://observablehq.com/">Observable JS</a> in this article.</p>
</section>
<section id="demonstration" class="level6">
<h6 class="anchored" data-anchor-id="demonstration">Demonstration</h6>
<p>Beyond the embedded demonstration in this article, you can also find a live demo of Gatherplots at <a href="https://gatherplot.firebaseapp.com/">https://gatherplot.firebaseapp.com/</a>.</p>
</section>
</div>
</div>
</div>
<!-- Teaser -->
<div id="fig-teaser" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-teaser-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-teaser" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-teaser1" class="accessible-fig quarto-figure quarto-figure-center quarto-float anchored" alt="Gatherplot showing MPG on the Y axis and Cylinders on the X axis for a car dataset of some 400 datapoints. Color is used to show three different origins: US (blue), Europe (orange), and Asia (green). The data is gathered in regular grids for each of the cylinder values clearly showing the distribution: four-cylinder cars have fairly uniform gas mileage, whereas six and eight-cylinder cars have lower gas mileage.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-teaser1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/teaser-1.svg" class="accessible-fig img-fluid figure-img" data-ref-parent="fig-teaser" alt="Gatherplot showing MPG on the Y axis and Cylinders on the X axis for a car dataset of some 400 datapoints. Color is used to show three different origins: US (blue), Europe (orange), and Asia (green). The data is gathered in regular grids for each of the cylinder values clearly showing the distribution: four-cylinder cars have fairly uniform gas mileage, whereas six and eight-cylinder cars have lower gas mileage.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-teaser1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Cylinders vs.&nbsp;MPG.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-teaser" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-teaser2" class="accessible-fig quarto-figure quarto-figure-center quarto-float anchored" alt="Gatherplot showing Origin on the Y axis and Cylinders on the X axis for a car dataset of some 400 datapoints. A blue-white color scale is used to show gas mileage. The data is gathered in regular grids for each of the three origins and four cylinder values (4, 5, 6, 8). The grid cells show the data distrbution: all eight cylinder cars are from the U.S., and high cylinder count seems to lead to lower gas mileage.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-teaser2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/teaser-2.svg" class="accessible-fig img-fluid figure-img" data-ref-parent="fig-teaser" alt="Gatherplot showing Origin on the Y axis and Cylinders on the X axis for a car dataset of some 400 datapoints. A blue-white color scale is used to show gas mileage. The data is gathered in regular grids for each of the three origins and four cylinder values (4, 5, 6, 8). The grid cells show the data distrbution: all eight cylinder cars are from the U.S., and high cylinder count seems to lead to lower gas mileage.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-teaser2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Cylinders vs.&nbsp;Origin.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-teaser" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-teaser3" class="accessible-fig quarto-figure quarto-figure-center quarto-float anchored" alt="Gatherplot showing MPG on both the Y and X axis for a car dataset of some 400 datapoints. olor is used to show three different origins: US (blue), Europe (orange), and Asia (green). Because both X and Y axes use the same categorical mapping, the data is gathered together without overplotting to show that there are many cars with low gas mileage, and most of the low-mileage cars are from the United States.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-teaser3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/teaser-3.svg" class="accessible-fig img-fluid figure-img" data-ref-parent="fig-teaser" alt="Gatherplot showing MPG on both the Y and X axis for a car dataset of some 400 datapoints. olor is used to show three different origins: US (blue), Europe (orange), and Asia (green). Because both X and Y axes use the same categorical mapping, the data is gathered together without overplotting to show that there are many cars with low gas mileage, and most of the low-mileage cars are from the United States.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-teaser3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) MPG vs.&nbsp;MPG.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-teaser-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: <strong>Cars dataset.</strong> Gatherplots showing a dataset related to cars, yielding overplotting in normal scatterplots. The gatherplot in <a href="#fig-teaser1" class="quarto-xref">1 (a)</a> shows Cylinders (categorical) vs.&nbsp;MPG (continuous), highlighting the overall distribution of MPG values of cars with different cylinders. The brackets on the X-axis are used to indicate that the interval within the brackets represent the same value in the data. The gatherplot in <a href="#fig-teaser2" class="quarto-xref">1 (b)</a> shows <code>Cylinders</code> (categorical) vs.&nbsp;<code>Origin</code> (categorical), partitioning the graphical axes into intervals and packing points into groups for each interval. In <a href="#fig-teaser3" class="quarto-xref">1 (c)</a>, both X-axis and Y-axis show the same continuous variable (MPG). All these cases would have caused overplotting for a scatterplot, resulting in dot-shaped or line-shaped point patterns where individual points cannot be identified.
</figcaption>
</figure>
</div>
<!-- ========================================================================== -->
<section id="intro" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="intro"><span class="header-section-number">1</span> Introduction</h2>
<p>Scatterplots—one of the most common types of statistical graphics <span class="citation" data-cites="Cleveland1988 Elmqvist2008 Utts1996">(<a href="#ref-Cleveland1988" role="doc-biblioref">Cleveland and McGill 1988</a>; <a href="#ref-Elmqvist2008" role="doc-biblioref">Elmqvist, Dragicevic, and Fekete 2008</a>; <a href="#ref-Utts1996" role="doc-biblioref">Utts 1996</a>)</span>—are often used to visualize two continuous variables using visual marks mapped to a two-dimensional Cartesian space, where the color, size, and shape of the marks can represent additional dimensions. It can also be used for exploring multidimensional datasets in the form of scatterplot matrices (SPLOM), where all the possible combinations of axes are presented in table form. However, scatterplots are so-called <em>overlapping visualizations</em> <span class="citation" data-cites="Fekete2002">(<a href="#ref-Fekete2002" role="doc-biblioref">Fekete and Plaisant 2002</a>)</span> in that the visual marks representing individual data points may begin to overlap each other in screen space in situations when the marks are large, when there is insufficient screen space to fit all the data at the desired resolution, or simply when several data points share the same value. In fact, realistic multidimensional datasets often contain categorical variables, such as nominal variables or discrete data dimensions with a small domain, which lead to many data points being mapped to the exact same screen position. This kind of overlap is known as <em>overplotting</em> (or <em>overdrawing</em>) in visualization, and is problematic because it may lead to data points being entirely hidden by other points, which in turn may lead to the viewer making incorrect assessments of the data. As can be seen in <a href="#fig-scatter-problems" class="quarto-xref">Figure&nbsp;2</a>, there are three situations for mapping variables to axes in scatterplots when overplotting is inevitable:</p>
<ul>
<li>Plotting <strong>categorical vs.&nbsp;continuous variables</strong> gives rise to line patterns (<a href="#fig-scatter-problems" class="quarto-xref">Figure&nbsp;2</a>(a));</li>
<li>Plotting <strong>categorical vs.&nbsp;categorical variables</strong> gives rise to single dot patterns (<a href="#fig-scatter-problems" class="quarto-xref">Figure&nbsp;2</a>(b)); and</li>
<li>Plotting the <strong>same continuous variable on both axes</strong> gives rise to diagonal line patterns (<a href="#fig-scatter-problems" class="quarto-xref">Figure&nbsp;2</a>(c)).</li>
</ul>
<div id="fig-scatter-problems" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-problems-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell panel-input card bg-light p-2">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="127" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 126;"><span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>viewof problem <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>(problems<span class="op">,</span> {<span class="dt">format</span><span class="op">:</span> x <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">name</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> problems<span class="op">.</span><span class="fu">find</span>(t <span class="kw">=&gt;</span> t<span class="op">.</span><span class="at">name</span> <span class="op">===</span> <span class="st">"(a) Line patterns"</span>)})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="132" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 131;"><span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>problems <span class="op">=</span> [</span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">name</span><span class="op">:</span> <span class="st">'(a) Line patterns'</span><span class="op">,</span> <span class="dt">carX</span><span class="op">:</span> <span class="st">'Cylinders'</span><span class="op">,</span> <span class="dt">carY</span><span class="op">:</span> <span class="st">'MPG'</span>}<span class="op">,</span> </span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">name</span><span class="op">:</span> <span class="st">'(b) Dot patterns'</span><span class="op">,</span> <span class="dt">carX</span><span class="op">:</span> <span class="st">'Cylinders'</span><span class="op">,</span> <span class="dt">carY</span><span class="op">:</span> <span class="st">'Cylinders'</span>}<span class="op">,</span></span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">name</span><span class="op">:</span> <span class="st">'(c) Diagonal patterns'</span><span class="op">,</span> <span class="dt">carX</span><span class="op">:</span> <span class="st">'MPG'</span><span class="op">,</span> <span class="dt">carY</span><span class="op">:</span> <span class="st">'MPG'</span>}</span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>]<span class="op">;</span></span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a>  <span class="dt">inset</span><span class="op">:</span> <span class="dv">8</span><span class="op">,</span></span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a>  <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>  <span class="dt">color</span><span class="op">:</span> {</span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a>    <span class="dt">legend</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">dot</span>(cars<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> problem<span class="op">.</span><span class="at">carX</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> problem<span class="op">.</span><span class="at">carY</span><span class="op">,</span> <span class="dt">r</span><span class="op">:</span> <span class="dv">8</span> })</span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-problems-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: <strong>Scatterplot problems.</strong> Interactive scatterplot visualizing a car dataset with one continuous variable <code>MPG</code> and one categorical variable <code>Cylinders</code> showing limitations of scatterplots when plotting categorical variables on one or both axes.
</figcaption>
</figure>
</div>
<p>Several approaches have been proposed to address this problem <span class="citation" data-cites="Ellis2007">(<a href="#ref-Ellis2007" role="doc-biblioref">Ellis and Dix 2007</a>)</span>, the most prominent being transparency, jittering, and clustering techniques. The first, changing transparency, does not so much address the problem as sidestep it by making the visual marks semi-transparent so that an accumulation of overlapping points are still visible. However, this does not scale for large datasets, and also causes blending issues if color is used to encode additional variables. Jittering perturbs visual marks using a random displacement <span class="citation" data-cites="Trutschl2003">(<a href="#ref-Trutschl2003" role="doc-biblioref">Trutschl, Grinstein, and Cvek 2003</a>)</span> so that no mark falls on the exact same screen location as any other mark, but this approach is still prone to overplotting for large data. It also introduces uncertainty that is not aptly communicated by the scatterplot since marks will no longer be placed at their true location on the Cartesian space. Other approaches still attempt to organize overlapping marks into visual groups that summarize their distribution, such as histograms, violin plots, and kernel density estimation (KDE) plots <span class="citation" data-cites="Fua1999 Mayorga2013 Im2013">(<a href="#ref-Fua1999" role="doc-biblioref">Fua, Ward, and Rundensteiner 1999</a>; <a href="#ref-Mayorga2013" role="doc-biblioref">Mayorga and Gleicher 2013</a>; <a href="#ref-Im2013" role="doc-biblioref">Im, McGuffin, and Leung 2013</a>)</span>. However, this comes at the cost of losing the identity of individual points, which can be problematic when filtering or searching; e.g, brushing data points is difficult in histograms <span class="citation" data-cites="Im2013">(<a href="#ref-Im2013" role="doc-biblioref">Im, McGuffin, and Leung 2013</a>)</span>.</p>
<p>In this paper, we propose the concept of <em>gathering</em> as an alternative to scattering and jittering, and then show how we can use this visual transformation to define a novel visualization technique called a <em>gatherplot</em>. The gatherplot is an instance of a recently recognized family of visualization techniques called <em>unit visualizations</em> <span class="citation" data-cites="Park2018">(<a href="#ref-Park2018" role="doc-biblioref">Park et al. 2018</a>)</span> that maintain a strict mapping between every data item and its unique visual mark, improving the understandability over aggregated representations as well as enabling more natural interactions. Gathering is a generalization of the linear mapping used by scatterplots, and works by first partitioning the graphical axis into segments based on the data dimension and then organizing points into <em>packed groups</em> for each segment to avoid overplotting. This means that the gather operation relaxes the continuous spatial mapping commonly used for a graphical axis; instead, each discrete segment occupies a certain interval of screen space that maps to the same data value. This is communicated using graphical brackets on the axis that shows the value or interval for each segment (<a href="#fig-teaser" class="quarto-xref">Figure&nbsp;1</a>(b)).</p>
<p>The contributions of our paper are the following: (1) the gatherplot technique that applies the gather operation to scatterplots to mitigate overplotting; and (2) results from a crowdsourced graphical perception study on the effectiveness of gatherplots.</p>
<p>Next in this paper, we review the literature on statistical graphics and overplotting. We then present the gather operation and use it to define gatherplots. We describe our implementation, followed by our crowdsourced evaluation. We finally describe the GatherLens technique. We close with conclusions and our future plans.</p>
<!-- ========================================================================== -->
</section>
<section id="background" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="background"><span class="header-section-number">2</span> Background</h2>
<p>Scatterplots are classic statistical data graphics with many design variations to address challenges of scale, complexity, and specific tasks <span class="citation" data-cites="DBLP:journals/tvcg/SarikayaG18">(<a href="#ref-DBLP:journals/tvcg/SarikayaG18" role="doc-biblioref">Sarikaya and Gleicher 2018</a>)</span>. Our goal with gatherplots is to generalize scatterplots to a representation that maintains its simplicity and familiarity while eliminating overplotting. Partial or complete overplotting generally leads to visual clutter. Ellis and Dix <span class="citation" data-cites="Ellis2007">(<a href="#ref-Ellis2007" role="doc-biblioref">Ellis and Dix 2007</a>)</span> survey the literature and derive a general approach to reduce clutter. According to their treatment, there are three ways to reduce clutter in a visualization: by changing the visual appearance, by distorting visual space, or by presenting data over time. Some trivial but impractical mechanisms they list include decreasing mark size, increasing display space, or animating the data. Below we review more practical approaches based on appearance and distortion.</p>
<section id="appearance-based-methods" class="level3">
<h3 class="anchored" data-anchor-id="appearance-based-methods">Appearance-based Methods</h3>
<p>Practical appearance-based approaches to mitigate overplotting include transparency, sampling, kernel density estimation (KDE), and aggregation. Transparency changes the opacity of the visual marks, and has been shown to convey overlap for up to five occurrences <span class="citation" data-cites="Zhai1996">(<a href="#ref-Zhai1996" role="doc-biblioref">Zhai, Buxton, and Milgram 1996</a>)</span>. However, there is still an upper limit for how much overlap is perceptible to the user, and the blending caused by overlapping marks of different colors makes identifying colors difficult.</p>
<p><em>Sampling</em> uses stochastic methods to statistically reduce the data size to visualize <span class="citation" data-cites="Dix2002">(<a href="#ref-Dix2002" role="doc-biblioref">Dix and Ellis 2002</a>)</span>. This may reduce the amount of overplotting, but since the sampling is random, it cannot be reliably eliminated. Furthermore, one of the core strengths of a scatterplot is its ability to show outliers effectively, whereas sampling will likely eliminate all outliers (due to the intrinsic nature of an outlier).</p>
<p>Aggregation methods can also mitigate overplotting. KDE <span class="citation" data-cites="Silverman1986">(<a href="#ref-Silverman1986" role="doc-biblioref">Silverman 1986</a>)</span> and other binned aggregations <span class="citation" data-cites="Elmqvist2010 Fua1999 Mayorga2013 Im2013">(<a href="#ref-Elmqvist2010" role="doc-biblioref">Elmqvist and Fekete 2010</a>; <a href="#ref-Fua1999" role="doc-biblioref">Fua, Ward, and Rundensteiner 1999</a>; <a href="#ref-Mayorga2013" role="doc-biblioref">Mayorga and Gleicher 2013</a>; <a href="#ref-Im2013" role="doc-biblioref">Im, McGuffin, and Leung 2013</a>)</span> replace a cluster of marks with a single entity that has a distinct visual representation. Similarly, splatterplots <span class="citation" data-cites="Mayorga2013">(<a href="#ref-Mayorga2013" role="doc-biblioref">Mayorga and Gleicher 2013</a>)</span> combine individual marks with aggregated entities, using marks to show outliers and aggregated entities to show the general trends. While aggregation techniques are effective against overplotting for continuous variables, they fare poorly for categorical ones. Therefore, the generalized plot matrices (GPLOMs) <span class="citation" data-cites="Im2013">(<a href="#ref-Im2013" role="doc-biblioref">Im, McGuffin, and Leung 2013</a>)</span> were proposed to solve this particular problem by adopting non-homogeneous plots into a matrix. The technique uses a histogram for categorical vs.&nbsp;continuous variables, and a treemap for categorical vs.&nbsp;categorical variables. While effective in providing overview, aggregated techniques sacrifice some compatibility with scatterplots since they no longer maintain object identity, meaning that each visual mark no longer represents a single data point.</p>
<div id="fig-jittering" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-jittering-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell panel-input card bg-light p-2">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="206" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 205;"><span id="cb3-206"><a href="#cb3-206" aria-hidden="true" tabindex="-1"></a>viewof jitterValue <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">32</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">16</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">1.0</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Amount of jitter"</span>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="210" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 209;"><span id="cb4-210"><a href="#cb4-210" aria-hidden="true" tabindex="-1"></a>jitter <span class="op">=</span> <span class="fu">Scatterplot</span>(cars<span class="op">,</span> {</span>
<span id="cb4-211"><a href="#cb4-211" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> d <span class="kw">=&gt;</span> d[<span class="st">'Cylinders'</span>]<span class="op">,</span></span>
<span id="cb4-212"><a href="#cb4-212" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> d <span class="kw">=&gt;</span> d[<span class="st">'Displacement'</span>]<span class="op">,</span></span>
<span id="cb4-213"><a href="#cb4-213" aria-hidden="true" tabindex="-1"></a>  <span class="dt">c</span><span class="op">:</span> d <span class="kw">=&gt;</span> d[<span class="st">'Origin'</span>]<span class="op">,</span></span>
<span id="cb4-214"><a href="#cb4-214" aria-hidden="true" tabindex="-1"></a>  <span class="dt">jitter</span><span class="op">:</span> () <span class="kw">=&gt;</span> (<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">-</span><span class="fl">0.5</span>) <span class="op">*</span> jitterValue<span class="op">,</span></span>
<span id="cb4-215"><a href="#cb4-215" aria-hidden="true" tabindex="-1"></a>  width<span class="op">,</span></span>
<span id="cb4-216"><a href="#cb4-216" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="dv">600</span></span>
<span id="cb4-217"><a href="#cb4-217" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-jittering-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: <strong>Interactive jittering scatterplots.</strong> Jittering (i.e., randomly displacing) the points in a scatterplot to reduce overplotting caused by categorical axes; in this case, the horizontal axis is mapped to <code>Cylinders</code> and the vertical to <code>Displacement</code> in a car dataset.
</figcaption>
</figure>
</div>
</section>
<section id="distortion-based-methods" class="level3">
<h3 class="anchored" data-anchor-id="distortion-based-methods">Distortion-based Methods</h3>
<p>Distortion-based techniques avoid overplotting by changing the spatial mapping of the space and have the advantage to keep the identity of individual data points. The canonical distortion technique is <em>jittering</em>, where a random displacement is used to subtly modify the exact screen space position of a data point (<a href="#fig-jittering" class="quarto-xref">Figure&nbsp;3</a>). This has the effect of spreading data points apart so that they are easier to distinguish. However, naïve jittering mechanisms apply the displacement indiscriminately to all data points, regardless of whether they are overlapping or not. This has the drawback of distorting points away from their true location on the visual canvas, and still does not completely eliminate overplotting.</p>
<p>Bezerianos et al. <span class="citation" data-cites="Bezerianos2010">(<a href="#ref-Bezerianos2010" role="doc-biblioref">2010</a>)</span> use a more structured approach to displacement, where overlapping marks are organized onto the perimeter of a circle. The circle is grown to a radius so that all marks fit, which means that its size is also an indication of the number of grouped points. However, this mechanism still introduces uncertainty in the spatial mapping, and it is also not clear how well it scales for very dense data, as this can lead to a circle of arbitrarily large size. Nevertheless, the approach is a good example of how deterministic displacement can be used to great effect for eliminating overplotting.</p>
<p>Trutschl et al. <span class="citation" data-cites="Trutschl2003">(<a href="#ref-Trutschl2003" role="doc-biblioref">2003</a>)</span> propose a deterministic displacement (“smart jittering”) that adds meaning to the jittered position based on clustering results. This makes it easier to understand the resulting spatial display.</p>
</section>
<section id="data-aware-methods" class="level3">
<h3 class="anchored" data-anchor-id="data-aware-methods">Data-aware Methods</h3>
<p>The most advanced and effective overplotting mitigations are data-aware, in that they determine instances of overplotting in a chart. As a case in point, recent work by Chen et al. <span class="citation" data-cites="Chen2018">(<a href="#ref-Chen2018" role="doc-biblioref">2018</a>)</span> use animation to cycle the depth value of overlapping points in a scatterplot over time to ensure that every point is shown on top at some point in the rotation. This means that overplotting is alleviated by the notion of “guaranteed visibility over time” <span class="citation" data-cites="Munzner2003">(<a href="#ref-Munzner2003" role="doc-biblioref">Munzner et al. 2003</a>)</span> presented by Munzner et al. However, a common criticism for techniques designed to mitigate overplotting is that often do not scale to large dataset scales.</p>
<p>Shneiderman et al.<span class="citation" data-cites="Shneiderman2000">(<a href="#ref-Shneiderman2000" role="doc-biblioref">2000</a>)</span> propose a data-aware structured displacement approach called <em>hieraxes</em>, which combines hierarchical browsing with two-dimensional scatterplots. In hieraxes, a two-dimensional visual space is subdivided into rectangular segments for different categories in the data, and points are then coalesced into stacked groups inside the different segments. This work inspired gatherplots, which refines the layout and design of hieraxes further.</p>
<p>Microsoft’s SandDance <span class="citation" data-cites="Sanddance">(<a href="#ref-Sanddance" role="doc-biblioref">Microsoft Research 2011</a>)</span> use atomic visual marks as the building block of a highly interactive and visual interface built on smooth transitions between different spatial mappings. Drawing on an older experimental tool called Pivot from Microsoft Live Labs, SandDance now exists as a custom visual in the <a href="https://www.microsoft.com/en-us/garage/profiles/sanddance/">Microsoft Power BI tool</a>.</p>
<p>Keim et al. <span class="citation" data-cites="DBLP:journals/ivs/KeimHDJB10">(<a href="#ref-DBLP:journals/ivs/KeimHDJB10" role="doc-biblioref">2010</a>)</span> propose <em>generalized scatterplots</em> that use a data-aware combination of overlapping and distortion to avoid overplotting in a scatterplot display. By balancing the overlapping and distortion, the user can achieve a display that conforms to their prior familiarity with scatterplots while retaining minimal occlusion and appropriate distortion of data points. However, in contrast, our gatherplot approach instead balances legibility and visual accuracy (the deviation from the true mapped position of a point). While gatherplots thus yield better legibility, they are also less visually scalable as well as accurate.</p>
<p>Hieraxes <span class="citation" data-cites="Shneiderman1996">(<a href="#ref-Shneiderman1996" role="doc-biblioref">Shneiderman 1996</a>)</span>, SandDance <span class="citation" data-cites="Sanddance">(<a href="#ref-Sanddance" role="doc-biblioref">Microsoft Research 2011</a>)</span>, and gatherplots (that we present in this paper) are all examples of a recently recognized family of visualizations called <em>unit visualizations</em> <span class="citation" data-cites="Park2018">(<a href="#ref-Park2018" role="doc-biblioref">Park et al. 2018</a>)</span> where the relation between data items and their mark is explicitly maintained. This identity property between data and display is exemplified in visualizations such as unit charts, dotplots, and scatterplots. It can be contrasted with <em>aggregated visualizations</em> that combine multiple data items intop a single visual mark, such as barcharts, piecharts, and histograms. Our gatherplots technique shows how a unit visualization can be designed, evaluated, and even deployed from the ground up based on unit visualization principles.</p>
<p>It is worth comparing gatherplots to ur own prior work on the Atom <span class="citation" data-cites="Park2018">(<a href="#ref-Park2018" role="doc-biblioref">Park et al. 2018</a>)</span> grammar for unit visualization.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Atom is a general-purpose visualization grammar with gathering (packing with no overlap) as one of the visual layout options. In other words, the gatherplots technique can be more or less replicated using Atom. However, our focus in this paper is on specialized design aspects of gatherplots, including the interval marks, streamgraph layout, and layout modes. Also, where Atom is merely a grammar, this paper contributes a detailed user study involving the gatherplots technique in comparison to jittering.</p>
</section>
<section id="visualizing-categorical-variables" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-categorical-variables">Visualizing Categorical Variables</h3>
<p>While we have already ascertained that scatterplots are not optimal for categorical variables, there exists a multitude of visualization techniques that have been specifically designed for such data <span class="citation" data-cites="Bederson2002 Hofmann2000 Kosara2006">(<a href="#ref-Bederson2002" role="doc-biblioref">Bederson, Shneiderman, and Wattenberg 2002</a>; <a href="#ref-Hofmann2000" role="doc-biblioref">Hofmann, Siebes, and Wilhelm 2000</a>; <a href="#ref-Kosara2006" role="doc-biblioref">Kosara, Bendix, and Hauser 2006</a>)</span>. Simplest among them are histograms, which visualize the item count for each categorical value <span class="citation" data-cites="Stevens1946">(<a href="#ref-Stevens1946" role="doc-biblioref">Stevens 1946</a>)</span>. Boxplots and violin plots show the distribution of continuous variables over categorical variables <span class="citation" data-cites="Wickham2011">(<a href="#ref-Wickham2011" role="doc-biblioref">Wickham and Stryjewski 2011</a>)</span>. While hieraxes, histograms, and treemaps are effective in dealing with categorical variables, it is difficult to extend these to continuous vs.&nbsp;categorical variables. One way is to apply binning to continuous variables to create groups of values. However, the optimal number of bins depends on statistical characteristics of the data and the required task. Dot plots by Wilkinson <span class="citation" data-cites="Wilkinson1999">(<a href="#ref-Wilkinson1999" role="doc-biblioref">1999</a>)</span> renders continuous univariate variables without overplotting by stacking nodes within dot size. Dang et al. <span class="citation" data-cites="Dang2010">(<a href="#ref-Dang2010" role="doc-biblioref">2010</a>)</span> extended this to scatterplots by stacking nodes whose values are similar in 3D visual space. These pioneering works provide the theoretical background for the determination of optimal bin size for gatherplots.</p>
<p>Specialized versions of dot plots <span class="citation" data-cites="Wilkinson1999">(<a href="#ref-Wilkinson1999" role="doc-biblioref">Wilkinson 1999</a>)</span> have been imbued with their own monikers. The R graphics package presents a version called a stripchart, which allows for both jittering and stacking categorical data in a one-dimensional scatterplot. Beeswarm plots <span class="citation" data-cites="beeswarm">(<a href="#ref-beeswarm" role="doc-biblioref">Eklund and Trimble 2021</a>)</span> improves on stripcharts by allowing for closely packed, non-overlapping points. The seaborn <span class="citation" data-cites="Waskom2021">(<a href="#ref-Waskom2021" role="doc-biblioref">Waskom 2021</a>)</span> statistical data visualization library for Python extends these chart types to two-dimensional space. Stripplots (the name is somewhat unfortunate as it clashes with the strip plots technique for rendering univariate data as strips, yielding a plot reminiscent of a barcode) are 1D or 2D versions of stripcharts with random jittering where at least one axis is expected to be categorical. Swarmplots are 2D versions of beeswarm plots that place points to avoid overlap. In comparison, gatherplots partition the available space into stacked groups and then organize the marks inside each group into ordered grids. This yields a richer visual language that allows for sorting marks based on color and even resize marks to fill the visual space.</p>
<p>Another practical method for visualizing categorical data is for making inferences based on statistical and probabilistic data. Cosmides and Toody <span class="citation" data-cites="Cosmides1996">(<a href="#ref-Cosmides1996" role="doc-biblioref">1996</a>)</span> used frequency grids as discrete countable objects, and Micallef et al. <span class="citation" data-cites="Micallef2012">(<a href="#ref-Micallef2012" role="doc-biblioref">2012</a>)</span> extend this with six different area-proportional representations of categorical data organized into different classes. Huron et al. <span class="citation" data-cites="Huron2013">(<a href="#ref-Huron2013" role="doc-biblioref">2013</a>)</span> suggested using sedimentation as metaphor where individual objects coming from a data stream gradually transform into aggregated areas, or strata.</p>
<p>Finally, Kinetica <span class="citation" data-cites="DBLP:conf/chi/RzeszotarskiK14">(<a href="#ref-DBLP:conf/chi/RzeszotarskiK14" role="doc-biblioref">Rzeszotarski and Kittur 2014</a>)</span>, beyond presenting a novel touch- and physics-based interaction for 2D scatterplots, provides a clustering algorithm where visual marks clump together with collision detection (and thus no overlap) based on their data ranges. The clusters are similar to the partioned clusters in gatherplots, but are organically shaped, not arranged in orderly grid lines, and thus harder to compare. The attraction approach used in Kinetica is reminiscent of the gravity model used for marks in dust &amp; magnet <span class="citation" data-cites="DBLP:journals/ivs/YiMSJ05">(<a href="#ref-DBLP:journals/ivs/YiMSJ05" role="doc-biblioref">Yi et al. 2005</a>)</span>.</p>
<div id="fig-aspect-ratio" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-aspect-ratio-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-aspect-ratio" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-aspect1" class="accessible-fig quarto-figure quarto-figure-center quarto-float anchored" alt="Gatherplot for a Titanic survivors dataset with Sex on the Y axis and Class on the X axis. Color encodes whether a person survived or not: dark red for Yes, and pink for No. In the grids formed by the categorical axes, gathered marks arranged in a regular grid show the data distribution. The grids have the same aspect ratio as the overall chart. All the marks are small and of equal size.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-aspect1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/aspect-ratio-1.svg" class="accessible-fig img-fluid figure-img" data-ref-parent="fig-aspect-ratio" alt="Gatherplot for a Titanic survivors dataset with Sex on the Y axis and Class on the X axis. Color encodes whether a person survived or not: dark red for Yes, and pink for No. In the grids formed by the categorical axes, gathered marks arranged in a regular grid show the data distribution. The grids have the same aspect ratio as the overall chart. All the marks are small and of equal size.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-aspect1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Absolute mode.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-aspect-ratio" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-aspect2" class="accessible-fig quarto-figure quarto-figure-center quarto-float anchored" alt="Gatherplot for a Titanic survivors dataset with Sex on the Y axis and Class on the X axis. Color encodes whether a person survived or not: dark red for Yes, and pink for No. In the grids formed by the categorical axes, gathered marks arranged in a regular grid show the data distribution. The grid cells are all uniform sized and the marks are sized to fill the available space.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-aspect2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/aspect-ratio-2.svg" class="accessible-fig img-fluid figure-img" data-ref-parent="fig-aspect-ratio" alt="Gatherplot for a Titanic survivors dataset with Sex on the Y axis and Class on the X axis. Color encodes whether a person survived or not: dark red for Yes, and pink for No. In the grids formed by the categorical axes, gathered marks arranged in a regular grid show the data distribution. The grid cells are all uniform sized and the marks are sized to fill the available space.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-aspect2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Normalized mode.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-aspect-ratio" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-aspect3" class="accessible-fig quarto-figure quarto-figure-center quarto-float anchored" alt="Gatherplot for a Titanic survivors dataset with Age on the Y axis and Sex on the X axis. Color encodes the port of boarding for each passenger. The gender values on the X axis results in the chart being split horizontally into two streamgraphs.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-aspect3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/aspect-ratio-3.svg" class="accessible-fig img-fluid figure-img" data-ref-parent="fig-aspect-ratio" alt="Gatherplot for a Titanic survivors dataset with Age on the Y axis and Sex on the X axis. Color encodes the port of boarding for each passenger. The gender values on the X axis results in the chart being split horizontally into two streamgraphs.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-aspect3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Streamgraph mode.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-aspect-ratio-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: <strong>Main layout modes for gatherplots.</strong> <a href="#fig-aspect1" class="quarto-xref">4 (a)</a> absolute mode with constant aspect ratio, which maintains the aspect ratio; <a href="#fig-aspect2" class="quarto-xref">4 (b)</a> normalized mode of <a href="#fig-aspect1" class="quarto-xref">4 (a)</a>. The rate of male survivors in each passenger class is not easy to compare. <a href="#fig-aspect3" class="quarto-xref">4 (c)</a> streamgraph mode, where each cluster maintains the number of element in the shorter edge, making it easier to see the distribution of the subgroups along the Y axis.
</figcaption>
</figure>
</div>
<!-- ========================================================================== -->
</section>
</section>
<section id="gather" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="gather"><span class="header-section-number">3</span> The Gather Transformation</h2>
<p>Position along a common scale is the most salient of all visual variables <span class="citation" data-cites="Bertin1983 Cleveland1985">(<a href="#ref-Bertin1983" role="doc-biblioref">Bertin 1983</a>; <a href="#ref-Cleveland1985" role="doc-biblioref">Cleveland and McGill 1985</a>)</span>, and so mapping a data dimension to positions on a graphical axis is a standard operation in data visualization. We call this mapping a <em>visual transformation</em>. However, most statistical treatments of data, such as Stevens’ classical theory on the scale of measurements <span class="citation" data-cites="Stevens1946">(<a href="#ref-Stevens1946" role="doc-biblioref">Stevens 1946</a>)</span>, do not take the physical properties of display space into account. This is our purpose in the following section.</p>
<section id="definition-the-gather-transformation" class="level3">
<h3 class="anchored" data-anchor-id="definition-the-gather-transformation">Definition: The Gather Transformation</h3>
<p>We build on the previous idea of structured displacement <span class="citation" data-cites="Bezerianos2010 Shneiderman2000">(<a href="#ref-Bezerianos2010" role="doc-biblioref">Bezerianos et al. 2010</a>; <a href="#ref-Shneiderman2000" role="doc-biblioref">Shneiderman et al. 2000</a>)</span> by proposing a novel visual transformation function called a <em>gather</em> transformation that non-linearly segments a graphical axis and organizes data points in each segment to eliminate overplotting. More specifically, the graphical axis is subdivided into contiguous segments, one for each value in the categorical axis. Data points as visual marks are then packed into the available display space without overlap (i.e., using a regular spacing).</p>
<p>Several different methods exist for adapting the gather transformation to a dataset. One approach is to keep the segments of equal size and find a constant visual mark size that ensures that all points fit within the most dense segment. The constant mark size makes visual comparison straightforward. Another approach is to adapt segment size to the density of the data while still keeping the mark size constant. This will minimize empty space in the visual transformation and allows for maximizing mark size. A third approach is to vary mark size proportionally to the number of points in a segment. This will make comparison of the absolute number of points in each segment difficult, but may facilitate relative comparisons if marks are distinguished in some other way (e.g., using color).</p>
<p>For data dimensions that have a very large number of unique values, it often makes sense to first quantize (“bin”) the data so that the number of elements is kept manageable (on the order of 10 or less for most visualizations). For example, a data dimension representing a person’s age might heuristically be binned into ranges of 10 years: 0-9 years, 10-19 years, 20-29 years, and so on.</p>
<p>In a gather transformation, the coordinate axis has been partitioned into segments, where the order of segments on the axis depends on the data. For nominal data, the segments can be reordered freely, both by the algorithm and by the user. For ordinal or quantized data, the order is given by the data relation. Furthermore, it often makes sense to be able to order points inside each segment using the gathering transformation function, for example using a second data dimension (possibly visualized using color) to group related items together.</p>
<p>Appropriate visual representations of data where the gather transformation has been applied are also important. The <em>stacked entities</em> of gathered points should maintain object identity, so that each constituent point and their size is discernible as a discrete visual mark. Similarly, a visual representation of the segmented graphical axis should externalize the segments as labeled intervals instead of labeled major and minor ticks; this will also communicate the discontinuous nature of the axis itself to the viewer.</p>
</section>
<section id="using-the-gather-transformation" class="level3">
<h3 class="anchored" data-anchor-id="using-the-gather-transformation">Using the Gather Transformation</h3>
<p>Gatherplots minimize overplotting by segmenting each axis into intervals. This allows us to resize segments according to the number of items falling into each segment so that segments with many data points become proportionally larger than those with fewer points. Finally, if the data dimensions represent nominal data, it may make sense to use a global segment ordering function so that there is a minimum of lateral movement for the majority of points as they connect to adjacent axes. This will also minimize line crossings between the parallel axes. This particular visualization technique—a parallel coordinate plot with the gather transformation applied to each graphical axis—is essentially equivalent to <em>parallel sets</em> <span class="citation" data-cites="Kosara2006">(<a href="#ref-Kosara2006" role="doc-biblioref">Kosara, Bendix, and Hauser 2006</a>)</span>.</p>
<p>In fact, by applying our generalized gather transformation to the axis, we are actually proposing a new type of stacked visualization where each entity is still represented by lines. In a sense, this technique combines parallel coordinates and parallel sets because the grouped lines maintain the illusion of a single entity for an axis with nominal categorical values (similar to parallel sets), yet integrates directly with a parallel coordinate axis with continuous values. The main difference is that the new parallel coordinate/set variation allows each axis to be either categorical or continuous, meaning that one axis can represent the gender and the next can represent the height of person.</p>
<div id="fig-gatherplot" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gatherplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell panel-input card bg-light p-2">
<div class="sourceCode cell-code hidden" id="cb5" data-startfrom="365" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 364;"><span id="cb5-365"><a href="#cb5-365" aria-hidden="true" tabindex="-1"></a>viewof xAxis <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(cars<span class="op">.</span><span class="at">columns</span><span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"X Axis"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> cars<span class="op">.</span><span class="at">columns</span>[<span class="dv">0</span>]})<span class="op">;</span></span>
<span id="cb5-366"><a href="#cb5-366" aria-hidden="true" tabindex="-1"></a>viewof yAxis <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(cars<span class="op">.</span><span class="at">columns</span><span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Y Axis"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> cars<span class="op">.</span><span class="at">columns</span>[<span class="dv">1</span>]})<span class="op">;</span></span>
<span id="cb5-367"><a href="#cb5-367" aria-hidden="true" tabindex="-1"></a>viewof color <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(colors<span class="op">,</span> {<span class="dt">format</span><span class="op">:</span> x <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">name</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> colors<span class="op">.</span><span class="fu">find</span>(t <span class="kw">=&gt;</span> t<span class="op">.</span><span class="at">name</span> <span class="op">===</span> <span class="st">"Cylinders"</span>)<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Color"</span>})<span class="op">;</span></span>
<span id="cb5-368"><a href="#cb5-368" aria-hidden="true" tabindex="-1"></a>viewof sorting <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">checkbox</span>([<span class="st">"color"</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Sorting"</span>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-ojs-cell-5" class="cell panel-input quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-ojs-cell-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<div id="fig-ojs-cell-5-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-ojs-cell-5-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-5-1" data-nodetype="declaration">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ojs-cell-5-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="fig-ojs-cell-5-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-ojs-cell-5-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-5-2" data-nodetype="declaration">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ojs-cell-5-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="fig-ojs-cell-5-3" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-ojs-cell-5-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-5-3" data-nodetype="declaration">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ojs-cell-5-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c)
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="fig-ojs-cell-5-4" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-ojs-cell-5-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-5-4" data-nodetype="declaration">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ojs-cell-5-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d)
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ojs-cell-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(e) Interactive gatherplot
</figcaption>
</figure>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb6" data-startfrom="372" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 371;"><span id="cb6-372"><a href="#cb6-372" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> d3<span class="op">.</span><span class="fu">map</span>(cars<span class="op">,</span> d <span class="kw">=&gt;</span> d[color<span class="op">.</span><span class="at">name</span>])<span class="op">.</span><span class="fu">sort</span>()<span class="op">;</span></span>
<span id="cb6-373"><a href="#cb6-373" aria-hidden="true" tabindex="-1"></a>color<span class="op">.</span><span class="at">categorical</span> <span class="op">?</span></span>
<span id="cb6-374"><a href="#cb6-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Swatches</span>(d3<span class="op">.</span><span class="fu">scaleOrdinal</span>(<span class="kw">new</span> <span class="bu">Set</span>(C)<span class="op">.</span><span class="fu">values</span>()<span class="op">,</span> d3<span class="op">.</span><span class="at">schemeCategory10</span>)) <span class="op">:</span></span>
<span id="cb6-375"><a href="#cb6-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Legend</span>(d3<span class="op">.</span><span class="fu">scaleSequential</span>()<span class="op">.</span><span class="fu">interpolator</span>(d3<span class="op">.</span><span class="at">interpolateYlGnBu</span>)<span class="op">.</span><span class="fu">domain</span>(d3<span class="op">.</span><span class="fu">extent</span>(C))<span class="op">,</span> {<span class="dt">title</span><span class="op">:</span> color<span class="op">.</span><span class="at">name</span>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb7" data-startfrom="379" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 378;"><span id="cb7-379"><a href="#cb7-379" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [</span>
<span id="cb7-380"><a href="#cb7-380" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">name</span><span class="op">:</span> <span class="st">'Name'</span><span class="op">,</span> <span class="dt">categorical</span><span class="op">:</span> <span class="kw">true</span>}<span class="op">,</span> </span>
<span id="cb7-381"><a href="#cb7-381" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">name</span><span class="op">:</span> <span class="st">'MPG'</span><span class="op">,</span> <span class="dt">categorical</span><span class="op">:</span> <span class="kw">false</span>}<span class="op">,</span> </span>
<span id="cb7-382"><a href="#cb7-382" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">name</span><span class="op">:</span> <span class="st">'Cylinders'</span><span class="op">,</span> <span class="dt">categorical</span><span class="op">:</span> <span class="kw">true</span>}<span class="op">,</span> </span>
<span id="cb7-383"><a href="#cb7-383" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">name</span><span class="op">:</span> <span class="st">'Displacement'</span><span class="op">,</span> <span class="dt">categorical</span><span class="op">:</span> <span class="kw">false</span>}<span class="op">,</span> </span>
<span id="cb7-384"><a href="#cb7-384" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">name</span><span class="op">:</span> <span class="st">'Horsepower'</span><span class="op">,</span> <span class="dt">categorical</span><span class="op">:</span> <span class="kw">false</span>}<span class="op">,</span> </span>
<span id="cb7-385"><a href="#cb7-385" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">name</span><span class="op">:</span> <span class="st">'Weight'</span><span class="op">,</span> <span class="dt">categorical</span><span class="op">:</span> <span class="kw">false</span>}<span class="op">,</span> </span>
<span id="cb7-386"><a href="#cb7-386" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">name</span><span class="op">:</span> <span class="st">'Acceleration'</span><span class="op">,</span> <span class="dt">categorical</span><span class="op">:</span> <span class="kw">false</span>}<span class="op">,</span> </span>
<span id="cb7-387"><a href="#cb7-387" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">name</span><span class="op">:</span> <span class="st">'Model'</span><span class="op">,</span> <span class="dt">categorical</span><span class="op">:</span> <span class="kw">false</span>}<span class="op">,</span> </span>
<span id="cb7-388"><a href="#cb7-388" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">name</span><span class="op">:</span> <span class="st">'Origin'</span><span class="op">,</span> <span class="dt">categorical</span><span class="op">:</span> <span class="kw">true</span>}</span>
<span id="cb7-389"><a href="#cb7-389" aria-hidden="true" tabindex="-1"></a>]<span class="op">;</span></span>
<span id="cb7-390"><a href="#cb7-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-391"><a href="#cb7-391" aria-hidden="true" tabindex="-1"></a>gather <span class="op">=</span> <span class="fu">GatherPlot</span>(cars<span class="op">,</span> { </span>
<span id="cb7-392"><a href="#cb7-392" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> d <span class="kw">=&gt;</span> d[xAxis]<span class="op">,</span></span>
<span id="cb7-393"><a href="#cb7-393" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> d <span class="kw">=&gt;</span> d[yAxis]<span class="op">,</span></span>
<span id="cb7-394"><a href="#cb7-394" aria-hidden="true" tabindex="-1"></a>  <span class="dt">c</span><span class="op">:</span> d <span class="kw">=&gt;</span> d[color<span class="op">.</span><span class="at">name</span>]<span class="op">,</span></span>
<span id="cb7-395"><a href="#cb7-395" aria-hidden="true" tabindex="-1"></a>  <span class="dt">ySort</span><span class="op">:</span> sorting<span class="op">.</span><span class="fu">indexOf</span>(<span class="st">'Y descending'</span>) <span class="op">===</span> <span class="op">-</span><span class="dv">1</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="op">-</span><span class="dv">1</span><span class="op">,</span></span>
<span id="cb7-396"><a href="#cb7-396" aria-hidden="true" tabindex="-1"></a>  <span class="dt">xSort</span><span class="op">:</span> sorting<span class="op">.</span><span class="fu">indexOf</span>(<span class="st">'X descending'</span>) <span class="op">===</span> <span class="op">-</span><span class="dv">1</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="op">-</span><span class="dv">1</span><span class="op">,</span></span>
<span id="cb7-397"><a href="#cb7-397" aria-hidden="true" tabindex="-1"></a>  <span class="dt">cSort</span><span class="op">:</span> sorting<span class="op">.</span><span class="fu">indexOf</span>(<span class="st">'color'</span>) <span class="op">===</span> <span class="op">-</span><span class="dv">1</span> <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb7-398"><a href="#cb7-398" aria-hidden="true" tabindex="-1"></a>  width<span class="op">,</span></span>
<span id="cb7-399"><a href="#cb7-399" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="dv">600</span></span>
<span id="cb7-400"><a href="#cb7-400" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gatherplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: <strong>Interactive gatherplot.</strong> Gatherplot of the cars dataset with controls for the horizontal and vertical axes as well as the dot color assignment.
</figcaption>
</figure>
</div>
<!-- ========================================================================== -->
</section>
</section>
<section id="gatherplots" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="gatherplots"><span class="header-section-number">4</span> Gatherplots: A 2D Gathering Representation</h2>
<p>Applying gathering to two perpendicular axes defining a Cartesian space results in a <em>gatherplot</em>: a 2D distortion-based extension of scatterplots that gathers data points into <em>stacked groups</em>, thereby eliminating overplotting without losing the identity of individual data points. <a href="#fig-gatherplot" class="quarto-xref">Figure&nbsp;5</a> provides an interactive gatherplot. Compared to jittering, which relies on random permutation, gathering organizes visual marks according to visual features, so that the resulting group of objects forms a meta-object. According to Haroz and Whitney <span class="citation" data-cites="Haroz2012">(<a href="#ref-Haroz2012" role="doc-biblioref">2012</a>)</span>, grouping marks by feature helps in performing perceptual tasks such as finding outliers, counting items, and seeing trends. The technique is particularly designed for visualizing categorical variables. Below we discuss the open design parameters for the technique, including layout, aspect ratio, and item shapes.</p>
<section id="layout" class="level3">
<h3 class="anchored" data-anchor-id="layout">Layout</h3>
<p>Gatherplots eliminate overplotting by gathering marks with similar visual properties into <em>stacked groups</em>. This is inspired by previous works such as hieraxes <span class="citation" data-cites="Shneiderman2000">(<a href="#ref-Shneiderman2000" role="doc-biblioref">Shneiderman et al. 2000</a>)</span> or frequency grids <span class="citation" data-cites="Micallef2012 Cosmides1996">(<a href="#ref-Micallef2012" role="doc-biblioref">Micallef, Dragicevic, and Fekete 2012</a>; <a href="#ref-Cosmides1996" role="doc-biblioref">Cosmides and Tooby 1996</a>)</span>. However, there are many design possibilities for organizing the visual representation depending on the context, especially on the size distribution of each groups, the aspect ratio of assigned space, and the task at hand. As a result, we derive the following three layout modes (see <a href="#fig-aspect-ratio" class="quarto-xref">Figure&nbsp;4</a>):</p>
<ul>
<li><p><strong>Absolute mode</strong>: Here stacked groups are sized to follow the aspect-ratio of the assigned region. The size of the items are determined by the maximum length dots which can fill the assigned region without overlapping. This means with the same assigned space, the groups with the maximum number of members determines the overall size of the nodes (<a href="#fig-aspect-ratio" class="quarto-xref">Figure&nbsp;4</a>(a)).</p></li>
<li><p><strong>Normalized mode</strong>: In this mode, the mark size and aspect ratio is adapted so that every stacked group has equal dimensions. This makes it easier to investigate ratios when the user is interested in the relative distributions of subgroups rather than the absolute number of members. <!-- Items also change their shape from a circle (absolute mode) to a rounded rectangle (@fig-aspect-ratio(b)).   --></p>
<p>Normalized mode is useful for two specific tasks:</p>
<ul>
<li><p><em>Finding the ratio of the subgroups in a group</em> (<a href="#fig-aspect-ratio" class="quarto-xref">Figure&nbsp;4</a>). Because groups of different size are normalized to the same geometric area, any comparison results in a relative comparison, which can aid statistical Bayesian reasoning <span class="citation" data-cites="Micallef2012">(<a href="#ref-Micallef2012" role="doc-biblioref">Micallef, Dragicevic, and Fekete 2012</a>)</span>.</p></li>
<li><p><em>Finding the distribution of outliers</em>. When there are many items on the screen for absolute mode, all marks must be reduced in size. This can make outliers hard to locate. When normalized mode is used, the outliers are expanded to fill the assigned space, making them easier to see.</p></li>
</ul></li>
<li><p><strong>Streamgraph mode</strong>: Here stacked groups are reorganized so that they maintain the same number of elements in their shorter edge. This mode is used for regions where the ratio of width and height are drastically different (in our prototype implementation, we use a heuristic threshold aspect ratio value of 3 for activating this mode). This means there are usually many times more groups in the axis in parallel with shorter edges. A good example is for visualizing the population distribution with regards to gender and age; the resulting gatherplot approaches ThemeRiver <span class="citation" data-cites="Havre2000">(<a href="#ref-Havre2000" role="doc-biblioref">Havre, Hetzler, and Nowell 2000</a>)</span> as the number of entities increases (<a href="#fig-aspect-ratio" class="quarto-xref">Figure&nbsp;4</a>(c)).</p></li>
</ul>
<p>The choice between absolute and streamgraph mode happens automatically based on the aspect ratio of assigned space and without the need for user intervention. Therefore, only a simple interaction is required to toggle between absolute and normalized mode. However, we do expose a setting to manually toggle between these modes as well.</p>
</section>
<section id="managing-continuous-variables" class="level3">
<h3 class="anchored" data-anchor-id="managing-continuous-variables">Managing Continuous Variables</h3>
<p>To use gatherplots for continuous variables, we apply binning to partition the variable into discrete intervals. The resulting visualization resembles dots plots by Wilkinson <span class="citation" data-cites="Wilkinson1999">(<a href="#ref-Wilkinson1999" role="doc-biblioref">1999</a>)</span>, where bin size is equal to dot size. The size of individual bins is important for binning because it determines the spatial accuracy and legibility of the visualization. We define <em>spatial accuracy</em> as the degree to which a mark in a gatherplot is mapped to the actual position it would have been mapped if the mapping had been continuous (like for a regular scatterplot). <em>Legibility</em>, on the other hand, is the ability for a user to perceive individual marks in a unit visualization.</p>
<p>Wilkinson proposed <span class="math inline">\(.25n^{-1/2}\)</span> as the optimal dot size for dot plots (although he also noted that an implementation should reduce size for overflow situations). This creates reasonable dot plots for fixed aspect ratio of 5 to 1, which is common in statistical charts assuming normal distribution of nodes.<br>
However, gatherplot requires two different assumptions: First, the aspect ratio varies according to the space given to the categorical variables. Second, the dot size or bin size is determined by the global maximum in the dataset, which may not be in the same cluster. Furthermore, because bin size is the same as dot size, selecting bin size can be thought of as a trade-off between accuracy and legibility. Using very small bin size and dot size increases the spatial accuracy, but results in poor legibility, and vice versa.</p>
<p>Balancing accuracy vs.&nbsp;legibility is common in visualization for large datasets; for example, splatterplots limit the information shown to users based on the available visual space <span class="citation" data-cites="Mayorga2013">(<a href="#ref-Mayorga2013" role="doc-biblioref">Mayorga and Gleicher 2013</a>)</span>. Similarly, gatherplots choose bin size based on spatial accuracy and legibility. When the visual space is small, we use a comparably large bin size to increase dot size, thus resulting in poor spatial accuracy and high legibility; for larger space allocations, the bins can be made smaller to increase accuracy without loss of legibility. Our implementation iteratively finds a bin size as a trade-off between mark size and the most crowded bin; this is shown in <a href="#fig-optimal-bin" class="quarto-xref">Figure&nbsp;6</a>. Overall, this is an inherent weakness of unit visualizations: the need to make individual marks distinct means that the visual representation may become distorted, and the scalability of the visualization suffers overall.</p>
<div id="fig-optimal-bin" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-optimal-bin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-optimal-bin" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-optimal-bin1" class="accessible-fig quarto-figure quarto-figure-center quarto-float anchored" alt="Gatherplot for a car dataset with MPG on the Y axis and unassigned X axis. Color is used to show three different origins: US (blue), Europe (orange), and Asia (green). The result is a streamgraph arrangement with each position on the Y axis showing a single gathered row of cars with the corresponding gas mileage.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-optimal-bin1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/cont-size-1.svg" class="accessible-fig img-fluid figure-img" data-ref-parent="fig-optimal-bin" alt="Gatherplot for a car dataset with MPG on the Y axis and unassigned X axis. Color is used to show three different origins: US (blue), Europe (orange), and Asia (green). The result is a streamgraph arrangement with each position on the Y axis showing a single gathered row of cars with the corresponding gas mileage.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-optimal-bin1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Large display space.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-optimal-bin" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-optimal-bin2" class="accessible-fig quarto-figure quarto-figure-center quarto-float anchored" alt="Gatherplot for a car dataset with MPG on the Y axis and unassigned X axis. Color is used to show three different origins: US (blue), Europe (orange), and Asia (green). The result is a streamgraph arrangement with each position on the Y axis showing a single gathered row of cars with the corresponding gas mileage. This chart is shorter than the previous one, yielding larger mileage bins.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-optimal-bin2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/cont-size-2.svg" class="accessible-fig img-fluid figure-img" data-ref-parent="fig-optimal-bin" alt="Gatherplot for a car dataset with MPG on the Y axis and unassigned X axis. Color is used to show three different origins: US (blue), Europe (orange), and Asia (green). The result is a streamgraph arrangement with each position on the Y axis showing a single gathered row of cars with the corresponding gas mileage. This chart is shorter than the previous one, yielding larger mileage bins.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-optimal-bin2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Small display space.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-optimal-bin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: <strong>Choosing optimal bin size based on available display space.</strong> In <a href="#fig-optimal-bin1" class="quarto-xref">6 (a)</a>, there is enough space so that the dot size can be maximized, improving spatial accuracy. In comparison, in <a href="#fig-optimal-bin2" class="quarto-xref">6 (b)</a> the assigned space is small, so the dot size is determined so that the most crowded bin interval will fit within the assigned space. This results in two different overviews even though the two plots have identical aspect ratio.
</figcaption>
</figure>
</div>
<p><a href="#fig-cont-cont" class="quarto-xref">Figure&nbsp;7</a> shows how gatherplots handle the situation when continuous variables are assigned to <strong>both</strong> axes, causing both to be binned. The plot is using normalized mode with two random variables. The normalized mode makes it easier to identify the outliers and the distribution of outliers. Furthermore, the case of scatterplots with the same continuous variables on both axes can be treated as a special case of continuous vs.&nbsp;categorical variables. Here, the gatherplot is rotated to maintain integrity with scatterplots (<a href="#fig-teaser" class="quarto-xref">Figure&nbsp;1</a>(c)).</p>
<p>One limitation of gatherplots is that the technique requires binning to manage a continuous variable, yet binning creates arbitrary boundaries that can be misleading. However, using both gatherplots and scatterplots in different views makes this problem less severe because the analyst can simply choose the visual representation most suited for a particular task.</p>
<div id="fig-cont-cont" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cont-cont-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-cont-cont" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-cont-cont1" class="accessible-fig quarto-figure quarto-figure-center quarto-float anchored" alt="Scatterplot with 5,000 random data points and severe overplotting. The data is uniformly distributed along the Y axis and appears normally distributed on the X axis. The graph shows three separate colors: blue, cyan, and moss green.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-cont-cont1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/cont-cont-1.svg" class="accessible-fig img-fluid figure-img" data-ref-parent="fig-cont-cont" alt="Scatterplot with 5,000 random data points and severe overplotting. The data is uniformly distributed along the Y axis and appears normally distributed on the X axis. The graph shows three separate colors: blue, cyan, and moss green.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-cont-cont1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Scatterplot.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-cont-cont" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-cont-cont2" class="accessible-fig quarto-figure quarto-figure-center quarto-float anchored" alt="Gatherplot with absolute mode for the random 5,000-point dataset. Both the X and Y axes have been automatically binned by the algorithm. The cells resulting from this binning show ordered marks; the horizontal center area shows the most data points.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-cont-cont2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/cont-cont-2.svg" class="accessible-fig img-fluid figure-img" data-ref-parent="fig-cont-cont" alt="Gatherplot with absolute mode for the random 5,000-point dataset. Both the X and Y axes have been automatically binned by the algorithm. The cells resulting from this binning show ordered marks; the horizontal center area shows the most data points.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-cont-cont2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Absolute gatherplot.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-cont-cont" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-cont-cont3" class="accessible-fig quarto-figure quarto-figure-center quarto-float anchored" alt="Gatherplot with normalized mode for the random 5,000-point dataset. Both the X and Y axes have been automatically binned by the algorithm. Because of the normalization, marks in grid cells with few data points have been resized to fill the available space, making it easier to see outliers in the left and right side of the plot.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-cont-cont3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/cont-cont-3.svg" class="accessible-fig img-fluid figure-img" data-ref-parent="fig-cont-cont" alt="Gatherplot with normalized mode for the random 5,000-point dataset. Both the X and Y axes have been automatically binned by the algorithm. Because of the normalization, marks in grid cells with few data points have been resized to fill the available space, making it easier to see outliers in the left and right side of the plot.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-cont-cont3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Normalized gatherplot.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cont-cont-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: <strong>Using gatherplots to manage overplotting.</strong> <a href="#fig-cont-cont1" class="quarto-xref">7 (a)</a> shows a scatterplot with 5,000 random numbers with severe overplotting in the center area. In <a href="#fig-cont-cont2" class="quarto-xref">7 (b)</a>, gathering is applied to create a more organized view. However, the gathering resizes the items so small that it becomes difficult to detect outliers. <a href="#fig-cont-cont3" class="quarto-xref">7 (c)</a> shows normalized mode, where the outliers are enlarged. This makes identifying the distribution of sparse regions easier.
</figcaption>
</figure>
</div>
</section>
<section id="undefined-axis-mapping" class="level3">
<h3 class="anchored" data-anchor-id="undefined-axis-mapping">Undefined Axis Mapping</h3>
<p>Scatterplots have traditionally been used to view correlations between two variables. However, for a multidimensional exploration, one subtle difficulty is when the user wants to see only the effect of a single variable. In gatherplots, the logical extension of an undefined axis is the aggregation of all nodes in a single group along that axis. <a href="#fig-matrix" class="quarto-xref">Figure&nbsp;8</a> shows an example of this using a dataset on survivors of the Titanic.</p>
<div id="fig-matrix" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-matrix" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-matrix1" class="accessible-fig quarto-figure quarto-figure-center quarto-float anchored" alt="Gatherplot showing all passengers of the Titanic with no mapping to the X and Y axes. Each passenger is represented by a single red mark organized into a rectangular grid.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-matrix1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/undefined-1.svg" class="accessible-fig img-fluid figure-img" data-ref-parent="fig-matrix" alt="Gatherplot showing all passengers of the Titanic with no mapping to the X and Y axes. Each passenger is represented by a single red mark organized into a rectangular grid.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-matrix1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) All passengers.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-matrix" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-matrix2" class="accessible-fig quarto-figure quarto-figure-center quarto-float anchored" alt="Gatherplot showing all passengers of the Titanic with no mapping to the X and Y axes. Each passenger is represented by a single mark organized into a rectangular grid. Marks are colored to show whether they survived (pink) or died (gray); approximately a quarter of the first dots in the grid to the left of the plot are colored pink.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-matrix2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/undefined-2.svg" class="accessible-fig img-fluid figure-img" data-ref-parent="fig-matrix" alt="Gatherplot showing all passengers of the Titanic with no mapping to the X and Y axes. Each passenger is represented by a single mark organized into a rectangular grid. Marks are colored to show whether they survived (pink) or died (gray); approximately a quarter of the first dots in the grid to the left of the plot are colored pink.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-matrix2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) All passengers colored by survival (pink = survived, gray = died).
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-matrix" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-matrix3" class="accessible-fig quarto-figure quarto-figure-center quarto-float anchored" alt="Gatherplot showing all passengers of the Titanic with the Class mapped to the X axis and no mapping to the Y axis. Class splits the horizontal space into four areas: First, Second, and Third class, and Crew. Marks are colored to show whether they survived (pink) or died (gray). First class has the highest survival rate; almost 75% of its dots are colored pink. A third of Second class is colored pink; less than a quarter of Third class and Crew are pink.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-matrix3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/undefined-3.svg" class="accessible-fig img-fluid figure-img" data-ref-parent="fig-matrix" alt="Gatherplot showing all passengers of the Titanic with the Class mapped to the X axis and no mapping to the Y axis. Class splits the horizontal space into four areas: First, Second, and Third class, and Crew. Marks are colored to show whether they survived (pink) or died (gray). First class has the highest survival rate; almost 75% of its dots are colored pink. A third of Second class is colored pink; less than a quarter of Third class and Crew are pink.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-matrix3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Passengers gathered by Class (pink = survived, gray = died).
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-matrix" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-matrix4" class="accessible-fig quarto-figure quarto-figure-center quarto-float anchored" alt="Gatherplot showing all passengers of the Titanic with the no mapping to the X axis and Sex mapped to the Y axis. Sex splits the vertical space into two areas: Female and Male. There are four times as many Male than Female marks on the plot. Marks are colored to show whether they survived (pink) or died (gray). Approximately 75% of the marks representing Female passengers are colored pink. Approximately 20% of the marks representing Male passengers are pink.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-matrix4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/undefined-4.svg" class="accessible-fig img-fluid figure-img" data-ref-parent="fig-matrix" alt="Gatherplot showing all passengers of the Titanic with the no mapping to the X axis and Sex mapped to the Y axis. Sex splits the vertical space into two areas: Female and Male. There are four times as many Male than Female marks on the plot. Marks are colored to show whether they survived (pink) or died (gray). Approximately 75% of the marks representing Female passengers are colored pink. Approximately 20% of the marks representing Male passengers are pink.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-matrix4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) Passengers gathered by Sex (pink = survived, gray = died).
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: <strong>Gatherplot showing survivors of the <em>Titanic</em>.</strong> <a href="#fig-matrix1" class="quarto-xref">8 (a)</a> All people on board. Note that the X and Y axis are not defined. <a href="#fig-matrix2" class="quarto-xref">8 (b)</a> Color coding for survivors. <a href="#fig-matrix3" class="quarto-xref">8 (c)</a> Distribution of survivors over class variables. Here the Y axis is undefined. <a href="#fig-matrix4" class="quarto-xref">8 (d)</a> Distribution of survivors over the gender. Here the X axis is undefined.
</figcaption>
</figure>
</div>
</section>
<section id="visual-design" class="level3">
<h3 class="anchored" data-anchor-id="visual-design">Visual Design</h3>
<p>Gatherplots build on the same visual language as scatterplots. However, some aspects are different; below we discuss our design choices for visual mark shape as well as tick marks.</p>
<section id="visual-marks" class="level4">
<h4 class="anchored" data-anchor-id="visual-marks">Visual Marks</h4>
<p>Scatterplots typically use a small circle or dot as a visual representation for items, but many variations exist that use glyph shapes to convey multidimensional variables <span class="citation" data-cites="McDonnel2009 Tufte1983 Cleveland1988 Chernoff1973">(<a href="#ref-McDonnel2009" role="doc-biblioref">McDonnel and Elmqvist 2009</a>; <a href="#ref-Tufte1983" role="doc-biblioref">Tufte 1983</a>; <a href="#ref-Cleveland1988" role="doc-biblioref">Cleveland and McGill 1988</a>; <a href="#ref-Chernoff1973" role="doc-biblioref">Chernoff 1973</a>)</span>. This is also potentially useful for gatherplots; the layouts generated by gathering can contain any visual mark, even aggregated ones like pie charts or bar charts.</p>
<p>In this paper we focus on unit visual marks, i.e.&nbsp;with one mark per data item. In normalized mode, sometimes the aspect ratio of visual marks changes according to the aspect ratio of the space assigned to that value. Also, as gathering changes the size of marks to fit in one cluster, sometimes the marks size becomes too small or too large compared to other marks. This results in several unique design considerations for item shapes.</p>
<p>Based on our experience testing several alternate designs, we recommend using a rectangle with constant rounded edge. Using constant rounded edge allows the nodes to be circular when the mark is small, as in <a href="#fig-aspect-ratio" class="quarto-xref">Figure&nbsp;4</a>(b), and a rectangle to show the degree of stretching, as shown in <a href="#fig-aspect-ratio" class="quarto-xref">Figure&nbsp;4</a>(b). As a disadvantage, it does yield less differentiable individual elements. Stroke lines can be useful in some situations, but easily become dominant when nodes shrink below a certain size.</p>
</section>
<section id="interval-tick-marks" class="level4">
<h4 class="anchored" data-anchor-id="interval-tick-marks">Interval Tick Marks</h4>
<p>Because we are representing ranges rather than single points, the single line type tick marks for scatterplots are not appropriate for gatherplots; instead, ticks should communicate the partitioned segments on the axes. Without this visual representation, when the user is confronted with a number, it can be confusing to determine whether adjacent nodes with different offset has same value or not. <a href="#fig-tick-mark" class="quarto-xref">Figure&nbsp;9</a> shows design alternatives of tick mark for representing ranges. Our implementations use bracket type markers to reduce density from adjacent ticks.</p>
<div id="fig-tick-mark" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tick-mark-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-tick-mark" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-tick-mark1" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Simple vertical tick marks.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-tick-mark1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/tick-marks-1.svg" id="fig-tick-mark1" class="img-fluid figure-img" data-ref-parent="fig-tick-mark" alt="Simple vertical tick marks.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-tick-mark1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-tick-mark" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-tick-mark2" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Double-sided arrows.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-tick-mark2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/tick-marks-2.svg" id="fig-tick-mark2" class="img-fluid figure-img" data-ref-parent="fig-tick-mark" alt="Double-sided arrows.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-tick-mark2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-tick-mark" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-tick-mark3" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Double-sided arrows with tick marks.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-tick-mark3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/tick-marks-3.svg" id="fig-tick-mark3" class="img-fluid figure-img" data-ref-parent="fig-tick-mark" alt="Double-sided arrows with tick marks.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-tick-mark3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c)
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-tick-mark" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-tick-mark4" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Square brackets.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-tick-mark4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/tick-marks-4.svg" id="fig-tick-mark4" class="img-fluid figure-img" data-ref-parent="fig-tick-mark" alt="Square brackets.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-tick-mark4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d)
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-tick-mark" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-tick-mark5" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Angle brackets.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-tick-mark5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/tick-marks-5.svg" id="fig-tick-mark5" class="img-fluid figure-img" data-ref-parent="fig-tick-mark" alt="Angle brackets.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-tick-mark5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(e)
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-tick-mark" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-tick-mark6" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Curly brackets.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-tick-mark6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/tick-marks-6.svg" id="fig-tick-mark6" class="img-fluid figure-img" data-ref-parent="fig-tick-mark" alt="Curly brackets.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-tick-mark6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(f)
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tick-mark-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: <strong>Various tick mark types.</strong> The blue dotted region represents the area between adjacent tick marks. <a href="#fig-tick-mark1" class="quarto-xref">9 (a)</a> is a typical line type tick mark for scatterplots. <a href="#fig-tick-mark2" class="quarto-xref">9 (b)</a> lacks guidelines, which will make anchoring easier. <a href="#fig-tick-mark3" class="quarto-xref">9 (c)</a> creates a packed region between adjacent marks. <a href="#fig-tick-mark4" class="quarto-xref">9 (d)</a> uses less clutter, but <a href="#fig-tick-mark5" class="quarto-xref">9 (e)</a> is the least cluttered. <a href="#fig-tick-mark6" class="quarto-xref">9 (f)</a> is the final recommendation, with the data label in the orange region.
</figcaption>
</figure>
</div>
</section>
</section>
<section id="interaction" class="level3">
<h3 class="anchored" data-anchor-id="interaction">Interaction</h3>
<p>Gatherplots support the same types of interactions as scatterplots. However, some additional interaction techniques are required to specifically control the gathering transformation.</p>
<p>For example, when exploring multidimensional datasets, it is crucial to have a mechanism to filter unwanted data. To support this process in gatherplots, we provide an optional mechanism to go back to the original continuous linear scale function. We allow each axis tick have an interactive control to be filtered out (minimize) or focused (maximized). This is called <em>axis folding</em>, because it can be illustrated by folding a paper. When minimized or folded, the visualization space is shrunk by applying linear scales instead of non-linear gather scales. This results in overplotting, as if a scatterplot was used for that axis. Maximization simply folds all other values except the value of the interest to assign maximum visual space to that value. <a href="#fig-axis-folding" class="quarto-xref">Figure&nbsp;10</a> shows axis folding applied to second class adult passengers in the Titanic dataset.</p>
<div id="fig-axis-folding" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Gatherplot showing the passengers  of the *Titanic*. Class (First, Second, Third, Crew) has been mapped to the X axis and Age (Child, Adult) to the Y axis. Color is used for the boarding Port; Cherbourg, Belfast, Southhampton, and Queenstown. Child, Second Class, and Crew has been minized to not show details. First and Third Class Adults are showing as large blocks of marks organized in an orderly grid. For the first class, the Ports are mostly evenly distributed. For Third Class, most of them boarded in Southhampton.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-axis-folding-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/axis-folding.svg" class="img-fluid figure-img" alt="Gatherplot showing the passengers  of the *Titanic*. Class (First, Second, Third, Crew) has been mapped to the X axis and Age (Child, Adult) to the Y axis. Color is used for the boarding Port; Cherbourg, Belfast, Southhampton, and Queenstown. Child, Second Class, and Crew has been minized to not show details. First and Third Class Adults are showing as large blocks of marks organized in an orderly grid. For the first class, the Ports are mostly evenly distributed. For Third Class, most of them boarded in Southhampton.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-axis-folding-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: <strong>Survivors of the <em>Titanic</em> using gatherplots.</strong> The X axis is class of passengers, where second class passengers and crew are minimized (indicated by the single tick marks). The Y axis is age, where the adult value is maximized (the child value has a single tick mark, indicating it is minimized). This view makes it easy to compare first class adults and third class adults. Note that even in the minimized state, we can get an overview about the second class and crew by the color line, which communicates the underlying distribution. This is due to sorting over the color dimension.
</figcaption>
</figure>
</div>
</section>
<section id="implementation-1" class="level3">
<h3 class="anchored" data-anchor-id="implementation-1">Implementation</h3>
<p>We have implemented a web-based demonstration of gatherplots using <a href="http://www.d3js.org">D3</a> and <a href="http://www.angular.org">Angular</a>. The prototype allows users to load various datasets into a gatherplot. The visualization can be compared to scatterplots and jittered scatterplots with a single click.</p>
<!-- ========================================================================== -->
</section>
</section>
<section id="sec-eval" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="sec-eval"><span class="header-section-number">5</span> Evaluation</h2>
<p>This study was designed to demonstrate the effectiveness of gatherplots, in particular its different layout modes with categorical vs.&nbsp;categorical variables. Crowdsourcing platforms have been widely used and have shown to be reliable platforms for evaluation studies <span class="citation" data-cites="Paolacci2010 Willett2013">(<a href="#ref-Paolacci2010" role="doc-biblioref">Paolacci, Chandler, and Ipeirotis 2010</a>; <a href="#ref-Willett2013" role="doc-biblioref">Willett et al. 2013</a>)</span>. Therefore, we conducted our experiment on <a href="https://www.mturk.com">Amazon Mechanical Turk</a>. This also gave us the opportunity to study the utility of the technique for the general population, who do not have specific statistical training. Research materials associated with the study can be found on OSF at <a href="https://osf.io/bk9cx/">https://osf.io/bk9cx/</a>.</p>
<section id="experimental-design" class="level3">
<h3 class="anchored" data-anchor-id="experimental-design">Experimental Design</h3>
<p>We selected jittered scatterplots as the baseline condition, as this technique is a widely accepted standard technique maintaining consistency with scatterplots. We also wanted to measure the efficiency of different modes of gatherplots. Therefore, we designed the experiment to have four conditions: scatterplots with jittering (jitter), gatherplots with absolute mode (absolute), gatherplots with normalized mode (normalized), and gatherplots with a toggle to switch between absolute and normalized mode (both). We adopted a between-subjects design to eliminate learning effects from experiencing other modes.</p>
</section>
<section id="participants" class="level3">
<h3 class="anchored" data-anchor-id="participants">Participants</h3>
<p>A total of 240 participants (103 female) completed our survey. Participants were compensated for their time and labor with compensation consistent with the U.S. federal minimum wage ($7.25/hour at the time of research). Because some questions asked about concepts of absolute numbers and probability, we limited participants to the United States to reduce the influence of language. To ensure the quality of the workers, the qualification of workers were the approval rate of more than 0.95 with number of hits approved to be more than 1,000. Only three of 240 participants reported not using English as their first language. 119 people had more than bachelor’s degree, with 42 people having a high school degree. We filtered random clickers by removing any trials where the completion time was shorter than a reasonable time (5 seconds). This yielded a total of 211 participants.</p>
</section>
<section id="task" class="level3">
<h3 class="anchored" data-anchor-id="task">Task</h3>
<p>Scatterplots can support many types of tasks <span class="citation" data-cites="DBLP:journals/tvcg/SarikayaG18">(<a href="#ref-DBLP:journals/tvcg/SarikayaG18" role="doc-biblioref">Sarikaya and Gleicher 2018</a>)</span>. Based on Sarikaya and Gleicher’s analysis <span class="citation" data-cites="DBLP:journals/tvcg/SarikayaG18">(<a href="#ref-DBLP:journals/tvcg/SarikayaG18" role="doc-biblioref">2018</a>)</span>, we selected retrieving a value as a low-level task, and comparing and ranking as a high-level task. For the comparing and ranking task, two different types of questions were asked: the tasks to consider absolute values such as frequency and tasks that consider relative values such as percentage. Therefore, for one visualization, 5 different questions were generated. For gatherplots, our interest is in the difference between task considering absolute values and relative values. The five tasks are as follows:</p>
<ul>
<li><strong>T1</strong>: retrieve value considering one subgroup.</li>
<li><strong>T2</strong>: comparing absolute size of subgroup between groups.</li>
<li><strong>T3</strong>: ranking absolute size of subgroup between groups.</li>
<li><strong>T4</strong>: comparing relative size of subgroup between groups.</li>
<li><strong>T5</strong>: ranking relative size of subgroup between groups.</li>
</ul>
<p>To reduce the chance of one chart being optimal by luck for a specific task, two charts of same problem structure were provided. This yielded a total of 10 questions for each participant. Each question was followed by the question asking confidence of estimation with a 7-point Likert scale, and the time spent for each question was measured.</p>
<div id="fig-study" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-study-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-study" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-study1" class="accessible-fig quarto-figure quarto-figure-center quarto-float anchored" alt="Screenshot of a survey question with a gatherplot visualizing the Titanic passenger dataset on top and a question at the bottom. The gatherplot shows Class (First, Second, Third, Crew) on the X axis and Sex (Female, Male) on the Y axis. This yields a grid with two rows and four columns. Marks are colored based on whether they survived or not; cyan for yes, and blue for no. Marks are freely sized to fill the available size in each grid cell. The question at the bottom says 'Among the four groups, the number of female survivors are the highest in first class.' The options are Agree, Disagree, or Don't Know/Can't Determine. In particular, in the First Class Female grid cell, there is an absolutely majority of cyan cells with only very few blue cells. The proportion of cyan cells is much lower for the Male First Class passengenrs, indicating that the statement is true.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-study1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/study1.png" class="accessible-fig img-fluid figure-img" data-ref-parent="fig-study" alt="Screenshot of a survey question with a gatherplot visualizing the Titanic passenger dataset on top and a question at the bottom. The gatherplot shows Class (First, Second, Third, Crew) on the X axis and Sex (Female, Male) on the Y axis. This yields a grid with two rows and four columns. Marks are colored based on whether they survived or not; cyan for yes, and blue for no. Marks are freely sized to fill the available size in each grid cell. The question at the bottom says 'Among the four groups, the number of female survivors are the highest in first class.' The options are Agree, Disagree, or Don't Know/Can't Determine. In particular, in the First Class Female grid cell, there is an absolutely majority of cyan cells with only very few blue cells. The proportion of cyan cells is much lower for the Male First Class passengenrs, indicating that the statement is true.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-study1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) The Gatherplot stimulus and the task; this is a relative comparison task (<strong>T4</strong>).
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-study" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-study2" class="accessible-fig quarto-figure quarto-figure-center quarto-float anchored" alt="Screenshot of a multiple-choice question with seven choices as a radio button, representing a Likert-scale question. The question reads 'Please select how much you agree or disagree with the following statement: I am confident of my estimation.' The options are Strongly Disagree, Disagree, Somewhat Disagree, Neither Agree/Disagree, Somewhat Agree, Agree, Strongly Agree.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-study2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/study2.png" class="accessible-fig img-fluid figure-img" data-ref-parent="fig-study" alt="Screenshot of a multiple-choice question with seven choices as a radio button, representing a Likert-scale question. The question reads 'Please select how much you agree or disagree with the following statement: I am confident of my estimation.' The options are Strongly Disagree, Disagree, Somewhat Disagree, Neither Agree/Disagree, Somewhat Agree, Agree, Strongly Agree.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-study2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) The confidence question as a 7-point Likert scale.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-study-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: <strong>Example study screenshot.</strong> The study consisted of a total of 10 questions, each asked on a screen like this. A full example survey is shown in the supplemental material on OSF.
</figcaption>
</figure>
</div>
</section>
<section id="dataset" class="level3">
<h3 class="anchored" data-anchor-id="dataset">Dataset</h3>
<p>We used a dataset on the survivors of the sinking of the <em>Titanic</em> in 1912. Each of the 2,201 survivors had four dimensions, which were all categorical variables: <code>class</code> (4 levels), <code>sex</code> (2 levels), <code>port of entry</code> (4 levels), and <code>survival status</code> (2 levels). The five tasks above were asked for two views with different dimensions. One view visualized class on X-axis, sex on Y-axis, and survival using color. The second view visualized survived on the X-axis, class on the Y-axis, and port of entry using color.</p>
<p><a href="#fig-study" class="quarto-xref">Figure&nbsp;11</a> shows an example study stimulus screen for the <em>Titanic</em> dataset using a normalized (space-filling) gatherplot for task <strong>T4</strong>. The <a href="https://osf.io/bk9cx/">OSF</a> repository contains a file <code>qualtrics-study.pdf</code> showing a full run of an experiment (10 questions).</p>
</section>
<section id="hypotheses" class="level3">
<h3 class="anchored" data-anchor-id="hypotheses">Hypotheses</h3>
<p>We believe that different types of tasks will favor from different type of layouts. Therefore, our hypotheses are as follows:</p>
<ul>
<li><p><strong>H1</strong> - For retrieving value considering one subgroup (T1), both absolute and normalized modes will yield better accuracy than jitter mode.</p></li>
<li><p><strong>H2</strong> - For tasks considering absolute values (T2 and T3), absolute mode will yield the best accuracy over other modes.</p></li>
<li><p><strong>H3</strong> - For tasks considering relative values (T4 and T5), normalized mode will yield the best accuracy over other modes.</p></li>
</ul>
</section>
<section id="results" class="level3">
<h3 class="anchored" data-anchor-id="results">Results</h3>
<p>The results were analyzed with respect to the accuracy (correct or incorrect), time spent, and confidence of estimation. Based on our hypotheses, we analyzed the different modes of layout for each type of question: retrieve value, absolute value task, and relative value task. In total, we recruited 42 participants for jitter, 56 participants for absolute, 56 participants for normalized, and 57 participants for interactive mode. The <a href="https://osf.io/bk9cx/">OSF</a> repository contains code and data for replicating our data analysis.</p>
<div id="fig-results" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-results" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-vis-accuracy" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Accuracy dotplot showing jitter with an accuracy around 0.45; the rest (absolute, normalized, both) are around 0.6.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-vis-accuracy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="plots/vis-accuracy.svg" class="img-fluid figure-img" data-ref-parent="fig-results" alt="Accuracy dotplot showing jitter with an accuracy around 0.45; the rest (absolute, normalized, both) are around 0.6.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-vis-accuracy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Accuracy.
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-results" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-vis-time" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Completion time dotplot showing jitter with a time around 32 seconds, absolute and normalized around 36 seconds, and both around 48 seconds.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-vis-time-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="plots/vis-time.svg" class="img-fluid figure-img" data-ref-parent="fig-results" alt="Completion time dotplot showing jitter with a time around 32 seconds, absolute and normalized around 36 seconds, and both around 48 seconds.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-vis-time-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Completion time.
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-results" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-vis-confidence" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Perceived confidence dotplot showing jitter and normalized with a confidence around 5 and absolute and both around 5.5 (1--7 Likert scale).">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-vis-confidence-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="plots/vis-confidence.svg" class="img-fluid figure-img" data-ref-parent="fig-results" alt="Perceived confidence dotplot showing jitter and normalized with a confidence around 5 and absolute and both around 5.5 (1--7 Likert scale).">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-vis-confidence-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Perceived confidence.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: <strong>Performance results.</strong> Effect of visualization on accuracy, completion time, and perceived confidence. Error bars show 95% confidence intervals calculated using bootstrapping (<span class="math inline">\(N=1,000\)</span> repetitions).}
</figcaption>
</figure>
</div>
<div id="fig-results-detail" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-results-detail-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-results-detail" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-taskxvis-accuracy" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Accuracy dotplot showing jitter, absolute, normalized, and both for tasks T1--T5.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-taskxvis-accuracy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="plots/taskxvis-accuracy.svg" class="img-fluid figure-img" data-ref-parent="fig-results-detail" alt="Accuracy dotplot showing jitter, absolute, normalized, and both for tasks T1--T5.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-taskxvis-accuracy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Accuracy.
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-results-detail" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-taskxvis-time" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Completion time dotplot showing jitter, absolute, normalized, and both for tasks T1--T5.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-taskxvis-time-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="plots/taskxvis-time.svg" class="img-fluid figure-img" data-ref-parent="fig-results-detail" alt="Completion time dotplot showing jitter, absolute, normalized, and both for tasks T1--T5.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-taskxvis-time-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Completion time.
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-results-detail" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-taskxvis-confidence" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Perceived confidence dotplot showing jitter, absolute, normalized, and both for tasks T1--T5.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-taskxvis-confidence-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="plots/taskxvis-confidence.svg" class="img-fluid figure-img" data-ref-parent="fig-results-detail" alt="Perceived confidence dotplot showing jitter, absolute, normalized, and both for tasks T1--T5.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-taskxvis-confidence-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Perceived confidence.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-results-detail-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: <strong>Detailed performance results.</strong> Effect of visualization and task (T1–T5) on accuracy, completion time, and perceived confidence. Error bars show 95% confidence intervals calculated using bootstrapping (<span class="math inline">\(N=1,000\)</span> repetitions).
</figcaption>
</figure>
</div>
<section id="accuracy" class="level4">
<h4 class="anchored" data-anchor-id="accuracy">Accuracy</h4>
<p>Accuracy performance results are summarized in <a href="#fig-vis-accuracy" class="quarto-xref">Figure&nbsp;12 (a)</a>, with detailed accuracy results by visualization type and task in <a href="#fig-taskxvis-accuracy" class="quarto-xref">Figure&nbsp;13 (a)</a>. The number and percentage of participants who answered correct and incorrect answers are shown in <a href="#fig-correctness" class="quarto-xref">Figure&nbsp;14</a>.</p>
<p>Based on the effect sizes and 95% confidence intervals, we see evidence that jittering yielded lower accuracy than other conditions, which were more or less equivalent in accuracy. This trend seems to mostly persist across all five tasks.</p>
<div id="fig-correctness" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-correctness-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-correctness" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-correctness1" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Correctness results from our crowdsourced user study.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-correctness1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="plots/task-performance-1.svg" class="img-fluid figure-img" data-ref-parent="fig-correctness" alt="Correctness results from our crowdsourced user study.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-correctness1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Task T1.
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-correctness" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-correctness2" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Correctness results from our crowdsourced user study.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-correctness2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="plots/task-performance-2.svg" class="img-fluid figure-img" data-ref-parent="fig-correctness" alt="Correctness results from our crowdsourced user study.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-correctness2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Task T2.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-correctness" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-correctness3" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Correctness results from our crowdsourced user study.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-correctness3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="plots/task-performance-3.svg" class="img-fluid figure-img" data-ref-parent="fig-correctness" alt="Correctness results from our crowdsourced user study.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-correctness3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Task T3.
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-correctness" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-correctness4" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Correctness results from our crowdsourced user study.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-correctness4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="plots/task-performance-4.svg" class="img-fluid figure-img" data-ref-parent="fig-correctness" alt="Correctness results from our crowdsourced user study.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-correctness4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) Task T4.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-correctness" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-correctness5" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Correctness results from our crowdsourced user study.">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-correctness5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="plots/task-performance-5.svg" class="img-fluid figure-img" data-ref-parent="fig-correctness" alt="Correctness results from our crowdsourced user study.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-correctness5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(e) Task T5.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-correctness-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: <strong>Correctness results from our crowdsourced user study.</strong> <a href="#fig-correctness1" class="quarto-xref">14 (a)</a> Correctness for retrieving value (T1). <a href="#fig-correctness2" class="quarto-xref">14 (b)</a> Correctness for absolute comparison (T2). <a href="#fig-correctness3" class="quarto-xref">14 (c)</a> Corrnectness for absolute ranking (T3). <a href="#fig-correctness4" class="quarto-xref">14 (d)</a> Correctness for relative/normalized comparison (T4). <a href="#fig-correctness5" class="quarto-xref">14 (e)</a> Correctness for relative/normalized ranking (T5).
</figcaption>
</figure>
</div>
</section>
<section id="completion-time" class="level4">
<h4 class="anchored" data-anchor-id="completion-time">Completion Time</h4>
<p>Completion time performance results are summarized in <a href="#fig-vis-time" class="quarto-xref">Figure&nbsp;12 (b)</a>, with detailed accuracy results by visualization type and task in <a href="#fig-taskxvis-time" class="quarto-xref">Figure&nbsp;13 (b)</a>. For the retrieve-value task (T1), on average, the completion time (sec) for each interface was for jitter 31.79, absolute 36.83, normalized 36.55, and both 49.21. For the absolute-value task (T2 and T3), on average, the completion time (sec) for each interface was for jitter 29.45, absolute 37.98, normalized 34.84, and both 50.73. For relative-value task (T4 and T5), on average, the completion time for each interface was for jitter 31.77, absolute 32.27, normalized 34.95, and both 46.60.</p>
<p>Based on the results, we see evidence that the both condition (absolute and normalized accessed using a toggle) yielded longer completion times than the other conditions, although this is not consistent across tasks. There is also some evidence that jitter on average yielded a shorter completion time, but again not consistently across all five tasks.</p>
</section>
<section id="confidence" class="level4">
<h4 class="anchored" data-anchor-id="confidence">Confidence</h4>
<p>The participants self-reported level of confidence was reported using a 7-point Likert-scale rating. Confidence performance results are summarized in <a href="#fig-vis-confidence" class="quarto-xref">Figure&nbsp;12 (c)</a>, with detailed accuracy results by visualization type and task in <a href="#fig-taskxvis-confidence" class="quarto-xref">Figure&nbsp;13 (c)</a>. This data shows some evidence that jittering and normalized mode instilled lower confidence than absolute and both modes.</p>
<p>For the value-retrieving task (T1), a Kruskal-Wallis non-parametric test revealed that the type of interface had significant impact on the confidence level (<span class="math inline">\(\chi^2(3) = 74.57 p &lt; 0.01\)</span>). The mean rating for each interface was for jitter 4.8, absolute 6.3, normalized 6.0, and both 6.25. A post-hoc Pairwise Wilcoxon Rank Sum test was employed with Bonferroni correction to adjust for multiple comparisons. The jitter interface was significantly lower than the other three modes ($ p &lt; 0.01$ for all cases). There was no difference between absolute, normalized, and both interfaces.</p>
<p>For absolute-value tasks (T2 and T3), a Kruskal-Wallis non-parametric test revealed that the type of interface had significant impact on the confidence level (<span class="math inline">\(\chi^2(3) = 18.32, p &lt; 0.01\)</span>). The mean rating for each interface was jitter 5.4, absolute 5.7, normalized 5.0, and both 5.8. A post-hoc Pairwise Wilcoxon Rank Sum test was employed with Bonferroni correction to adjust for multiple comparisons. The interface with both modes was significantly higher than normalized and jitter mode (<span class="math inline">\(p &lt; 0.01\)</span> for both); however, there was no difference with the absolute mode. The interface with absolute mode was significantly higher than normalized and jitter mode (<span class="math inline">\(p &lt; 0.01\)</span>).</p>
<p>For relative-value tasks (T4 and T5), a Kruskal-Wallis non-parametric test revealed that the type of interface did not have significant impact on the relative tasks (<span class="math inline">\(\chi^2(3) = 4.1, p = 0.2\)</span>). The mean rating was jitter 4.7, absolute 4.9, relative 4.9, and both 4.8.</p>
<p>One possibility for explaining this result is that the relative task is more difficult than the other tasks. The low correct percentage of questions are also shown in <a href="#fig-correctness" class="quarto-xref">Figure&nbsp;14</a>. To see that, we tested the confidence level between task types. A Kruskal-Wallis non-parametric test revealed that the type of task had significant impact on the confidence level (<span class="math inline">\(\chi^2(2) = 148.1, p &lt; 0.01\)</span>). The mean rating for retrieving value 5.9, absolute 5.5, and normalized 4.8. The post-hoc Pairwise Wilcoxon Rank Sum test was employed with Bonferroni correction to adjust for multiple comparisons, and showed that all three task types were significantly different (<span class="math inline">\(p &lt; 0.01\)</span> for all cases).</p>
<!-- ========================================================================== -->
</section>
</section>
</section>
<section id="discussion" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="discussion"><span class="header-section-number">6</span> Discussion</h2>
<p>Our results show that the gatherplots technique enable people to assess data distribution more quickly and more correctly than when using jittered scatterplots. It is plausible that the ordered grid layout used for marks in the gatherplots technique better supports quickly estimating (or even counting) the marks compared to merely randomly jittering the points. However, there are several limitations to this work that may affect its generalizability and overall utility.</p>
<p>By virtue of being a unit visualization <span class="citation" data-cites="Park2018">(<a href="#ref-Park2018" role="doc-biblioref">Park et al. 2018</a>)</span>, where each data point is assigned a unique visual mark, the gatherplots technique is not primarily designed for large scale datasets. For situations with several thousands or more data points, the corresponding visual marks will become so small that they are not easily distinguishable as individual units. Accordingly, the user study presented in this paper was limited to the Titanic dataset with only some 2,200 data points. We suspect that many of these findings will not bear out for datasets only an order of magnitude larger.</p>
<p>Analogously, gatherplots are not suitable for conveying datasets with a large number of data dimensions. The technique is currently only designed with a single categorical dimension per geometric axis, plus one assigned to mark color. The axes could presumably be subdivided into multiple categories, similar to the Dataopsy technique <span class="citation" data-cites="DBLP:journals/tvcg/HoqueE24">(<a href="#ref-DBLP:journals/tvcg/HoqueE24" role="doc-biblioref">Hoque and Elmqvist 2024</a>)</span>, but that is beyond the scope of this paper.</p>
<p>We chose to include an interactive setting—``both’’—in our experiment where participants were allowed to toggle between absolutel and normalized mode. However, the results show that this condition yielded significantly longer completion times with little to no improvement in accuracy or confidence. The increased completion time may not be a surprise because of the toggle interaction. Furthermore, the fact that both absolute and normalized mode had no specific benefit in their own right also explains why their combination was also not superior.</p>
<p>Finally, the gatherplots technique includes carefully designed interval marks to convey the fact that a gatherplot axis is partitioned rather than continuous. Nevertheless, we have not evaluated the efficacy of this visual language. Since regular scatterplots use continuous axes, it is not clear how well a novice user will grasp the partitioned nature of a gatherplot.</p>
<!-- ========================================================================== -->
</section>
<section id="conclusion-and-future-work" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="conclusion-and-future-work"><span class="header-section-number">7</span> Conclusion and Future Work</h2>
<p>We have proposed the concept of the gather transformation, which enables space-filling layout without overdrawing while maintaining object constancy. We then applied this transformation to scatterplots, resulting in gatherplots, a generalization of scatterplots, which enable overview without clutter. While gatherplots are optimal for categorical variables, it can also be used to ameliorate overplotting caused by continuous ordinal variables. We discussed several aspects of gatherplots including layout, coloring, tick format, and matrix formations. We also evaluated the technique with a crowdsourced user study showing that gatherplots are generally more effective than jittering, and absolute and relative mode serve specific types of tasks better. Finally, we applied the gathering transformation to a Magic Lens interaction for local control; this lens has three different layout modes.</p>
<p>We believe that gathering is a general framework that captures the transition between overlapping and space-filling visualizations while maintaining object identities. In the future, we plan on studying the application of this framework to other visual representations. For example, overplotting is a common problem when visualizing categorical variables in a parallel coordinates plot. Parallel sets aggregate elements for the same value of a categorical variable into blocks, but loses the identity of objects. By applying the gathering framework, parallel sets can be reconstructed to render individual lines instead of block lines, which would enable combining both categorical and continuous variables. Furthermore, we also want to study additional gathering-based interaction techniques beyond the GatherLens proposed here.</p>
</section>
<section id="references" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Bederson2002" class="csl-entry" role="listitem">
Bederson, Benjamin B, Ben Shneiderman, and Martin Wattenberg. 2002. <span>“Ordered and Quantum Treemaps: Making Effective Use of <span>2D</span> Space to Display Hierarchies.”</span> <em>ACM Transactions on Graphics</em> 21 (4): 833–54. <a href="https://doi.org/10.1145/571647.571649">https://doi.org/10.1145/571647.571649</a>.
</div>
<div id="ref-Bertin1983" class="csl-entry" role="listitem">
Bertin, Jacques. 1983. <em>Semiology of Graphics</em>. Madison, WI, USA: University of Wisconsin Press.
</div>
<div id="ref-Bezerianos2010" class="csl-entry" role="listitem">
Bezerianos, Anastasia, Fanny Chevalier, Pierre Dragicevic, Niklas Elmqvist, and Jean-Daniel Fekete. 2010. <span>“<span>GraphDice</span>: <span>A</span> System for Exploring Multivariate Social Networks.”</span> <em>Computer Graphics Forum</em> 29 (3): 863–72. <a href="https://doi.org/10.1111/j.1467-8659.2009.01687.x">https://doi.org/10.1111/j.1467-8659.2009.01687.x</a>.
</div>
<div id="ref-Chen2018" class="csl-entry" role="listitem">
Chen, Helen, Sophie Engle, Alark Joshi, Eric D. Ragan, Beste F. Yuksel, and Lane Harrison. 2018. <span>“Using Animation to Alleviate Overdraw in Multiclass Scatterplot Matrices.”</span> In <em>Proceedings of the ACM Conference on Human Factors in Computing Systems</em>, 417:1–12. ACM. <a href="https://doi.org/10.1145/3173574">https://doi.org/10.1145/3173574</a>.
</div>
<div id="ref-Chernoff1973" class="csl-entry" role="listitem">
Chernoff, Herman. 1973. <span>“The Use of Faces to Represent Points in k-Dimensional Space Graphically.”</span> <em>Journal of the American Statistical Association</em> 68 (342): 361–68. <a href="https://doi.org/10.2307/2284077">https://doi.org/10.2307/2284077</a>.
</div>
<div id="ref-Cleveland1988" class="csl-entry" role="listitem">
Cleveland, William S., and Marylyn E. McGill. 1988. <em>Dynamic Graphics for Statistics</em>. Belmont, CA, USA: Wadsworth &amp; Brooks/Cole.
</div>
<div id="ref-Cleveland1985" class="csl-entry" role="listitem">
Cleveland, William S., and R. McGill. 1985. <span>“Graphical Perception and Graphical Methods for Analyzing Scientific Data.”</span> <em>Science</em> 229 (4716): 828–33. <a href="https://doi.org/10.1126/science.229.4716.828">https://doi.org/10.1126/science.229.4716.828</a>.
</div>
<div id="ref-Cosmides1996" class="csl-entry" role="listitem">
Cosmides, Leda, and John Tooby. 1996. <span>“Are Humans Good Intuitive Statisticians After All? <span>R</span>ethinking Some Conclusions from the Literature on Judgment Under Uncertainty.”</span> <em>Cognition</em> 58 (1): 1–73. <a href="https://doi.org/10.1016/0010-0277(95)00664-8">https://doi.org/10.1016/0010-0277(95)00664-8</a>.
</div>
<div id="ref-Dang2010" class="csl-entry" role="listitem">
Dang, Tuan Nhon, Leland Wilkinson, and Anushka Anand. 2010. <span>“Stacking Graphic Elements to Avoid over-Plotting.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 16 (6): 1044–52. <a href="https://doi.org/10.1109/TVCG.2010.197">https://doi.org/10.1109/TVCG.2010.197</a>.
</div>
<div id="ref-Dix2002" class="csl-entry" role="listitem">
Dix, Alan, and Geoffrey Ellis. 2002. <span>“By Chance - Enhancing Interaction with Large Data Sets Through Statistical Sampling.”</span> In <em>Proceedings of the ACM Conference on Advanced Visual Interfaces</em>, 167–76. New York, NY, USA: ACM. <a href="https://doi.org/10.1145/1556262.1556289">https://doi.org/10.1145/1556262.1556289</a>.
</div>
<div id="ref-beeswarm" class="csl-entry" role="listitem">
Eklund, Aron, and James Trimble. 2021. <em>Beeswarm: The Bee Swarm Plot, an Alternative to Stripchart</em>. <a href="https://cran.r-project.org/package=beeswarm">https://cran.r-project.org/package=beeswarm</a>.
</div>
<div id="ref-Ellis2007" class="csl-entry" role="listitem">
Ellis, Geoffrey, and Alan Dix. 2007. <span>“A Taxonomy of Clutter Reduction for Information Visualisation.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 13 (6): 1216–23. <a href="https://doi.org/10.1109/TVCG.2007.70535">https://doi.org/10.1109/TVCG.2007.70535</a>.
</div>
<div id="ref-Elmqvist2008" class="csl-entry" role="listitem">
Elmqvist, Niklas, Pierre Dragicevic, and Jean-Daniel Fekete. 2008. <span>“Rolling the Dice: Multidimensional Visual Exploration Using Scatterplot Matrix Navigation.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 14 (6): 1539–1148. <a href="https://doi.org/10.1109/TVCG.2008.153">https://doi.org/10.1109/TVCG.2008.153</a>.
</div>
<div id="ref-Elmqvist2010" class="csl-entry" role="listitem">
Elmqvist, Niklas, and Jean-Daniel Fekete. 2010. <span>“Hierarchical Aggregation for Information Visualization: Overview, Techniques and Design Guidelines.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 16 (3): 439–54. <a href="https://doi.org/10.1109/TVCG.2009.84">https://doi.org/10.1109/TVCG.2009.84</a>.
</div>
<div id="ref-Fekete2002" class="csl-entry" role="listitem">
Fekete, Jean-Daniel, and Catherine Plaisant. 2002. <span>“Interactive Information Visualization of a Million Items.”</span> In <em>Proceedings of the IEEE Symposium on Information Visualization</em>, 117–24. Los Alamitos, CA, USA: IEEE Computer Society. <a href="https://doi.org/10.1109/INFVIS.2002.1173156">https://doi.org/10.1109/INFVIS.2002.1173156</a>.
</div>
<div id="ref-Fua1999" class="csl-entry" role="listitem">
Fua, Ying-Huey, Matthew O. Ward, and Elke A. Rundensteiner. 1999. <span>“Hierarchical Parallel Coordinates for Exploration of Large Datasets.”</span> In <em>Proceedings of the IEEE Conference on Visualization</em>, 43–50. <a href="https://doi.org/10.1109/VISUAL.1999.809866">https://doi.org/10.1109/VISUAL.1999.809866</a>.
</div>
<div id="ref-Haroz2012" class="csl-entry" role="listitem">
Haroz, Steve, and David Whitney. 2012. <span>“How Capacity Limits of Attention Influence Information Visualization Effectiveness.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 18 (12): 2402–10. <a href="https://doi.org/10.1109/TVCG.2012.233">https://doi.org/10.1109/TVCG.2012.233</a>.
</div>
<div id="ref-Havre2000" class="csl-entry" role="listitem">
Havre, Susan, Beth Hetzler, and Lucy Nowell. 2000. <span>“<span>ThemeRiver</span>: Visualizing Theme Changes over Time.”</span> In <em>Proceedings of the IEEE Symposium on Information Visualization</em>, 115–23. <a href="https://doi.org/10.1109/INFVIS.2000.885098">https://doi.org/10.1109/INFVIS.2000.885098</a>.
</div>
<div id="ref-Hofmann2000" class="csl-entry" role="listitem">
Hofmann, Heike, Arno P. J. M. Siebes, and Adalbert F. X. Wilhelm. 2000. <span>“Visualizing Association Rules with Interactive Mosaic Plots.”</span> In <em>Proceedings of the ACM Conference on Knowledge Discovery and Data Mining</em>, 227–35. <a href="https://doi.org/10.1145/347090.347133">https://doi.org/10.1145/347090.347133</a>.
</div>
<div id="ref-DBLP:journals/tvcg/HoqueE24" class="csl-entry" role="listitem">
Hoque, Md. Naimul, and Niklas Elmqvist. 2024. <span>“Dataopsy: Scalable and Fluid Visual Exploration Using Aggregate Query Sculpting.”</span> <em><span>IEEE</span> Transactions on Visualization and Computer Graphics</em> 30 (1): 186–96. <a href="https://doi.org/10.1109/TVCG.2023.3326594">https://doi.org/10.1109/TVCG.2023.3326594</a>.
</div>
<div id="ref-Huron2013" class="csl-entry" role="listitem">
Huron, Samuel, Romain Vuillemot, and Jean-Daniel Fekete. 2013. <span>“Visual Sedimentation.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 19 (12): 2446–55. <a href="https://doi.org/10.1109/TVCG.2013.227">https://doi.org/10.1109/TVCG.2013.227</a>.
</div>
<div id="ref-Im2013" class="csl-entry" role="listitem">
Im, Jean-François, Michael J. McGuffin, and Rock Leung. 2013. <span>“<span>GPLOM</span>: The Generalized Plot Matrix for Visualizing Multidimensional Multivariate Data.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 19 (12): 2606–14. <a href="https://doi.org/10.1109/TVCG.2013.160">https://doi.org/10.1109/TVCG.2013.160</a>.
</div>
<div id="ref-DBLP:journals/ivs/KeimHDJB10" class="csl-entry" role="listitem">
Keim, Daniel A., Ming C. Hao, Umeshwar Dayal, Halldor Janetzko, and Peter Bak. 2010. <span>“Generalized Scatter Plots.”</span> <em>Information Visualization</em> 9 (4): 301–11. <a href="https://doi.org/10.1057/ivs.2009.34">https://doi.org/10.1057/ivs.2009.34</a>.
</div>
<div id="ref-Kosara2006" class="csl-entry" role="listitem">
Kosara, Robert, Fabian Bendix, and Helwig Hauser. 2006. <span>“Parallel Sets: Interactive Exploration and Visual Analysis of Categorical Data.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 12 (4): 558–68. <a href="https://doi.org/10.1109/TVCG.2006.76">https://doi.org/10.1109/TVCG.2006.76</a>.
</div>
<div id="ref-Mayorga2013" class="csl-entry" role="listitem">
Mayorga, A., and Michael Gleicher. 2013. <span>“Splatterplots: Overcoming Overdraw in Scatter Plots.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 19 (9). <a href="https://doi.org/10.1109/TVCG.2013.65">https://doi.org/10.1109/TVCG.2013.65</a>.
</div>
<div id="ref-McDonnel2009" class="csl-entry" role="listitem">
McDonnel, Bryan, and Niklas Elmqvist. 2009. <span>“Towards Utilizing <span>GPUs</span> in Information Visualization: A Model and Implementation of Image-Space Operations.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 15 (6): 1105–12. <a href="https://doi.org/10.1109/TVCG.2009.191">https://doi.org/10.1109/TVCG.2009.191</a>.
</div>
<div id="ref-Micallef2012" class="csl-entry" role="listitem">
Micallef, Luanna, Pierre Dragicevic, and Jean-Daniel Fekete. 2012. <span>“Assessing the Effect of Visualizations on <span>B</span>ayesian Reasoning Through Crowdsourcing.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 18 (12): 2536–45. <a href="https://doi.org/10.1109/TVCG.2012.199">https://doi.org/10.1109/TVCG.2012.199</a>.
</div>
<div id="ref-Sanddance" class="csl-entry" role="listitem">
Microsoft Research. 2011. <span>“SandDance.”</span> <a href="https://www.microsoft.com/en-us/research/project/sanddance/" class="uri">https://www.microsoft.com/en-us/research/project/sanddance/</a>.
</div>
<div id="ref-Munzner2003" class="csl-entry" role="listitem">
Munzner, Tamara, François Guimbretière, Serdar Tasiran, Li Zhang, and Yunhong Zhou. 2003. <span>“<span>TreeJuxtaposer</span>: Scalable Tree Comparison Using <span>Focus+Context</span> with Guaranteed Visibility.”</span> <em>ACM Transactions on Graphics</em> 22 (3): 453–62. <a href="https://doi.org/10.1145/1201775.882291">https://doi.org/10.1145/1201775.882291</a>.
</div>
<div id="ref-Paolacci2010" class="csl-entry" role="listitem">
Paolacci, Gabriele, Jesse Chandler, and Panagiotis Ipeirotis. 2010. <span>“Running Experiments on <span>A</span>mazon <span>M</span>echanical <span>T</span>urk.”</span> <em>Judgment and Decision Making</em> 5 (5): 411–19. <a href="https://doi.org/10.1017/S1930297500002205">https://doi.org/10.1017/S1930297500002205</a>.
</div>
<div id="ref-Park2018" class="csl-entry" role="listitem">
Park, Deok Gun, Steven M. Drucker, Roland Fernandez, and Niklas Elmqvist. 2018. <span>“<span>ATOM</span>: A Grammar for Unit Visualization.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 24 (12): 3032–43. <a href="https://doi.org/10.1109/TVCG.2017.2785807">https://doi.org/10.1109/TVCG.2017.2785807</a>.
</div>
<div id="ref-DBLP:conf/chi/RzeszotarskiK14" class="csl-entry" role="listitem">
Rzeszotarski, Jeffrey M., and Aniket Kittur. 2014. <span>“Kinetica: Naturalistic Multi-Touch Data Visualization.”</span> In <em>Proceedings of the ACM Conference on Human Factors in Computing Systems</em>, 897–906. ACM. <a href="https://doi.org/10.1145/2556288.2557231">https://doi.org/10.1145/2556288.2557231</a>.
</div>
<div id="ref-DBLP:journals/tvcg/SarikayaG18" class="csl-entry" role="listitem">
Sarikaya, Alper, and Michael Gleicher. 2018. <span>“Scatterplots: Tasks, Data, and Designs.”</span> <em><span>IEEE</span> Transactions on Visualization and Computer Graphics</em> 24 (1): 402–12. <a href="https://doi.org/10.1109/TVCG.2017.2744184">https://doi.org/10.1109/TVCG.2017.2744184</a>.
</div>
<div id="ref-Shneiderman1996" class="csl-entry" role="listitem">
Shneiderman, Ben. 1996. <span>“The Eyes Have It: A Task by Data Type Taxonomy for Information Visualizations.”</span> In <em>Proceedings of the IEEE Symposium on Visual Languages</em>, 336–43. <a href="https://doi.org/10.1109/VL.1996.545307">https://doi.org/10.1109/VL.1996.545307</a>.
</div>
<div id="ref-Shneiderman2000" class="csl-entry" role="listitem">
Shneiderman, Ben, David Feldman, Anne Rose, and Xavier Ferré Grau. 2000. <span>“Visualizing Digital Library Search Results with Categorical and Hierarchical Axes.”</span> In <em>Proceedings of the ACM Conference on Digital Libraries</em>, 57--66. <a href="https://doi.org/10.1145/336597.336637">https://doi.org/10.1145/336597.336637</a>.
</div>
<div id="ref-Silverman1986" class="csl-entry" role="listitem">
Silverman, B. W. 1986. <em>Density Estimation for Statistics and Data Analysis</em>. Boca Raton, FL, USA: Chapman &amp; Hall/CRC.
</div>
<div id="ref-Stevens1946" class="csl-entry" role="listitem">
Stevens, S. S. 1946. <span>“On the Theory of Scales of Measurement.”</span> <em>Science</em> 103 (2684): 677–80. <a href="https://doi.org/10.1126/science.103.2684.677">https://doi.org/10.1126/science.103.2684.677</a>.
</div>
<div id="ref-Trutschl2003" class="csl-entry" role="listitem">
Trutschl, Marjan, Georges Grinstein, and Urska Cvek. 2003. <span>“Intelligently Resolving Point Occlusion.”</span> In <em>Proceedings of IEEE Symposium on Information Visualization</em>, 131–36. <a href="https://doi.org/10.1109/INFVIS.2003.1249018">https://doi.org/10.1109/INFVIS.2003.1249018</a>.
</div>
<div id="ref-Tufte1983" class="csl-entry" role="listitem">
Tufte, Edward R. 1983. <em>The Visual Display of Quantitative Information</em>. Cheshire, CT, USA: Graphics Press.
</div>
<div id="ref-Utts1996" class="csl-entry" role="listitem">
Utts, Jessica M. 1996. <em>Seeing Through Statistics</em>. London, UK: Duxbury Press.
</div>
<div id="ref-Waskom2021" class="csl-entry" role="listitem">
Waskom, Michael L. 2021. <span>“Seaborn: Statistical Data Visualization.”</span> <em>Journal of Open Source Software</em> 6 (60). <a href="https://doi.org/10.21105/joss.03021">https://doi.org/10.21105/joss.03021</a>.
</div>
<div id="ref-Wickham2011" class="csl-entry" role="listitem">
Wickham, Hadley, and Lisa Stryjewski. 2011. <span>“40 Years of Boxplots.”</span> <em>American Statistician</em>.
</div>
<div id="ref-Wilkinson1999" class="csl-entry" role="listitem">
Wilkinson, Leland. 1999. <span>“Dot Plots.”</span> <em>The American Statistician</em> 53 (3): 276–81. <a href="https://doi.org/10.1080/00031305.1999.10474474">https://doi.org/10.1080/00031305.1999.10474474</a>.
</div>
<div id="ref-Willett2013" class="csl-entry" role="listitem">
Willett, Wesley, Shiry Ginosar, Avital Steinitz, Björn Hartmann, and Maneesh Agrawala. 2013. <span>“Identifying Redundancy and Exposing Provenance in Crowdsourced Data Analysis.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 19 (12): 2198–2206. <a href="https://doi.org/10.1109/TVCG.2013.164">https://doi.org/10.1109/TVCG.2013.164</a>.
</div>
<div id="ref-DBLP:journals/ivs/YiMSJ05" class="csl-entry" role="listitem">
Yi, Ji Soo, Rachel Melton, John T. Stasko, and Julie A. Jacko. 2005. <span>“Dust <span>&amp;</span> Magnet: Multivariate Information Visualization Using a Magnet Metaphor.”</span> <em>Information Visualization</em> 4 (3): 239–56. <a href="https://doi.org/10.1057/PALGRAVE.IVS.9500099">https://doi.org/10.1057/PALGRAVE.IVS.9500099</a>.
</div>
<div id="ref-Zhai1996" class="csl-entry" role="listitem">
Zhai, Shumin, William Buxton, and Paul Milgram. 1996. <span>“The Partial-Occlusion Effect: Utilizing Semitransparency in <span>3D</span> Human-Computer Interaction.”</span> <em>ACM Transactions on Computer-Human Interaction</em> 3 (3): 254–84. <a href="https://doi.org/10.1145/234526.234532">https://doi.org/10.1145/234526.234532</a>.
</div>
</div>
</section>
<section id="research-material-statements" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="research-material-statements">Research Material Statements</h2>
<p>Source code for the web-based reference implementation of Gatherplots can be found at <a href="https://github.com/intuinno/gatherplot">https://github.com/intuinno/gatherplot</a>. A live demo of this implementation is linked at <a href="https://gatherplot.firebaseapp.com/">https://gatherplot.firebaseapp.com/</a>. This interactive article also contains a Gaterplot implementation. The raw results from the crowdsourced user study (reported in <a href="#sec-eval" class="quarto-xref">Section&nbsp;5</a>) can be found on OSF at <a href="https://osf.io/bk9cx/">https://osf.io/bk9cx/</a>.</p>
</section>
<section id="authorship" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="authorship">Authorship</h2>
<p><strong>Deokgun Park</strong>: Conceptualization, Investigation, Methodology, Software, Writing - Original Draft, Writing - Review &amp; Editing, Visualization. <strong>Sung-Hee Kim</strong>: Data Curation, Formal Analysis, Investigation, Methodology, Validation, Visualization. <strong>Niklas Elmqvist</strong>: Conceptualization, Investigation, Methodology, Software, Supervision, Writing - Original Draft, Writing - Review &amp; Editing, Visualization.</p>
</section>
<section id="license" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="license">License</h2>
<p>This work is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</p>
</section>
<section id="conflict-of-interest" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="conflict-of-interest">Conflict of Interest</h2>
<p>At the time of submission, <strong>Niklas Elmqvist</strong> is listed as an associate editor for the <a href="https://www.journalovi.org/">Journal of Visualization and Interaction</a>. The authors declare that there are no other competing interests.</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb8" data-startfrom="864" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 863;"><span id="cb8-864"><a href="#cb8-864" aria-hidden="true" tabindex="-1"></a>cars <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"cars.csv"</span>)<span class="op">.</span><span class="fu">csv</span>({ <span class="dt">typed</span><span class="op">:</span> <span class="kw">true</span> })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb9" data-startfrom="868" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 867;"><span id="cb9-868"><a href="#cb9-868" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> {Legend<span class="op">,</span> Swatches} <span class="im">from</span> <span class="st">"@d3/color-legend"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-9" data-nodetype="declaration">

</div>
</div>
</div>
<!--
// Copyright 2021 Observable, Inc.
// Released under the ISC license.
// https://observablehq.com/@d3/scatterplot
-->
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb10" data-startfrom="877" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 876;"><span id="cb10-877"><a href="#cb10-877" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">Scatterplot</span>(data<span class="op">,</span> {</span>
<span id="cb10-878"><a href="#cb10-878" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> ([x]) <span class="kw">=&gt;</span> x<span class="op">,</span> <span class="co">// given d in data, returns the (quantitative) x-value</span></span>
<span id="cb10-879"><a href="#cb10-879" aria-hidden="true" tabindex="-1"></a>  y <span class="op">=</span> ([<span class="op">,</span> y]) <span class="kw">=&gt;</span> y<span class="op">,</span> <span class="co">// given d in data, returns the (quantitative) y-value</span></span>
<span id="cb10-880"><a href="#cb10-880" aria-hidden="true" tabindex="-1"></a>  c <span class="op">=</span> ([<span class="op">,</span> <span class="op">,</span> c]) <span class="kw">=&gt;</span> c<span class="op">,</span></span>
<span id="cb10-881"><a href="#cb10-881" aria-hidden="true" tabindex="-1"></a>  r <span class="op">=</span> <span class="dv">3</span><span class="op">,</span> <span class="co">// (fixed) radius of dots, in pixels</span></span>
<span id="cb10-882"><a href="#cb10-882" aria-hidden="true" tabindex="-1"></a>  title<span class="op">,</span> <span class="co">// given d in data, returns the title</span></span>
<span id="cb10-883"><a href="#cb10-883" aria-hidden="true" tabindex="-1"></a>  marginTop <span class="op">=</span> <span class="dv">20</span><span class="op">,</span> <span class="co">// top margin, in pixels</span></span>
<span id="cb10-884"><a href="#cb10-884" aria-hidden="true" tabindex="-1"></a>  marginRight <span class="op">=</span> <span class="dv">30</span><span class="op">,</span> <span class="co">// right margin, in pixels</span></span>
<span id="cb10-885"><a href="#cb10-885" aria-hidden="true" tabindex="-1"></a>  marginBottom <span class="op">=</span> <span class="dv">30</span><span class="op">,</span> <span class="co">// bottom margin, in pixels</span></span>
<span id="cb10-886"><a href="#cb10-886" aria-hidden="true" tabindex="-1"></a>  marginLeft <span class="op">=</span> <span class="dv">40</span><span class="op">,</span> <span class="co">// left margin, in pixels</span></span>
<span id="cb10-887"><a href="#cb10-887" aria-hidden="true" tabindex="-1"></a>  inset <span class="op">=</span> r <span class="op">*</span> <span class="dv">2</span><span class="op">,</span> <span class="co">// inset the default range, in pixels</span></span>
<span id="cb10-888"><a href="#cb10-888" aria-hidden="true" tabindex="-1"></a>  insetTop <span class="op">=</span> inset<span class="op">,</span> <span class="co">// inset the default y-range</span></span>
<span id="cb10-889"><a href="#cb10-889" aria-hidden="true" tabindex="-1"></a>  insetRight <span class="op">=</span> inset<span class="op">,</span> <span class="co">// inset the default x-range</span></span>
<span id="cb10-890"><a href="#cb10-890" aria-hidden="true" tabindex="-1"></a>  insetBottom <span class="op">=</span> inset<span class="op">,</span> <span class="co">// inset the default y-range</span></span>
<span id="cb10-891"><a href="#cb10-891" aria-hidden="true" tabindex="-1"></a>  insetLeft <span class="op">=</span> inset<span class="op">,</span> <span class="co">// inset the default x-range</span></span>
<span id="cb10-892"><a href="#cb10-892" aria-hidden="true" tabindex="-1"></a>  width <span class="op">=</span> <span class="dv">640</span><span class="op">,</span> <span class="co">// outer width, in pixels</span></span>
<span id="cb10-893"><a href="#cb10-893" aria-hidden="true" tabindex="-1"></a>  height <span class="op">=</span> <span class="dv">400</span><span class="op">,</span> <span class="co">// outer height, in pixels</span></span>
<span id="cb10-894"><a href="#cb10-894" aria-hidden="true" tabindex="-1"></a>  xType <span class="op">=</span> d3<span class="op">.</span><span class="at">scaleLinear</span><span class="op">,</span> <span class="co">// type of x-scale</span></span>
<span id="cb10-895"><a href="#cb10-895" aria-hidden="true" tabindex="-1"></a>  xDomain<span class="op">,</span> <span class="co">// [xmin, xmax]</span></span>
<span id="cb10-896"><a href="#cb10-896" aria-hidden="true" tabindex="-1"></a>  xRange <span class="op">=</span> [marginLeft <span class="op">+</span> insetLeft<span class="op">,</span> width <span class="op">-</span> marginRight <span class="op">-</span> insetRight]<span class="op">,</span> <span class="co">// [left, right]</span></span>
<span id="cb10-897"><a href="#cb10-897" aria-hidden="true" tabindex="-1"></a>  yType <span class="op">=</span> d3<span class="op">.</span><span class="at">scaleLinear</span><span class="op">,</span> <span class="co">// type of y-scale</span></span>
<span id="cb10-898"><a href="#cb10-898" aria-hidden="true" tabindex="-1"></a>  yDomain<span class="op">,</span> <span class="co">// [ymin, ymax]</span></span>
<span id="cb10-899"><a href="#cb10-899" aria-hidden="true" tabindex="-1"></a>  yRange <span class="op">=</span> [height <span class="op">-</span> marginBottom <span class="op">-</span> insetBottom<span class="op">,</span> marginTop <span class="op">+</span> insetTop]<span class="op">,</span> <span class="co">// [bottom, top]</span></span>
<span id="cb10-900"><a href="#cb10-900" aria-hidden="true" tabindex="-1"></a>  cType <span class="op">=</span> d3<span class="op">.</span><span class="at">scaleOrdinal</span><span class="op">,</span></span>
<span id="cb10-901"><a href="#cb10-901" aria-hidden="true" tabindex="-1"></a>  cRange <span class="op">=</span> d3<span class="op">.</span><span class="at">schemeCategory10</span><span class="op">,</span></span>
<span id="cb10-902"><a href="#cb10-902" aria-hidden="true" tabindex="-1"></a>  xLabel<span class="op">,</span> <span class="co">// a label for the x-axis</span></span>
<span id="cb10-903"><a href="#cb10-903" aria-hidden="true" tabindex="-1"></a>  yLabel<span class="op">,</span> <span class="co">// a label for the y-axis</span></span>
<span id="cb10-904"><a href="#cb10-904" aria-hidden="true" tabindex="-1"></a>  xFormat<span class="op">,</span> <span class="co">// a format specifier string for the x-axis</span></span>
<span id="cb10-905"><a href="#cb10-905" aria-hidden="true" tabindex="-1"></a>  yFormat<span class="op">,</span> <span class="co">// a format specifier string for the y-axis</span></span>
<span id="cb10-906"><a href="#cb10-906" aria-hidden="true" tabindex="-1"></a>  jitter <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="fl">0.0</span><span class="op">,</span></span>
<span id="cb10-907"><a href="#cb10-907" aria-hidden="true" tabindex="-1"></a>  fill <span class="op">=</span> <span class="st">"none"</span><span class="op">,</span> <span class="co">// fill color for dots</span></span>
<span id="cb10-908"><a href="#cb10-908" aria-hidden="true" tabindex="-1"></a>  stroke <span class="op">=</span> <span class="st">"currentColor"</span><span class="op">,</span> <span class="co">// stroke color for the dots</span></span>
<span id="cb10-909"><a href="#cb10-909" aria-hidden="true" tabindex="-1"></a>  strokeWidth <span class="op">=</span> <span class="fl">1.5</span><span class="op">,</span> <span class="co">// stroke width for dots</span></span>
<span id="cb10-910"><a href="#cb10-910" aria-hidden="true" tabindex="-1"></a>  halo <span class="op">=</span> <span class="st">"#fff"</span><span class="op">,</span> <span class="co">// color of label halo</span></span>
<span id="cb10-911"><a href="#cb10-911" aria-hidden="true" tabindex="-1"></a>  haloWidth <span class="op">=</span> <span class="dv">3</span> <span class="co">// padding around the labels</span></span>
<span id="cb10-912"><a href="#cb10-912" aria-hidden="true" tabindex="-1"></a>} <span class="op">=</span> {}) {</span>
<span id="cb10-913"><a href="#cb10-913" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Compute values.</span></span>
<span id="cb10-914"><a href="#cb10-914" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> X <span class="op">=</span> d3<span class="op">.</span><span class="fu">map</span>(data<span class="op">,</span> x)<span class="op">;</span></span>
<span id="cb10-915"><a href="#cb10-915" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> Y <span class="op">=</span> d3<span class="op">.</span><span class="fu">map</span>(data<span class="op">,</span> y)<span class="op">;</span></span>
<span id="cb10-916"><a href="#cb10-916" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> C <span class="op">=</span> d3<span class="op">.</span><span class="fu">map</span>(data<span class="op">,</span> c)<span class="op">;</span></span>
<span id="cb10-917"><a href="#cb10-917" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> T <span class="op">=</span> title <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> d3<span class="op">.</span><span class="fu">map</span>(data<span class="op">,</span> title)<span class="op">;</span></span>
<span id="cb10-918"><a href="#cb10-918" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> I <span class="op">=</span> d3<span class="op">.</span><span class="fu">range</span>(X<span class="op">.</span><span class="at">length</span>)<span class="op">.</span><span class="fu">filter</span>(i <span class="kw">=&gt;</span> <span class="op">!</span><span class="pp">isNaN</span>(X[i]) <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="pp">isNaN</span>(Y[i]))<span class="op">;</span></span>
<span id="cb10-919"><a href="#cb10-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-920"><a href="#cb10-920" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Compute default domains.</span></span>
<span id="cb10-921"><a href="#cb10-921" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (xDomain <span class="op">===</span> <span class="kw">undefined</span>) xDomain <span class="op">=</span> d3<span class="op">.</span><span class="fu">extent</span>(X)<span class="op">;</span></span>
<span id="cb10-922"><a href="#cb10-922" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (yDomain <span class="op">===</span> <span class="kw">undefined</span>) yDomain <span class="op">=</span> d3<span class="op">.</span><span class="fu">extent</span>(Y)<span class="op">;</span></span>
<span id="cb10-923"><a href="#cb10-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-924"><a href="#cb10-924" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Construct scales and axes.</span></span>
<span id="cb10-925"><a href="#cb10-925" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xScale <span class="op">=</span> <span class="fu">xType</span>(xDomain<span class="op">,</span> xRange)<span class="op">;</span></span>
<span id="cb10-926"><a href="#cb10-926" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yScale <span class="op">=</span> <span class="fu">yType</span>(yDomain<span class="op">,</span> yRange)<span class="op">;</span></span>
<span id="cb10-927"><a href="#cb10-927" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> cScale <span class="op">=</span> <span class="fu">cType</span>(cRange)<span class="op">;</span></span>
<span id="cb10-928"><a href="#cb10-928" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xAxis <span class="op">=</span> d3<span class="op">.</span><span class="fu">axisBottom</span>(xScale)<span class="op">.</span><span class="fu">ticks</span>(width <span class="op">/</span> <span class="dv">80</span><span class="op">,</span> xFormat)<span class="op">;</span></span>
<span id="cb10-929"><a href="#cb10-929" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yAxis <span class="op">=</span> d3<span class="op">.</span><span class="fu">axisLeft</span>(yScale)<span class="op">.</span><span class="fu">ticks</span>(height <span class="op">/</span> <span class="dv">50</span><span class="op">,</span> yFormat)<span class="op">;</span></span>
<span id="cb10-930"><a href="#cb10-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-931"><a href="#cb10-931" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb10-932"><a href="#cb10-932" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> width)</span>
<span id="cb10-933"><a href="#cb10-933" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> height)</span>
<span id="cb10-934"><a href="#cb10-934" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width<span class="op">,</span> height])</span>
<span id="cb10-935"><a href="#cb10-935" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"style"</span><span class="op">,</span> <span class="st">"max-width: 100%; height: auto; height: intrinsic;"</span>)<span class="op">;</span></span>
<span id="cb10-936"><a href="#cb10-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-937"><a href="#cb10-937" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb10-938"><a href="#cb10-938" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(0,</span><span class="sc">${</span>height <span class="op">-</span> marginBottom<span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb10-939"><a href="#cb10-939" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>(xAxis)</span>
<span id="cb10-940"><a href="#cb10-940" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>(g <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">select</span>(<span class="st">".domain"</span>)<span class="op">.</span><span class="fu">remove</span>())</span>
<span id="cb10-941"><a href="#cb10-941" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>(g <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick line"</span>)<span class="op">.</span><span class="fu">clone</span>()</span>
<span id="cb10-942"><a href="#cb10-942" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> marginTop <span class="op">+</span> marginBottom <span class="op">-</span> height)</span>
<span id="cb10-943"><a href="#cb10-943" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-opacity"</span><span class="op">,</span> <span class="fl">0.1</span>))</span>
<span id="cb10-944"><a href="#cb10-944" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>(g <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb10-945"><a href="#cb10-945" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> width)</span>
<span id="cb10-946"><a href="#cb10-946" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> marginBottom <span class="op">-</span> <span class="dv">4</span>)</span>
<span id="cb10-947"><a href="#cb10-947" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"currentColor"</span>)</span>
<span id="cb10-948"><a href="#cb10-948" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"end"</span>)</span>
<span id="cb10-949"><a href="#cb10-949" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">text</span>(xLabel))<span class="op">;</span></span>
<span id="cb10-950"><a href="#cb10-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-951"><a href="#cb10-951" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb10-952"><a href="#cb10-952" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>marginLeft<span class="sc">}</span><span class="vs">,0)`</span>)</span>
<span id="cb10-953"><a href="#cb10-953" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>(yAxis)</span>
<span id="cb10-954"><a href="#cb10-954" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>(g <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">select</span>(<span class="st">".domain"</span>)<span class="op">.</span><span class="fu">remove</span>())</span>
<span id="cb10-955"><a href="#cb10-955" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>(g <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick line"</span>)<span class="op">.</span><span class="fu">clone</span>()</span>
<span id="cb10-956"><a href="#cb10-956" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> width <span class="op">-</span> marginLeft <span class="op">-</span> marginRight)</span>
<span id="cb10-957"><a href="#cb10-957" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-opacity"</span><span class="op">,</span> <span class="fl">0.1</span>))</span>
<span id="cb10-958"><a href="#cb10-958" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>(g <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb10-959"><a href="#cb10-959" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="op">-</span>marginLeft)</span>
<span id="cb10-960"><a href="#cb10-960" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="dv">10</span>)</span>
<span id="cb10-961"><a href="#cb10-961" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"currentColor"</span>)</span>
<span id="cb10-962"><a href="#cb10-962" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"start"</span>)</span>
<span id="cb10-963"><a href="#cb10-963" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">text</span>(yLabel))<span class="op">;</span></span>
<span id="cb10-964"><a href="#cb10-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-965"><a href="#cb10-965" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (T) svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb10-966"><a href="#cb10-966" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"sans-serif"</span>)</span>
<span id="cb10-967"><a href="#cb10-967" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">10</span>)</span>
<span id="cb10-968"><a href="#cb10-968" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-linejoin"</span><span class="op">,</span> <span class="st">"round"</span>)</span>
<span id="cb10-969"><a href="#cb10-969" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-linecap"</span><span class="op">,</span> <span class="st">"round"</span>)</span>
<span id="cb10-970"><a href="#cb10-970" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"text"</span>)</span>
<span id="cb10-971"><a href="#cb10-971" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(I)</span>
<span id="cb10-972"><a href="#cb10-972" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">"text"</span>)</span>
<span id="cb10-973"><a href="#cb10-973" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dx"</span><span class="op">,</span> <span class="dv">7</span>)</span>
<span id="cb10-974"><a href="#cb10-974" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="st">"0.35em"</span>)</span>
<span id="cb10-975"><a href="#cb10-975" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> i <span class="kw">=&gt;</span> <span class="fu">xScale</span>(X[i]))</span>
<span id="cb10-976"><a href="#cb10-976" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> i <span class="kw">=&gt;</span> <span class="fu">yScale</span>(Y[i]))</span>
<span id="cb10-977"><a href="#cb10-977" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(i <span class="kw">=&gt;</span> T[i])</span>
<span id="cb10-978"><a href="#cb10-978" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>(text <span class="kw">=&gt;</span> text<span class="op">.</span><span class="fu">clone</span>(<span class="kw">true</span>))</span>
<span id="cb10-979"><a href="#cb10-979" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb10-980"><a href="#cb10-980" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> halo)</span>
<span id="cb10-981"><a href="#cb10-981" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> haloWidth)<span class="op">;</span></span>
<span id="cb10-982"><a href="#cb10-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-983"><a href="#cb10-983" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb10-984"><a href="#cb10-984" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> fill)</span>
<span id="cb10-985"><a href="#cb10-985" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> stroke)</span>
<span id="cb10-986"><a href="#cb10-986" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> strokeWidth)</span>
<span id="cb10-987"><a href="#cb10-987" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"circle"</span>)</span>
<span id="cb10-988"><a href="#cb10-988" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(I)</span>
<span id="cb10-989"><a href="#cb10-989" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">"circle"</span>)</span>
<span id="cb10-990"><a href="#cb10-990" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> i <span class="kw">=&gt;</span> <span class="fu">xScale</span>(X[i]) <span class="op">+</span> <span class="fu">jitter</span>())</span>
<span id="cb10-991"><a href="#cb10-991" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> i <span class="kw">=&gt;</span> <span class="fu">yScale</span>(Y[i]) <span class="op">+</span> <span class="fu">jitter</span>())</span>
<span id="cb10-992"><a href="#cb10-992" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> i <span class="kw">=&gt;</span> <span class="fu">cScale</span>(C[i]))</span>
<span id="cb10-993"><a href="#cb10-993" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> r)<span class="op">;</span></span>
<span id="cb10-994"><a href="#cb10-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-995"><a href="#cb10-995" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb10-996"><a href="#cb10-996" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb11" data-startfrom="1001" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1000;"><span id="cb11-1001"><a href="#cb11-1001" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">binCategorical</span>(data<span class="op">,</span> accessor) {</span>
<span id="cb11-1002"><a href="#cb11-1002" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> bins <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb11-1003"><a href="#cb11-1003" aria-hidden="true" tabindex="-1"></a>  data<span class="op">.</span><span class="fu">forEach</span>(v <span class="kw">=&gt;</span> {</span>
<span id="cb11-1004"><a href="#cb11-1004" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> elem <span class="op">=</span> bins<span class="op">.</span><span class="fu">findIndex</span>(bin <span class="kw">=&gt;</span> bin<span class="op">.</span><span class="at">v</span> <span class="op">===</span> <span class="fu">accessor</span>(v))<span class="op">;</span></span>
<span id="cb11-1005"><a href="#cb11-1005" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (elem <span class="op">===</span> <span class="op">-</span><span class="dv">1</span>) {</span>
<span id="cb11-1006"><a href="#cb11-1006" aria-hidden="true" tabindex="-1"></a>      bins<span class="op">.</span><span class="fu">push</span>([])<span class="op">;</span></span>
<span id="cb11-1007"><a href="#cb11-1007" aria-hidden="true" tabindex="-1"></a>      elem <span class="op">=</span> bins<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb11-1008"><a href="#cb11-1008" aria-hidden="true" tabindex="-1"></a>      bins[elem]<span class="op">.</span><span class="at">v</span> <span class="op">=</span> <span class="fu">accessor</span>(v)<span class="op">;</span></span>
<span id="cb11-1009"><a href="#cb11-1009" aria-hidden="true" tabindex="-1"></a>      bins[elem]<span class="op">.</span><span class="at">x0</span> <span class="op">=</span> <span class="fu">accessor</span>(v)<span class="op">;</span></span>
<span id="cb11-1010"><a href="#cb11-1010" aria-hidden="true" tabindex="-1"></a>      bins[elem]<span class="op">.</span><span class="at">x1</span> <span class="op">=</span> <span class="fu">accessor</span>(v)<span class="op">;</span></span>
<span id="cb11-1011"><a href="#cb11-1011" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-1012"><a href="#cb11-1012" aria-hidden="true" tabindex="-1"></a>    bins[elem]<span class="op">.</span><span class="fu">push</span>(v)<span class="op">;</span></span>
<span id="cb11-1013"><a href="#cb11-1013" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb11-1014"><a href="#cb11-1014" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> bins<span class="op">;</span></span>
<span id="cb11-1015"><a href="#cb11-1015" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-1016"><a href="#cb11-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1017"><a href="#cb11-1017" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">findIntersections</span>(xBins<span class="op">,</span> yBins) {</span>
<span id="cb11-1018"><a href="#cb11-1018" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> plotBins <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb11-1019"><a href="#cb11-1019" aria-hidden="true" tabindex="-1"></a>  xBins<span class="op">.</span><span class="fu">forEach</span>(xBin <span class="kw">=&gt;</span> {</span>
<span id="cb11-1020"><a href="#cb11-1020" aria-hidden="true" tabindex="-1"></a>    yBins<span class="op">.</span><span class="fu">forEach</span>(yBin <span class="kw">=&gt;</span> {</span>
<span id="cb11-1021"><a href="#cb11-1021" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-1022"><a href="#cb11-1022" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Add this plot bin</span></span>
<span id="cb11-1023"><a href="#cb11-1023" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> last <span class="op">=</span> plotBins<span class="op">.</span><span class="fu">push</span>([])<span class="op">;</span></span>
<span id="cb11-1024"><a href="#cb11-1024" aria-hidden="true" tabindex="-1"></a>      plotBins[last <span class="op">-</span> <span class="dv">1</span>]<span class="op">.</span><span class="at">x0</span> <span class="op">=</span> xBin<span class="op">.</span><span class="at">x0</span><span class="op">;</span></span>
<span id="cb11-1025"><a href="#cb11-1025" aria-hidden="true" tabindex="-1"></a>      plotBins[last <span class="op">-</span> <span class="dv">1</span>]<span class="op">.</span><span class="at">x1</span> <span class="op">=</span> xBin<span class="op">.</span><span class="at">x1</span><span class="op">;</span></span>
<span id="cb11-1026"><a href="#cb11-1026" aria-hidden="true" tabindex="-1"></a>      plotBins[last <span class="op">-</span> <span class="dv">1</span>]<span class="op">.</span><span class="at">y0</span> <span class="op">=</span> yBin<span class="op">.</span><span class="at">x0</span><span class="op">;</span></span>
<span id="cb11-1027"><a href="#cb11-1027" aria-hidden="true" tabindex="-1"></a>      plotBins[last <span class="op">-</span> <span class="dv">1</span>]<span class="op">.</span><span class="at">y1</span> <span class="op">=</span> yBin<span class="op">.</span><span class="at">x1</span></span>
<span id="cb11-1028"><a href="#cb11-1028" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-1029"><a href="#cb11-1029" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Add the intersected elements</span></span>
<span id="cb11-1030"><a href="#cb11-1030" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> intersection <span class="op">=</span> xBin<span class="op">.</span><span class="fu">filter</span>(value <span class="kw">=&gt;</span> yBin<span class="op">.</span><span class="fu">includes</span>(value))<span class="op">;</span></span>
<span id="cb11-1031"><a href="#cb11-1031" aria-hidden="true" tabindex="-1"></a>      plotBins[last <span class="op">-</span> <span class="dv">1</span>]<span class="op">.</span><span class="fu">push</span>(<span class="op">...</span>intersection)<span class="op">;</span></span>
<span id="cb11-1032"><a href="#cb11-1032" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb11-1033"><a href="#cb11-1033" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-1034"><a href="#cb11-1034" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb11-1035"><a href="#cb11-1035" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> plotBins<span class="op">;</span></span>
<span id="cb11-1036"><a href="#cb11-1036" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-1037"><a href="#cb11-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1038"><a href="#cb11-1038" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">gatherColor</span>(data) {</span>
<span id="cb11-1039"><a href="#cb11-1039" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> cDomain <span class="op">=</span> <span class="kw">new</span> <span class="bu">Set</span>(data)<span class="op">;</span></span>
<span id="cb11-1040"><a href="#cb11-1040" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (cDomain<span class="op">.</span><span class="at">size</span> <span class="op">&gt;</span> <span class="dv">10</span> <span class="op">&amp;&amp;</span> <span class="bu">Number</span><span class="op">.</span><span class="fu">isFinite</span>(data[<span class="dv">0</span>])) {</span>
<span id="cb11-1041"><a href="#cb11-1041" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> d3<span class="op">.</span><span class="fu">scaleSequential</span>()</span>
<span id="cb11-1042"><a href="#cb11-1042" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">interpolator</span>(d3<span class="op">.</span><span class="at">interpolateYlGnBu</span>)    </span>
<span id="cb11-1043"><a href="#cb11-1043" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">domain</span>(d3<span class="op">.</span><span class="fu">extent</span>(data))<span class="op">;</span></span>
<span id="cb11-1044"><a href="#cb11-1044" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-1045"><a href="#cb11-1045" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb11-1046"><a href="#cb11-1046" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> d3<span class="op">.</span><span class="fu">scaleOrdinal</span>(d3<span class="op">.</span><span class="at">schemeCategory10</span>)</span>
<span id="cb11-1047"><a href="#cb11-1047" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-1048"><a href="#cb11-1048" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-1049"><a href="#cb11-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1050"><a href="#cb11-1050" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">gather2D</span>(data<span class="op">,</span> {</span>
<span id="cb11-1051"><a href="#cb11-1051" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> ([x]) <span class="kw">=&gt;</span> x<span class="op">,</span> <span class="co">// given d in data, returns the (quantitative) x-value</span></span>
<span id="cb11-1052"><a href="#cb11-1052" aria-hidden="true" tabindex="-1"></a>  y <span class="op">=</span> ([<span class="op">,</span> y]) <span class="kw">=&gt;</span> y<span class="op">,</span> <span class="co">// given d in data, returns the (quantitative) y-value</span></span>
<span id="cb11-1053"><a href="#cb11-1053" aria-hidden="true" tabindex="-1"></a>} <span class="op">=</span> {}) {</span>
<span id="cb11-1054"><a href="#cb11-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1055"><a href="#cb11-1055" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Extract the values</span></span>
<span id="cb11-1056"><a href="#cb11-1056" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> values <span class="op">=</span> iterable <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="bu">Set</span>(iterable)<span class="op">;</span></span>
<span id="cb11-1057"><a href="#cb11-1057" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> xDomain <span class="op">=</span> <span class="fu">values</span>(d3<span class="op">.</span><span class="fu">map</span>(data<span class="op">,</span> x))<span class="op">;</span></span>
<span id="cb11-1058"><a href="#cb11-1058" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> yDomain <span class="op">=</span> <span class="fu">values</span>(d3<span class="op">.</span><span class="fu">map</span>(data<span class="op">,</span> y))<span class="op">;</span></span>
<span id="cb11-1059"><a href="#cb11-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1060"><a href="#cb11-1060" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Bin the axes: numerical or categorical</span></span>
<span id="cb11-1061"><a href="#cb11-1061" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> xBins<span class="op">,</span> yBins<span class="op">;</span></span>
<span id="cb11-1062"><a href="#cb11-1062" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (xDomain<span class="op">.</span><span class="at">size</span> <span class="op">&gt;</span> <span class="dv">10</span>) { </span>
<span id="cb11-1063"><a href="#cb11-1063" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> bin <span class="op">=</span> d3<span class="op">.</span><span class="fu">bin</span>()<span class="op">.</span><span class="fu">value</span>(x)<span class="op">;</span></span>
<span id="cb11-1064"><a href="#cb11-1064" aria-hidden="true" tabindex="-1"></a>    xBins <span class="op">=</span> <span class="fu">bin</span>(data)<span class="op">;</span></span>
<span id="cb11-1065"><a href="#cb11-1065" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-1066"><a href="#cb11-1066" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb11-1067"><a href="#cb11-1067" aria-hidden="true" tabindex="-1"></a>    xBins <span class="op">=</span> <span class="fu">binCategorical</span>(data<span class="op">,</span> x)<span class="op">;</span>    </span>
<span id="cb11-1068"><a href="#cb11-1068" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-1069"><a href="#cb11-1069" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (yDomain<span class="op">.</span><span class="at">size</span> <span class="op">&gt;</span> <span class="dv">10</span>) { </span>
<span id="cb11-1070"><a href="#cb11-1070" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> bin <span class="op">=</span> d3<span class="op">.</span><span class="fu">bin</span>()<span class="op">.</span><span class="fu">value</span>(y)<span class="op">;</span></span>
<span id="cb11-1071"><a href="#cb11-1071" aria-hidden="true" tabindex="-1"></a>    yBins <span class="op">=</span> <span class="fu">bin</span>(data)<span class="op">;</span></span>
<span id="cb11-1072"><a href="#cb11-1072" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-1073"><a href="#cb11-1073" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb11-1074"><a href="#cb11-1074" aria-hidden="true" tabindex="-1"></a>    yBins <span class="op">=</span> <span class="fu">binCategorical</span>(data<span class="op">,</span> y)<span class="op">;</span>    </span>
<span id="cb11-1075"><a href="#cb11-1075" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-1076"><a href="#cb11-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1077"><a href="#cb11-1077" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Now find the intersections</span></span>
<span id="cb11-1078"><a href="#cb11-1078" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">findIntersections</span>(xBins<span class="op">,</span> yBins)<span class="op">;</span></span>
<span id="cb11-1079"><a href="#cb11-1079" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-1080"><a href="#cb11-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1081"><a href="#cb11-1081" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">GatherPlot</span>(data<span class="op">,</span> {</span>
<span id="cb11-1082"><a href="#cb11-1082" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> ([x]) <span class="kw">=&gt;</span> x<span class="op">,</span> <span class="co">// given d in data, returns the x-value</span></span>
<span id="cb11-1083"><a href="#cb11-1083" aria-hidden="true" tabindex="-1"></a>  y <span class="op">=</span> ([<span class="op">,</span> y]) <span class="kw">=&gt;</span> y<span class="op">,</span> <span class="co">// given d in data, returns the y-value</span></span>
<span id="cb11-1084"><a href="#cb11-1084" aria-hidden="true" tabindex="-1"></a>  c <span class="op">=</span> ([<span class="op">,</span> <span class="op">,</span> c]) <span class="kw">=&gt;</span> c<span class="op">,</span></span>
<span id="cb11-1085"><a href="#cb11-1085" aria-hidden="true" tabindex="-1"></a>  spacing <span class="op">=</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb11-1086"><a href="#cb11-1086" aria-hidden="true" tabindex="-1"></a>  width <span class="op">=</span> <span class="dv">640</span><span class="op">,</span> <span class="co">// outer width, in pixels</span></span>
<span id="cb11-1087"><a href="#cb11-1087" aria-hidden="true" tabindex="-1"></a>  height <span class="op">=</span> <span class="dv">400</span><span class="op">,</span> <span class="co">// outer height, in pixels</span></span>
<span id="cb11-1088"><a href="#cb11-1088" aria-hidden="true" tabindex="-1"></a>  marginTop <span class="op">=</span> <span class="dv">30</span><span class="op">,</span> <span class="co">// top margin, in pixels</span></span>
<span id="cb11-1089"><a href="#cb11-1089" aria-hidden="true" tabindex="-1"></a>  marginRight <span class="op">=</span> <span class="dv">30</span><span class="op">,</span> <span class="co">// right margin, in pixels</span></span>
<span id="cb11-1090"><a href="#cb11-1090" aria-hidden="true" tabindex="-1"></a>  marginBottom <span class="op">=</span> <span class="dv">30</span><span class="op">,</span> <span class="co">// bottom margin, in pixels</span></span>
<span id="cb11-1091"><a href="#cb11-1091" aria-hidden="true" tabindex="-1"></a>  marginLeft <span class="op">=</span> <span class="dv">30</span><span class="op">,</span> <span class="co">// left margin, in pixels</span></span>
<span id="cb11-1092"><a href="#cb11-1092" aria-hidden="true" tabindex="-1"></a>  chartWidth <span class="op">=</span> width <span class="op">-</span> marginLeft <span class="op">-</span> marginRight<span class="op">,</span></span>
<span id="cb11-1093"><a href="#cb11-1093" aria-hidden="true" tabindex="-1"></a>  chartHeight <span class="op">=</span> height <span class="op">-</span> marginTop <span class="op">-</span> marginBottom<span class="op">,</span></span>
<span id="cb11-1094"><a href="#cb11-1094" aria-hidden="true" tabindex="-1"></a>  stroke <span class="op">=</span> <span class="st">'none'</span><span class="op">,</span></span>
<span id="cb11-1095"><a href="#cb11-1095" aria-hidden="true" tabindex="-1"></a>  xSort <span class="op">=</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb11-1096"><a href="#cb11-1096" aria-hidden="true" tabindex="-1"></a>  ySort <span class="op">=</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb11-1097"><a href="#cb11-1097" aria-hidden="true" tabindex="-1"></a>  cSort <span class="op">=</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb11-1098"><a href="#cb11-1098" aria-hidden="true" tabindex="-1"></a>} <span class="op">=</span> {}) {</span>
<span id="cb11-1099"><a href="#cb11-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1100"><a href="#cb11-1100" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Find the intersection</span></span>
<span id="cb11-1101"><a href="#cb11-1101" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> gatherBins <span class="op">=</span> <span class="fu">gather2D</span>(data<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> x<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> y})<span class="op">;</span></span>
<span id="cb11-1102"><a href="#cb11-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1103"><a href="#cb11-1103" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Sort by the largest bin</span></span>
<span id="cb11-1104"><a href="#cb11-1104" aria-hidden="true" tabindex="-1"></a>  gatherBins <span class="op">=</span> gatherBins<span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> b<span class="op">.</span><span class="at">length</span> <span class="op">-</span> a<span class="op">.</span><span class="at">length</span>)<span class="op">;</span></span>
<span id="cb11-1105"><a href="#cb11-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1106"><a href="#cb11-1106" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Starting with the largest, add the bins one by one to the plot</span></span>
<span id="cb11-1107"><a href="#cb11-1107" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> aspect <span class="op">=</span> chartWidth <span class="op">/</span> chartHeight<span class="op">;</span></span>
<span id="cb11-1108"><a href="#cb11-1108" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> cols <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb11-1109"><a href="#cb11-1109" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> rows <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb11-1110"><a href="#cb11-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1111"><a href="#cb11-1111" aria-hidden="true" tabindex="-1"></a>  gatherBins<span class="op">.</span><span class="fu">forEach</span>(v <span class="kw">=&gt;</span> {  </span>
<span id="cb11-1112"><a href="#cb11-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1113"><a href="#cb11-1113" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> xDim<span class="op">,</span> yDim<span class="op">;</span></span>
<span id="cb11-1114"><a href="#cb11-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1115"><a href="#cb11-1115" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Look up the rows and columns</span></span>
<span id="cb11-1116"><a href="#cb11-1116" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> ndx <span class="op">=</span> cols<span class="op">.</span><span class="fu">findIndex</span>(c <span class="kw">=&gt;</span> c<span class="op">.</span><span class="at">x0</span> <span class="op">===</span> v<span class="op">.</span><span class="at">x0</span>)<span class="op">;</span></span>
<span id="cb11-1117"><a href="#cb11-1117" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> ndy <span class="op">=</span> rows<span class="op">.</span><span class="fu">findIndex</span>(r <span class="kw">=&gt;</span> r<span class="op">.</span><span class="at">y0</span> <span class="op">===</span> v<span class="op">.</span><span class="at">y0</span>)<span class="op">;</span></span>
<span id="cb11-1118"><a href="#cb11-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1119"><a href="#cb11-1119" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Case 0: first cell placed</span></span>
<span id="cb11-1120"><a href="#cb11-1120" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (cols<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> rows<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">0</span>) {</span>
<span id="cb11-1121"><a href="#cb11-1121" aria-hidden="true" tabindex="-1"></a>      xDim <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(aspect <span class="op">*</span> data<span class="op">.</span><span class="at">length</span>))<span class="op">;</span></span>
<span id="cb11-1122"><a href="#cb11-1122" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (xDim <span class="op">&gt;</span> v<span class="op">.</span><span class="at">length</span>) xDim <span class="op">=</span> v<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb11-1123"><a href="#cb11-1123" aria-hidden="true" tabindex="-1"></a>      yDim <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span>(v<span class="op">.</span><span class="at">length</span> <span class="op">/</span> xDim)<span class="op">;</span></span>
<span id="cb11-1124"><a href="#cb11-1124" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-1125"><a href="#cb11-1125" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Case 1: no column or row given</span></span>
<span id="cb11-1126"><a href="#cb11-1126" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (ndx <span class="op">===</span> <span class="op">-</span><span class="dv">1</span> <span class="op">&amp;&amp;</span> ndy <span class="op">===</span> <span class="op">-</span><span class="dv">1</span>) {</span>
<span id="cb11-1127"><a href="#cb11-1127" aria-hidden="true" tabindex="-1"></a>      xDim <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(aspect <span class="op">*</span> v<span class="op">.</span><span class="at">length</span>))<span class="op">;</span></span>
<span id="cb11-1128"><a href="#cb11-1128" aria-hidden="true" tabindex="-1"></a>      yDim <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span>(v<span class="op">.</span><span class="at">length</span> <span class="op">/</span> xDim)<span class="op">;</span></span>
<span id="cb11-1129"><a href="#cb11-1129" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-1130"><a href="#cb11-1130" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Case 2: no column given</span></span>
<span id="cb11-1131"><a href="#cb11-1131" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (ndx <span class="op">===</span> <span class="op">-</span><span class="dv">1</span>) {</span>
<span id="cb11-1132"><a href="#cb11-1132" aria-hidden="true" tabindex="-1"></a>      yDim <span class="op">=</span> rows[ndy]<span class="op">.</span><span class="at">yDim</span><span class="op">;</span></span>
<span id="cb11-1133"><a href="#cb11-1133" aria-hidden="true" tabindex="-1"></a>      xDim <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span>(v<span class="op">.</span><span class="at">length</span> <span class="op">/</span> yDim)<span class="op">;</span></span>
<span id="cb11-1134"><a href="#cb11-1134" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-1135"><a href="#cb11-1135" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Case 3: no row given</span></span>
<span id="cb11-1136"><a href="#cb11-1136" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (ndy <span class="op">===</span> <span class="op">-</span><span class="dv">1</span>) {</span>
<span id="cb11-1137"><a href="#cb11-1137" aria-hidden="true" tabindex="-1"></a>      xDim <span class="op">=</span> cols[ndx]<span class="op">.</span><span class="at">xDim</span><span class="op">;</span></span>
<span id="cb11-1138"><a href="#cb11-1138" aria-hidden="true" tabindex="-1"></a>      yDim <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span>(v<span class="op">.</span><span class="at">length</span> <span class="op">/</span> xDim)<span class="op">;</span></span>
<span id="cb11-1139"><a href="#cb11-1139" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-1140"><a href="#cb11-1140" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Case 4: both column and row given</span></span>
<span id="cb11-1141"><a href="#cb11-1141" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb11-1142"><a href="#cb11-1142" aria-hidden="true" tabindex="-1"></a>      xDim <span class="op">=</span> cols[ndx]<span class="op">.</span><span class="at">xDim</span><span class="op">;</span></span>
<span id="cb11-1143"><a href="#cb11-1143" aria-hidden="true" tabindex="-1"></a>      yDim <span class="op">=</span> rows[ndy]<span class="op">.</span><span class="at">yDim</span><span class="op">;</span></span>
<span id="cb11-1144"><a href="#cb11-1144" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (xDim <span class="op">*</span> yDim <span class="op">&lt;</span> v<span class="op">.</span><span class="at">length</span>) {</span>
<span id="cb11-1145"><a href="#cb11-1145" aria-hidden="true" tabindex="-1"></a>        yDim <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span>(v<span class="op">.</span><span class="at">length</span> <span class="op">/</span> xDim)<span class="op">;</span></span>
<span id="cb11-1146"><a href="#cb11-1146" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb11-1147"><a href="#cb11-1147" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-1148"><a href="#cb11-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1149"><a href="#cb11-1149" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Now add the missing columns and rows</span></span>
<span id="cb11-1150"><a href="#cb11-1150" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (ndx <span class="op">===</span> <span class="op">-</span><span class="dv">1</span>) cols<span class="op">.</span><span class="fu">push</span>({ <span class="dt">x0</span><span class="op">:</span> v<span class="op">.</span><span class="at">x0</span><span class="op">,</span> <span class="dt">x1</span><span class="op">:</span> v<span class="op">.</span><span class="at">x1</span><span class="op">,</span> <span class="dt">xDim</span><span class="op">:</span> xDim })<span class="op">;</span></span>
<span id="cb11-1151"><a href="#cb11-1151" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (ndy <span class="op">===</span> <span class="op">-</span><span class="dv">1</span>) rows<span class="op">.</span><span class="fu">push</span>({ <span class="dt">y0</span><span class="op">:</span> v<span class="op">.</span><span class="at">y0</span><span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> v<span class="op">.</span><span class="at">y1</span><span class="op">,</span> <span class="dt">yDim</span><span class="op">:</span> yDim })<span class="op">;</span></span>
<span id="cb11-1152"><a href="#cb11-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1153"><a href="#cb11-1153" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Store the dimensions</span></span>
<span id="cb11-1154"><a href="#cb11-1154" aria-hidden="true" tabindex="-1"></a>    v<span class="op">.</span><span class="at">xDim</span> <span class="op">=</span> xDim<span class="op">;</span></span>
<span id="cb11-1155"><a href="#cb11-1155" aria-hidden="true" tabindex="-1"></a>    v<span class="op">.</span><span class="at">yDim</span> <span class="op">=</span> yDim<span class="op">;</span></span>
<span id="cb11-1156"><a href="#cb11-1156" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb11-1157"><a href="#cb11-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1158"><a href="#cb11-1158" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> cmp <span class="op">=</span> (a<span class="op">,</span> b) <span class="kw">=&gt;</span> {</span>
<span id="cb11-1159"><a href="#cb11-1159" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (a <span class="op">&lt;</span> b) <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb11-1160"><a href="#cb11-1160" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (a <span class="op">&gt;</span> b) <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb11-1161"><a href="#cb11-1161" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb11-1162"><a href="#cb11-1162" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb11-1163"><a href="#cb11-1163" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-1164"><a href="#cb11-1164" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Sort the plots</span></span>
<span id="cb11-1165"><a href="#cb11-1165" aria-hidden="true" tabindex="-1"></a>  gatherBins<span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> {</span>
<span id="cb11-1166"><a href="#cb11-1166" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> xRes <span class="op">=</span>  xSort <span class="op">*</span> <span class="fu">cmp</span>(a<span class="op">.</span><span class="at">x0</span><span class="op">,</span> b<span class="op">.</span><span class="at">x0</span>)<span class="op">;</span></span>
<span id="cb11-1167"><a href="#cb11-1167" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> yRes <span class="op">=</span> <span class="op">-</span>ySort <span class="op">*</span> <span class="fu">cmp</span>(a<span class="op">.</span><span class="at">y0</span><span class="op">,</span> b<span class="op">.</span><span class="at">y0</span>)<span class="op">;</span></span>
<span id="cb11-1168"><a href="#cb11-1168" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (xRes <span class="op">!==</span> <span class="dv">0</span>) <span class="cf">return</span> xRes<span class="op">;</span></span>
<span id="cb11-1169"><a href="#cb11-1169" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> yRes<span class="op">;</span></span>
<span id="cb11-1170"><a href="#cb11-1170" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb11-1171"><a href="#cb11-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1172"><a href="#cb11-1172" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Now figure out the maximum width and height </span></span>
<span id="cb11-1173"><a href="#cb11-1173" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> itemCols <span class="op">=</span> cols<span class="op">.</span><span class="fu">reduce</span>((acc<span class="op">,</span> col) <span class="kw">=&gt;</span> acc <span class="op">+</span> col<span class="op">.</span><span class="at">xDim</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb11-1174"><a href="#cb11-1174" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> itemRows <span class="op">=</span> rows<span class="op">.</span><span class="fu">reduce</span>((acc<span class="op">,</span> row) <span class="kw">=&gt;</span> acc <span class="op">+</span> row<span class="op">.</span><span class="at">yDim</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb11-1175"><a href="#cb11-1175" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> itemWidth <span class="op">=</span> (chartWidth <span class="op">-</span> spacing <span class="op">*</span> (cols<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span>)) <span class="op">/</span> itemCols<span class="op">;</span></span>
<span id="cb11-1176"><a href="#cb11-1176" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> itemHeight <span class="op">=</span> (chartHeight <span class="op">-</span> spacing <span class="op">*</span> (rows<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span>)) <span class="op">/</span> itemRows<span class="op">;</span></span>
<span id="cb11-1177"><a href="#cb11-1177" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> itemSize <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(itemWidth<span class="op">,</span> itemHeight)<span class="op">;</span></span>
<span id="cb11-1178"><a href="#cb11-1178" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> xPadding <span class="op">=</span> (chartWidth <span class="op">-</span> itemSize <span class="op">*</span> itemCols) <span class="op">/</span> cols<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb11-1179"><a href="#cb11-1179" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> yPadding <span class="op">=</span> (chartHeight <span class="op">-</span> itemSize <span class="op">*</span> itemRows) <span class="op">/</span> rows<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb11-1180"><a href="#cb11-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1181"><a href="#cb11-1181" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Now do the cell layout</span></span>
<span id="cb11-1182"><a href="#cb11-1182" aria-hidden="true" tabindex="-1"></a>  cols<span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span>  xSort <span class="op">*</span> <span class="fu">cmp</span>(a<span class="op">.</span><span class="at">x0</span><span class="op">,</span> b<span class="op">.</span><span class="at">x0</span>))<span class="op">;</span></span>
<span id="cb11-1183"><a href="#cb11-1183" aria-hidden="true" tabindex="-1"></a>  rows<span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> <span class="op">-</span>ySort <span class="op">*</span> <span class="fu">cmp</span>(a<span class="op">.</span><span class="at">y0</span><span class="op">,</span> b<span class="op">.</span><span class="at">y0</span>))<span class="op">;</span></span>
<span id="cb11-1184"><a href="#cb11-1184" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-1185"><a href="#cb11-1185" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> posx <span class="op">=</span> xPadding <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb11-1186"><a href="#cb11-1186" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> px <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> px <span class="op">&lt;</span> cols<span class="op">.</span><span class="at">length</span><span class="op">;</span> px<span class="op">++</span>) {</span>
<span id="cb11-1187"><a href="#cb11-1187" aria-hidden="true" tabindex="-1"></a>    cols[px]<span class="op">.</span><span class="at">x</span> <span class="op">=</span> posx<span class="op">;</span></span>
<span id="cb11-1188"><a href="#cb11-1188" aria-hidden="true" tabindex="-1"></a>    cols[px]<span class="op">.</span><span class="at">width</span> <span class="op">=</span> cols[px]<span class="op">.</span><span class="at">xDim</span> <span class="op">*</span> itemSize<span class="op">;</span></span>
<span id="cb11-1189"><a href="#cb11-1189" aria-hidden="true" tabindex="-1"></a>    posx <span class="op">+=</span> cols[px]<span class="op">.</span><span class="at">width</span> <span class="op">+</span> xPadding<span class="op">;</span></span>
<span id="cb11-1190"><a href="#cb11-1190" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-1191"><a href="#cb11-1191" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> posy <span class="op">=</span> yPadding <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb11-1192"><a href="#cb11-1192" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> py <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> py <span class="op">&lt;</span> rows<span class="op">.</span><span class="at">length</span><span class="op">;</span> py<span class="op">++</span>) {</span>
<span id="cb11-1193"><a href="#cb11-1193" aria-hidden="true" tabindex="-1"></a>    rows[py]<span class="op">.</span><span class="at">y</span> <span class="op">=</span> posy<span class="op">;</span></span>
<span id="cb11-1194"><a href="#cb11-1194" aria-hidden="true" tabindex="-1"></a>    rows[py]<span class="op">.</span><span class="at">height</span> <span class="op">=</span> rows[py]<span class="op">.</span><span class="at">yDim</span> <span class="op">*</span> itemSize<span class="op">;</span></span>
<span id="cb11-1195"><a href="#cb11-1195" aria-hidden="true" tabindex="-1"></a>    posy <span class="op">+=</span> rows[py]<span class="op">.</span><span class="at">height</span> <span class="op">+</span> yPadding<span class="op">;</span></span>
<span id="cb11-1196"><a href="#cb11-1196" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-1197"><a href="#cb11-1197" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-1198"><a href="#cb11-1198" aria-hidden="true" tabindex="-1"></a>  <span class="co">// let posx = xPadding / 2;</span></span>
<span id="cb11-1199"><a href="#cb11-1199" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> px <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> px <span class="op">&lt;</span> cols<span class="op">.</span><span class="at">length</span><span class="op">;</span> px<span class="op">++</span>) {</span>
<span id="cb11-1200"><a href="#cb11-1200" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">let</span> py <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> py <span class="op">&lt;</span> rows<span class="op">.</span><span class="at">length</span><span class="op">;</span> py<span class="op">++</span>) {</span>
<span id="cb11-1201"><a href="#cb11-1201" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> offset <span class="op">=</span> px <span class="op">*</span> rows<span class="op">.</span><span class="at">length</span> <span class="op">+</span> py<span class="op">;</span></span>
<span id="cb11-1202"><a href="#cb11-1202" aria-hidden="true" tabindex="-1"></a>      gatherBins[offset]<span class="op">.</span><span class="at">x</span> <span class="op">=</span> cols[px]<span class="op">.</span><span class="at">x</span><span class="op">;</span></span>
<span id="cb11-1203"><a href="#cb11-1203" aria-hidden="true" tabindex="-1"></a>      gatherBins[offset]<span class="op">.</span><span class="at">y</span> <span class="op">=</span> rows[py]<span class="op">.</span><span class="at">y</span><span class="op">;</span></span>
<span id="cb11-1204"><a href="#cb11-1204" aria-hidden="true" tabindex="-1"></a>      gatherBins[offset]<span class="op">.</span><span class="at">width</span> <span class="op">=</span> cols[px]<span class="op">.</span><span class="at">width</span><span class="op">;</span></span>
<span id="cb11-1205"><a href="#cb11-1205" aria-hidden="true" tabindex="-1"></a>      gatherBins[offset]<span class="op">.</span><span class="at">height</span> <span class="op">=</span> rows[py]<span class="op">.</span><span class="at">height</span><span class="op">;</span></span>
<span id="cb11-1206"><a href="#cb11-1206" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-1207"><a href="#cb11-1207" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-1208"><a href="#cb11-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1209"><a href="#cb11-1209" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Time to do in-cell layout</span></span>
<span id="cb11-1210"><a href="#cb11-1210" aria-hidden="true" tabindex="-1"></a>  gatherBins<span class="op">.</span><span class="fu">forEach</span>(v <span class="kw">=&gt;</span> {</span>
<span id="cb11-1211"><a href="#cb11-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1212"><a href="#cb11-1212" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Sort the data based on color</span></span>
<span id="cb11-1213"><a href="#cb11-1213" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (cSort) v<span class="op">.</span><span class="fu">sort</span>((d1<span class="op">,</span> d2) <span class="kw">=&gt;</span> cSort <span class="op">*</span> <span class="fu">cmp</span>(<span class="fu">c</span>(d1)<span class="op">,</span> <span class="fu">c</span>(d2)))<span class="op">;</span></span>
<span id="cb11-1214"><a href="#cb11-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1215"><a href="#cb11-1215" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Position tracking</span></span>
<span id="cb11-1216"><a href="#cb11-1216" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> px <span class="op">=</span> itemSize <span class="op">/</span> <span class="fl">2.0</span><span class="op">;</span></span>
<span id="cb11-1217"><a href="#cb11-1217" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> py <span class="op">=</span> v<span class="op">.</span><span class="at">height</span> <span class="op">-</span> itemSize <span class="op">/</span> <span class="fl">2.0</span><span class="op">;</span></span>
<span id="cb11-1218"><a href="#cb11-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1219"><a href="#cb11-1219" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Step through all of the points</span></span>
<span id="cb11-1220"><a href="#cb11-1220" aria-hidden="true" tabindex="-1"></a>    v<span class="op">.</span><span class="fu">forEach</span>(d <span class="kw">=&gt;</span> {</span>
<span id="cb11-1221"><a href="#cb11-1221" aria-hidden="true" tabindex="-1"></a>      d<span class="op">.</span><span class="at">cx</span> <span class="op">=</span> px<span class="op">;</span></span>
<span id="cb11-1222"><a href="#cb11-1222" aria-hidden="true" tabindex="-1"></a>      d<span class="op">.</span><span class="at">cy</span> <span class="op">=</span> py<span class="op">;</span></span>
<span id="cb11-1223"><a href="#cb11-1223" aria-hidden="true" tabindex="-1"></a>      d<span class="op">.</span><span class="at">r</span> <span class="op">=</span> itemSize <span class="op">/</span> <span class="fl">2.0</span><span class="op">;</span></span>
<span id="cb11-1224"><a href="#cb11-1224" aria-hidden="true" tabindex="-1"></a>      px <span class="op">+=</span> itemSize<span class="op">;</span></span>
<span id="cb11-1225"><a href="#cb11-1225" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (px <span class="op">&gt;</span> v<span class="op">.</span><span class="at">width</span>) {</span>
<span id="cb11-1226"><a href="#cb11-1226" aria-hidden="true" tabindex="-1"></a>        px <span class="op">=</span> itemSize <span class="op">/</span> <span class="fl">2.0</span><span class="op">;</span></span>
<span id="cb11-1227"><a href="#cb11-1227" aria-hidden="true" tabindex="-1"></a>        py <span class="op">-=</span> itemSize<span class="op">;</span></span>
<span id="cb11-1228"><a href="#cb11-1228" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb11-1229"><a href="#cb11-1229" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb11-1230"><a href="#cb11-1230" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb11-1231"><a href="#cb11-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1232"><a href="#cb11-1232" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> C <span class="op">=</span> d3<span class="op">.</span><span class="fu">map</span>(data<span class="op">,</span> c)<span class="op">;</span></span>
<span id="cb11-1233"><a href="#cb11-1233" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> cScale <span class="op">=</span> <span class="fu">gatherColor</span>(C)<span class="op">;</span></span>
<span id="cb11-1234"><a href="#cb11-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1235"><a href="#cb11-1235" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb11-1236"><a href="#cb11-1236" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> width)</span>
<span id="cb11-1237"><a href="#cb11-1237" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> height)</span>
<span id="cb11-1238"><a href="#cb11-1238" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb11-1239"><a href="#cb11-1239" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width<span class="op">,</span> height])</span>
<span id="cb11-1240"><a href="#cb11-1240" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"style"</span><span class="op">,</span> <span class="st">"max-width: 100%; height: auto; height: intrinsic;"</span>)<span class="op">;</span></span>
<span id="cb11-1241"><a href="#cb11-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1242"><a href="#cb11-1242" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> chart <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb11-1243"><a href="#cb11-1243" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> stroke)</span>
<span id="cb11-1244"><a href="#cb11-1244" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`translate(</span><span class="sc">${</span>marginLeft<span class="sc">}</span><span class="vs">,</span><span class="sc">${</span>marginTop<span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb11-1245"><a href="#cb11-1245" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb11-1246"><a href="#cb11-1246" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="st">'1.0'</span>)<span class="op">;</span></span>
<span id="cb11-1247"><a href="#cb11-1247" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-1248"><a href="#cb11-1248" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> groups <span class="op">=</span> chart<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb11-1249"><a href="#cb11-1249" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"g"</span>)</span>
<span id="cb11-1250"><a href="#cb11-1250" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(gatherBins)</span>
<span id="cb11-1251"><a href="#cb11-1251" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">"g"</span>)</span>
<span id="cb11-1252"><a href="#cb11-1252" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`translate(</span><span class="sc">${</span>d<span class="op">.</span><span class="at">x</span><span class="sc">}</span><span class="vs">,</span><span class="sc">${</span>d<span class="op">.</span><span class="at">y</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb11-1253"><a href="#cb11-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1254"><a href="#cb11-1254" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> points <span class="op">=</span> groups<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"circle"</span>)</span>
<span id="cb11-1255"><a href="#cb11-1255" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d <span class="kw">=&gt;</span> d)</span>
<span id="cb11-1256"><a href="#cb11-1256" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">"circle"</span>)</span>
<span id="cb11-1257"><a href="#cb11-1257" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">cx</span>)</span>
<span id="cb11-1258"><a href="#cb11-1258" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">cy</span>)</span>
<span id="cb11-1259"><a href="#cb11-1259" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">r</span>)</span>
<span id="cb11-1260"><a href="#cb11-1260" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">cScale</span>(<span class="fu">c</span>(d)))<span class="op">;</span></span>
<span id="cb11-1261"><a href="#cb11-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1262"><a href="#cb11-1262" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> axis <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'path'</span>)</span>
<span id="cb11-1263"><a href="#cb11-1263" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'black'</span>)</span>
<span id="cb11-1264"><a href="#cb11-1264" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb11-1265"><a href="#cb11-1265" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> <span class="vs">`M</span><span class="sc">${</span>marginLeft<span class="sc">}</span><span class="vs">,</span><span class="sc">${</span>marginTop<span class="sc">}</span><span class="vs">V</span><span class="sc">${</span>height <span class="op">-</span> marginBottom<span class="sc">}</span><span class="vs">H</span><span class="sc">${</span>width <span class="op">-</span> marginRight<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb11-1266"><a href="#cb11-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1267"><a href="#cb11-1267" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> horzBands <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb11-1268"><a href="#cb11-1268" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb11-1269"><a href="#cb11-1269" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(cols)</span>
<span id="cb11-1270"><a href="#cb11-1270" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb11-1271"><a href="#cb11-1271" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'black'</span>)</span>
<span id="cb11-1272"><a href="#cb11-1272" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="fl">0.5</span>)</span>
<span id="cb11-1273"><a href="#cb11-1273" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`M</span><span class="sc">${</span>d<span class="op">.</span><span class="at">x</span> <span class="op">+</span> marginLeft <span class="op">+</span> d<span class="op">.</span><span class="at">width</span><span class="sc">}</span><span class="vs">,</span><span class="sc">${</span>height <span class="op">-</span> marginBottom<span class="sc">}</span><span class="vs">v10h</span><span class="sc">${</span><span class="op">-</span>d<span class="op">.</span><span class="at">width</span><span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb11-1274"><a href="#cb11-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1275"><a href="#cb11-1275" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> horzLabels <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb11-1276"><a href="#cb11-1276" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'text'</span>)</span>
<span id="cb11-1277"><a href="#cb11-1277" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(cols)</span>
<span id="cb11-1278"><a href="#cb11-1278" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">'text'</span>)</span>
<span id="cb11-1279"><a href="#cb11-1279" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">x1</span>)</span>
<span id="cb11-1280"><a href="#cb11-1280" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"end"</span>)</span>
<span id="cb11-1281"><a href="#cb11-1281" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'black'</span>)</span>
<span id="cb11-1282"><a href="#cb11-1282" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">x</span> <span class="op">+</span> marginLeft <span class="op">+</span> d<span class="op">.</span><span class="at">width</span>)</span>
<span id="cb11-1283"><a href="#cb11-1283" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> height <span class="op">-</span> <span class="fl">2.0</span>)<span class="op">;</span></span>
<span id="cb11-1284"><a href="#cb11-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1285"><a href="#cb11-1285" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> vertBands <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb11-1286"><a href="#cb11-1286" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb11-1287"><a href="#cb11-1287" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(rows)</span>
<span id="cb11-1288"><a href="#cb11-1288" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb11-1289"><a href="#cb11-1289" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'black'</span>)</span>
<span id="cb11-1290"><a href="#cb11-1290" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="fl">0.5</span>)</span>
<span id="cb11-1291"><a href="#cb11-1291" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`M</span><span class="sc">${</span>marginLeft<span class="sc">}</span><span class="vs">,</span><span class="sc">${</span>d<span class="op">.</span><span class="at">y</span> <span class="op">+</span> marginTop<span class="sc">}</span><span class="vs">h-10v</span><span class="sc">${</span>d<span class="op">.</span><span class="at">height</span><span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb11-1292"><a href="#cb11-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1293"><a href="#cb11-1293" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> vertLabels <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb11-1294"><a href="#cb11-1294" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'text'</span>)</span>
<span id="cb11-1295"><a href="#cb11-1295" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(rows)</span>
<span id="cb11-1296"><a href="#cb11-1296" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">'text'</span>)</span>
<span id="cb11-1297"><a href="#cb11-1297" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">y1</span>)</span>
<span id="cb11-1298"><a href="#cb11-1298" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"start"</span>)</span>
<span id="cb11-1299"><a href="#cb11-1299" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'black'</span>)</span>
<span id="cb11-1300"><a href="#cb11-1300" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'transform'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`translate(2,</span><span class="sc">${</span>d<span class="op">.</span><span class="at">y</span> <span class="op">+</span> marginTop<span class="sc">}</span><span class="vs">)rotate(90)`</span>)<span class="op">;</span></span>
<span id="cb11-1301"><a href="#cb11-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-1302"><a href="#cb11-1302" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb11-1303"><a href="#cb11-1303" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-11-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-11-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-11-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-11-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-11-5" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Interestingly, gatherplots actually preceded the Atom grammar; in fact, our gatherplots design eventually led to the formulation of the more general ideas in Atom. However, as these things go, the grammar itself turned out to be a larger and more actionable idea.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBwcm9ibGVtID0gSW5wdXRzLnJhZGlvKHByb2JsZW1zLCB7Zm9ybWF0OiB4ID0+IHgubmFtZSwgdmFsdWU6IHByb2JsZW1zLmZpbmQodCA9PiB0Lm5hbWUgPT09IFwiKGEpIExpbmUgcGF0dGVybnNcIil9KTtcclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoicHJvYmxlbXMgPSBbXHJcbiAge25hbWU6ICcoYSkgTGluZSBwYXR0ZXJucycsIGNhclg6ICdDeWxpbmRlcnMnLCBjYXJZOiAnTVBHJ30sIFxyXG4gIHtuYW1lOiAnKGIpIERvdCBwYXR0ZXJucycsIGNhclg6ICdDeWxpbmRlcnMnLCBjYXJZOiAnQ3lsaW5kZXJzJ30sXHJcbiAge25hbWU6ICcoYykgRGlhZ29uYWwgcGF0dGVybnMnLCBjYXJYOiAnTVBHJywgY2FyWTogJ01QRyd9XHJcbl07XHJcblxyXG5QbG90LnBsb3Qoe1xyXG4gIGluc2V0OiA4LFxyXG4gIGdyaWQ6IHRydWUsXHJcbiAgY29sb3I6IHtcclxuICAgIGxlZ2VuZDogdHJ1ZSxcclxuICB9LFxyXG4gIG1hcmtzOiBbXHJcbiAgICBQbG90LmRvdChjYXJzLCB7eDogcHJvYmxlbS5jYXJYLCB5OiBwcm9ibGVtLmNhclksIHI6IDggfSlcclxuICBdXHJcbn0pO1xyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2Ygaml0dGVyVmFsdWUgPSBJbnB1dHMucmFuZ2UoWzAsIDMyXSwge3ZhbHVlOiAxNiwgc3RlcDogMS4wLCBsYWJlbDogXCJBbW91bnQgb2Ygaml0dGVyXCJ9KTtcclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC00IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaml0dGVyID0gU2NhdHRlcnBsb3QoY2Fycywge1xyXG4gIHg6IGQgPT4gZFsnQ3lsaW5kZXJzJ10sXHJcbiAgeTogZCA9PiBkWydEaXNwbGFjZW1lbnQnXSxcclxuICBjOiBkID0+IGRbJ09yaWdpbiddLFxyXG4gIGppdHRlcjogKCkgPT4gKE1hdGgucmFuZG9tKCkgLTAuNSkgKiBqaXR0ZXJWYWx1ZSxcclxuICB3aWR0aCxcclxuICBoZWlnaHQ6IDYwMFxyXG59KTtcclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIHhBeGlzID0gSW5wdXRzLnNlbGVjdChjYXJzLmNvbHVtbnMsIHtsYWJlbDogXCJYIEF4aXNcIiwgdmFsdWU6IGNhcnMuY29sdW1uc1swXX0pO1xyXG52aWV3b2YgeUF4aXMgPSBJbnB1dHMuc2VsZWN0KGNhcnMuY29sdW1ucywge2xhYmVsOiBcIlkgQXhpc1wiLCB2YWx1ZTogY2Fycy5jb2x1bW5zWzFdfSk7XHJcbnZpZXdvZiBjb2xvciA9IElucHV0cy5zZWxlY3QoY29sb3JzLCB7Zm9ybWF0OiB4ID0+IHgubmFtZSwgdmFsdWU6IGNvbG9ycy5maW5kKHQgPT4gdC5uYW1lID09PSBcIkN5bGluZGVyc1wiKSwgbGFiZWw6IFwiQ29sb3JcIn0pO1xyXG52aWV3b2Ygc29ydGluZyA9IElucHV0cy5jaGVja2JveChbXCJjb2xvclwiXSwge2xhYmVsOiBcIlNvcnRpbmdcIn0pO1xyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJDID0gZDMubWFwKGNhcnMsIGQgPT4gZFtjb2xvci5uYW1lXSkuc29ydCgpO1xyXG5jb2xvci5jYXRlZ29yaWNhbCA/XHJcbiAgU3dhdGNoZXMoZDMuc2NhbGVPcmRpbmFsKG5ldyBTZXQoQykudmFsdWVzKCksIGQzLnNjaGVtZUNhdGVnb3J5MTApKSA6XHJcbiAgTGVnZW5kKGQzLnNjYWxlU2VxdWVudGlhbCgpLmludGVycG9sYXRvcihkMy5pbnRlcnBvbGF0ZVlsR25CdSkuZG9tYWluKGQzLmV4dGVudChDKSksIHt0aXRsZTogY29sb3IubmFtZX0pOyBcclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC03IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiY29sb3JzID0gW1xyXG4gIHtuYW1lOiAnTmFtZScsIGNhdGVnb3JpY2FsOiB0cnVlfSwgXHJcbiAge25hbWU6ICdNUEcnLCBjYXRlZ29yaWNhbDogZmFsc2V9LCBcclxuICB7bmFtZTogJ0N5bGluZGVycycsIGNhdGVnb3JpY2FsOiB0cnVlfSwgXHJcbiAge25hbWU6ICdEaXNwbGFjZW1lbnQnLCBjYXRlZ29yaWNhbDogZmFsc2V9LCBcclxuICB7bmFtZTogJ0hvcnNlcG93ZXInLCBjYXRlZ29yaWNhbDogZmFsc2V9LCBcclxuICB7bmFtZTogJ1dlaWdodCcsIGNhdGVnb3JpY2FsOiBmYWxzZX0sIFxyXG4gIHtuYW1lOiAnQWNjZWxlcmF0aW9uJywgY2F0ZWdvcmljYWw6IGZhbHNlfSwgXHJcbiAge25hbWU6ICdNb2RlbCcsIGNhdGVnb3JpY2FsOiBmYWxzZX0sIFxyXG4gIHtuYW1lOiAnT3JpZ2luJywgY2F0ZWdvcmljYWw6IHRydWV9XHJcbl07XHJcblxyXG5nYXRoZXIgPSBHYXRoZXJQbG90KGNhcnMsIHsgXHJcbiAgeDogZCA9PiBkW3hBeGlzXSxcclxuICB5OiBkID0+IGRbeUF4aXNdLFxyXG4gIGM6IGQgPT4gZFtjb2xvci5uYW1lXSxcclxuICB5U29ydDogc29ydGluZy5pbmRleE9mKCdZIGRlc2NlbmRpbmcnKSA9PT0gLTEgPyAxIDogLTEsXHJcbiAgeFNvcnQ6IHNvcnRpbmcuaW5kZXhPZignWCBkZXNjZW5kaW5nJykgPT09IC0xID8gMSA6IC0xLFxyXG4gIGNTb3J0OiBzb3J0aW5nLmluZGV4T2YoJ2NvbG9yJykgPT09IC0xID8gMCA6IDEsXHJcbiAgd2lkdGgsXHJcbiAgaGVpZ2h0OiA2MDBcclxufSk7XHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtOCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImNhcnMgPSBGaWxlQXR0YWNobWVudChcImNhcnMuY3N2XCIpLmNzdih7IHR5cGVkOiB0cnVlIH0pXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtOSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImltcG9ydCB7TGVnZW5kLCBTd2F0Y2hlc30gZnJvbSBcIkBkMy9jb2xvci1sZWdlbmRcIlxyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZnVuY3Rpb24gU2NhdHRlcnBsb3QoZGF0YSwge1xyXG4gIHggPSAoW3hdKSA9PiB4LCAvLyBnaXZlbiBkIGluIGRhdGEsIHJldHVybnMgdGhlIChxdWFudGl0YXRpdmUpIHgtdmFsdWVcclxuICB5ID0gKFssIHldKSA9PiB5LCAvLyBnaXZlbiBkIGluIGRhdGEsIHJldHVybnMgdGhlIChxdWFudGl0YXRpdmUpIHktdmFsdWVcclxuICBjID0gKFssICwgY10pID0+IGMsXHJcbiAgciA9IDMsIC8vIChmaXhlZCkgcmFkaXVzIG9mIGRvdHMsIGluIHBpeGVsc1xyXG4gIHRpdGxlLCAvLyBnaXZlbiBkIGluIGRhdGEsIHJldHVybnMgdGhlIHRpdGxlXHJcbiAgbWFyZ2luVG9wID0gMjAsIC8vIHRvcCBtYXJnaW4sIGluIHBpeGVsc1xyXG4gIG1hcmdpblJpZ2h0ID0gMzAsIC8vIHJpZ2h0IG1hcmdpbiwgaW4gcGl4ZWxzXHJcbiAgbWFyZ2luQm90dG9tID0gMzAsIC8vIGJvdHRvbSBtYXJnaW4sIGluIHBpeGVsc1xyXG4gIG1hcmdpbkxlZnQgPSA0MCwgLy8gbGVmdCBtYXJnaW4sIGluIHBpeGVsc1xyXG4gIGluc2V0ID0gciAqIDIsIC8vIGluc2V0IHRoZSBkZWZhdWx0IHJhbmdlLCBpbiBwaXhlbHNcclxuICBpbnNldFRvcCA9IGluc2V0LCAvLyBpbnNldCB0aGUgZGVmYXVsdCB5LXJhbmdlXHJcbiAgaW5zZXRSaWdodCA9IGluc2V0LCAvLyBpbnNldCB0aGUgZGVmYXVsdCB4LXJhbmdlXHJcbiAgaW5zZXRCb3R0b20gPSBpbnNldCwgLy8gaW5zZXQgdGhlIGRlZmF1bHQgeS1yYW5nZVxyXG4gIGluc2V0TGVmdCA9IGluc2V0LCAvLyBpbnNldCB0aGUgZGVmYXVsdCB4LXJhbmdlXHJcbiAgd2lkdGggPSA2NDAsIC8vIG91dGVyIHdpZHRoLCBpbiBwaXhlbHNcclxuICBoZWlnaHQgPSA0MDAsIC8vIG91dGVyIGhlaWdodCwgaW4gcGl4ZWxzXHJcbiAgeFR5cGUgPSBkMy5zY2FsZUxpbmVhciwgLy8gdHlwZSBvZiB4LXNjYWxlXHJcbiAgeERvbWFpbiwgLy8gW3htaW4sIHhtYXhdXHJcbiAgeFJhbmdlID0gW21hcmdpbkxlZnQgKyBpbnNldExlZnQsIHdpZHRoIC0gbWFyZ2luUmlnaHQgLSBpbnNldFJpZ2h0XSwgLy8gW2xlZnQsIHJpZ2h0XVxyXG4gIHlUeXBlID0gZDMuc2NhbGVMaW5lYXIsIC8vIHR5cGUgb2YgeS1zY2FsZVxyXG4gIHlEb21haW4sIC8vIFt5bWluLCB5bWF4XVxyXG4gIHlSYW5nZSA9IFtoZWlnaHQgLSBtYXJnaW5Cb3R0b20gLSBpbnNldEJvdHRvbSwgbWFyZ2luVG9wICsgaW5zZXRUb3BdLCAvLyBbYm90dG9tLCB0b3BdXHJcbiAgY1R5cGUgPSBkMy5zY2FsZU9yZGluYWwsXHJcbiAgY1JhbmdlID0gZDMuc2NoZW1lQ2F0ZWdvcnkxMCxcclxuICB4TGFiZWwsIC8vIGEgbGFiZWwgZm9yIHRoZSB4LWF4aXNcclxuICB5TGFiZWwsIC8vIGEgbGFiZWwgZm9yIHRoZSB5LWF4aXNcclxuICB4Rm9ybWF0LCAvLyBhIGZvcm1hdCBzcGVjaWZpZXIgc3RyaW5nIGZvciB0aGUgeC1heGlzXHJcbiAgeUZvcm1hdCwgLy8gYSBmb3JtYXQgc3BlY2lmaWVyIHN0cmluZyBmb3IgdGhlIHktYXhpc1xyXG4gIGppdHRlciA9ICgpID0+IDAuMCxcclxuICBmaWxsID0gXCJub25lXCIsIC8vIGZpbGwgY29sb3IgZm9yIGRvdHNcclxuICBzdHJva2UgPSBcImN1cnJlbnRDb2xvclwiLCAvLyBzdHJva2UgY29sb3IgZm9yIHRoZSBkb3RzXHJcbiAgc3Ryb2tlV2lkdGggPSAxLjUsIC8vIHN0cm9rZSB3aWR0aCBmb3IgZG90c1xyXG4gIGhhbG8gPSBcIiNmZmZcIiwgLy8gY29sb3Igb2YgbGFiZWwgaGFsb1xyXG4gIGhhbG9XaWR0aCA9IDMgLy8gcGFkZGluZyBhcm91bmQgdGhlIGxhYmVsc1xyXG59ID0ge30pIHtcclxuICAvLyBDb21wdXRlIHZhbHVlcy5cclxuICBjb25zdCBYID0gZDMubWFwKGRhdGEsIHgpO1xyXG4gIGNvbnN0IFkgPSBkMy5tYXAoZGF0YSwgeSk7XHJcbiAgY29uc3QgQyA9IGQzLm1hcChkYXRhLCBjKTtcclxuICBjb25zdCBUID0gdGl0bGUgPT0gbnVsbCA/IG51bGwgOiBkMy5tYXAoZGF0YSwgdGl0bGUpO1xyXG4gIGNvbnN0IEkgPSBkMy5yYW5nZShYLmxlbmd0aCkuZmlsdGVyKGkgPT4gIWlzTmFOKFhbaV0pICYmICFpc05hTihZW2ldKSk7XHJcblxyXG4gIC8vIENvbXB1dGUgZGVmYXVsdCBkb21haW5zLlxyXG4gIGlmICh4RG9tYWluID09PSB1bmRlZmluZWQpIHhEb21haW4gPSBkMy5leHRlbnQoWCk7XHJcbiAgaWYgKHlEb21haW4gPT09IHVuZGVmaW5lZCkgeURvbWFpbiA9IGQzLmV4dGVudChZKTtcclxuXHJcbiAgLy8gQ29uc3RydWN0IHNjYWxlcyBhbmQgYXhlcy5cclxuICBjb25zdCB4U2NhbGUgPSB4VHlwZSh4RG9tYWluLCB4UmFuZ2UpO1xyXG4gIGNvbnN0IHlTY2FsZSA9IHlUeXBlKHlEb21haW4sIHlSYW5nZSk7XHJcbiAgY29uc3QgY1NjYWxlID0gY1R5cGUoY1JhbmdlKTtcclxuICBjb25zdCB4QXhpcyA9IGQzLmF4aXNCb3R0b20oeFNjYWxlKS50aWNrcyh3aWR0aCAvIDgwLCB4Rm9ybWF0KTtcclxuICBjb25zdCB5QXhpcyA9IGQzLmF4aXNMZWZ0KHlTY2FsZSkudGlja3MoaGVpZ2h0IC8gNTAsIHlGb3JtYXQpO1xyXG5cclxuICBjb25zdCBzdmcgPSBkMy5jcmVhdGUoXCJzdmdcIilcclxuICAgICAgLmF0dHIoXCJ3aWR0aFwiLCB3aWR0aClcclxuICAgICAgLmF0dHIoXCJoZWlnaHRcIiwgaGVpZ2h0KVxyXG4gICAgICAuYXR0cihcInZpZXdCb3hcIiwgWzAsIDAsIHdpZHRoLCBoZWlnaHRdKVxyXG4gICAgICAuYXR0cihcInN0eWxlXCIsIFwibWF4LXdpZHRoOiAxMDAlOyBoZWlnaHQ6IGF1dG87IGhlaWdodDogaW50cmluc2ljO1wiKTtcclxuXHJcbiAgc3ZnLmFwcGVuZChcImdcIilcclxuICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgwLCR7aGVpZ2h0IC0gbWFyZ2luQm90dG9tfSlgKVxyXG4gICAgICAuY2FsbCh4QXhpcylcclxuICAgICAgLmNhbGwoZyA9PiBnLnNlbGVjdChcIi5kb21haW5cIikucmVtb3ZlKCkpXHJcbiAgICAgIC5jYWxsKGcgPT4gZy5zZWxlY3RBbGwoXCIudGljayBsaW5lXCIpLmNsb25lKClcclxuICAgICAgICAgIC5hdHRyKFwieTJcIiwgbWFyZ2luVG9wICsgbWFyZ2luQm90dG9tIC0gaGVpZ2h0KVxyXG4gICAgICAgICAgLmF0dHIoXCJzdHJva2Utb3BhY2l0eVwiLCAwLjEpKVxyXG4gICAgICAuY2FsbChnID0+IGcuYXBwZW5kKFwidGV4dFwiKVxyXG4gICAgICAgICAgLmF0dHIoXCJ4XCIsIHdpZHRoKVxyXG4gICAgICAgICAgLmF0dHIoXCJ5XCIsIG1hcmdpbkJvdHRvbSAtIDQpXHJcbiAgICAgICAgICAuYXR0cihcImZpbGxcIiwgXCJjdXJyZW50Q29sb3JcIilcclxuICAgICAgICAgIC5hdHRyKFwidGV4dC1hbmNob3JcIiwgXCJlbmRcIilcclxuICAgICAgICAgIC50ZXh0KHhMYWJlbCkpO1xyXG5cclxuICBzdmcuYXBwZW5kKFwiZ1wiKVxyXG4gICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKCR7bWFyZ2luTGVmdH0sMClgKVxyXG4gICAgICAuY2FsbCh5QXhpcylcclxuICAgICAgLmNhbGwoZyA9PiBnLnNlbGVjdChcIi5kb21haW5cIikucmVtb3ZlKCkpXHJcbiAgICAgIC5jYWxsKGcgPT4gZy5zZWxlY3RBbGwoXCIudGljayBsaW5lXCIpLmNsb25lKClcclxuICAgICAgICAgIC5hdHRyKFwieDJcIiwgd2lkdGggLSBtYXJnaW5MZWZ0IC0gbWFyZ2luUmlnaHQpXHJcbiAgICAgICAgICAuYXR0cihcInN0cm9rZS1vcGFjaXR5XCIsIDAuMSkpXHJcbiAgICAgIC5jYWxsKGcgPT4gZy5hcHBlbmQoXCJ0ZXh0XCIpXHJcbiAgICAgICAgICAuYXR0cihcInhcIiwgLW1hcmdpbkxlZnQpXHJcbiAgICAgICAgICAuYXR0cihcInlcIiwgMTApXHJcbiAgICAgICAgICAuYXR0cihcImZpbGxcIiwgXCJjdXJyZW50Q29sb3JcIilcclxuICAgICAgICAgIC5hdHRyKFwidGV4dC1hbmNob3JcIiwgXCJzdGFydFwiKVxyXG4gICAgICAgICAgLnRleHQoeUxhYmVsKSk7XHJcblxyXG4gIGlmIChUKSBzdmcuYXBwZW5kKFwiZ1wiKVxyXG4gICAgICAuYXR0cihcImZvbnQtZmFtaWx5XCIsIFwic2Fucy1zZXJpZlwiKVxyXG4gICAgICAuYXR0cihcImZvbnQtc2l6ZVwiLCAxMClcclxuICAgICAgLmF0dHIoXCJzdHJva2UtbGluZWpvaW5cIiwgXCJyb3VuZFwiKVxyXG4gICAgICAuYXR0cihcInN0cm9rZS1saW5lY2FwXCIsIFwicm91bmRcIilcclxuICAgIC5zZWxlY3RBbGwoXCJ0ZXh0XCIpXHJcbiAgICAuZGF0YShJKVxyXG4gICAgLmpvaW4oXCJ0ZXh0XCIpXHJcbiAgICAgIC5hdHRyKFwiZHhcIiwgNylcclxuICAgICAgLmF0dHIoXCJkeVwiLCBcIjAuMzVlbVwiKVxyXG4gICAgICAuYXR0cihcInhcIiwgaSA9PiB4U2NhbGUoWFtpXSkpXHJcbiAgICAgIC5hdHRyKFwieVwiLCBpID0+IHlTY2FsZShZW2ldKSlcclxuICAgICAgLnRleHQoaSA9PiBUW2ldKVxyXG4gICAgICAuY2FsbCh0ZXh0ID0+IHRleHQuY2xvbmUodHJ1ZSkpXHJcbiAgICAgIC5hdHRyKFwiZmlsbFwiLCBcIm5vbmVcIilcclxuICAgICAgLmF0dHIoXCJzdHJva2VcIiwgaGFsbylcclxuICAgICAgLmF0dHIoXCJzdHJva2Utd2lkdGhcIiwgaGFsb1dpZHRoKTtcclxuXHJcbiAgc3ZnLmFwcGVuZChcImdcIilcclxuICAgICAgLmF0dHIoXCJmaWxsXCIsIGZpbGwpXHJcbiAgICAgIC5hdHRyKFwic3Ryb2tlXCIsIHN0cm9rZSlcclxuICAgICAgLmF0dHIoXCJzdHJva2Utd2lkdGhcIiwgc3Ryb2tlV2lkdGgpXHJcbiAgICAuc2VsZWN0QWxsKFwiY2lyY2xlXCIpXHJcbiAgICAuZGF0YShJKVxyXG4gICAgLmpvaW4oXCJjaXJjbGVcIilcclxuICAgICAgLmF0dHIoXCJjeFwiLCBpID0+IHhTY2FsZShYW2ldKSArIGppdHRlcigpKVxyXG4gICAgICAuYXR0cihcImN5XCIsIGkgPT4geVNjYWxlKFlbaV0pICsgaml0dGVyKCkpXHJcbiAgICAgIC5hdHRyKFwic3Ryb2tlXCIsIGkgPT4gY1NjYWxlKENbaV0pKVxyXG4gICAgICAuYXR0cihcInJcIiwgcik7XHJcblxyXG4gIHJldHVybiBzdmcubm9kZSgpO1xyXG59XHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJmdW5jdGlvbiBiaW5DYXRlZ29yaWNhbChkYXRhLCBhY2Nlc3Nvcikge1xyXG4gIGxldCBiaW5zID0gW107XHJcbiAgZGF0YS5mb3JFYWNoKHYgPT4ge1xyXG4gICAgbGV0IGVsZW0gPSBiaW5zLmZpbmRJbmRleChiaW4gPT4gYmluLnYgPT09IGFjY2Vzc29yKHYpKTtcclxuICAgIGlmIChlbGVtID09PSAtMSkge1xyXG4gICAgICBiaW5zLnB1c2goW10pO1xyXG4gICAgICBlbGVtID0gYmlucy5sZW5ndGggLSAxO1xyXG4gICAgICBiaW5zW2VsZW1dLnYgPSBhY2Nlc3Nvcih2KTtcclxuICAgICAgYmluc1tlbGVtXS54MCA9IGFjY2Vzc29yKHYpO1xyXG4gICAgICBiaW5zW2VsZW1dLngxID0gYWNjZXNzb3Iodik7XHJcbiAgICB9XHJcbiAgICBiaW5zW2VsZW1dLnB1c2godik7XHJcbiAgfSk7XHJcbiAgcmV0dXJuIGJpbnM7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGZpbmRJbnRlcnNlY3Rpb25zKHhCaW5zLCB5Qmlucykge1xyXG4gIGxldCBwbG90QmlucyA9IFtdO1xyXG4gIHhCaW5zLmZvckVhY2goeEJpbiA9PiB7XHJcbiAgICB5Qmlucy5mb3JFYWNoKHlCaW4gPT4ge1xyXG4gICAgICBcclxuICAgICAgLy8gQWRkIHRoaXMgcGxvdCBiaW5cclxuICAgICAgbGV0IGxhc3QgPSBwbG90Qmlucy5wdXNoKFtdKTtcclxuICAgICAgcGxvdEJpbnNbbGFzdCAtIDFdLngwID0geEJpbi54MDtcclxuICAgICAgcGxvdEJpbnNbbGFzdCAtIDFdLngxID0geEJpbi54MTtcclxuICAgICAgcGxvdEJpbnNbbGFzdCAtIDFdLnkwID0geUJpbi54MDtcclxuICAgICAgcGxvdEJpbnNbbGFzdCAtIDFdLnkxID0geUJpbi54MVxyXG4gICAgICBcclxuICAgICAgLy8gQWRkIHRoZSBpbnRlcnNlY3RlZCBlbGVtZW50c1xyXG4gICAgICBjb25zdCBpbnRlcnNlY3Rpb24gPSB4QmluLmZpbHRlcih2YWx1ZSA9PiB5QmluLmluY2x1ZGVzKHZhbHVlKSk7XHJcbiAgICAgIHBsb3RCaW5zW2xhc3QgLSAxXS5wdXNoKC4uLmludGVyc2VjdGlvbik7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gIH0pO1xyXG4gIHJldHVybiBwbG90QmlucztcclxufVxyXG5cclxuZnVuY3Rpb24gZ2F0aGVyQ29sb3IoZGF0YSkge1xyXG4gIGxldCBjRG9tYWluID0gbmV3IFNldChkYXRhKTtcclxuICBpZiAoY0RvbWFpbi5zaXplID4gMTAgJiYgTnVtYmVyLmlzRmluaXRlKGRhdGFbMF0pKSB7XHJcbiAgICByZXR1cm4gZDMuc2NhbGVTZXF1ZW50aWFsKClcclxuICAgICAgLmludGVycG9sYXRvcihkMy5pbnRlcnBvbGF0ZVlsR25CdSkgICAgXHJcbiAgICAgIC5kb21haW4oZDMuZXh0ZW50KGRhdGEpKTtcclxuICB9XHJcbiAgZWxzZSB7XHJcbiAgICByZXR1cm4gZDMuc2NhbGVPcmRpbmFsKGQzLnNjaGVtZUNhdGVnb3J5MTApXHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBnYXRoZXIyRChkYXRhLCB7XHJcbiAgeCA9IChbeF0pID0+IHgsIC8vIGdpdmVuIGQgaW4gZGF0YSwgcmV0dXJucyB0aGUgKHF1YW50aXRhdGl2ZSkgeC12YWx1ZVxyXG4gIHkgPSAoWywgeV0pID0+IHksIC8vIGdpdmVuIGQgaW4gZGF0YSwgcmV0dXJucyB0aGUgKHF1YW50aXRhdGl2ZSkgeS12YWx1ZVxyXG59ID0ge30pIHtcclxuXHJcbiAgLy8gRXh0cmFjdCB0aGUgdmFsdWVzXHJcbiAgbGV0IHZhbHVlcyA9IGl0ZXJhYmxlID0+IG5ldyBTZXQoaXRlcmFibGUpO1xyXG4gIGxldCB4RG9tYWluID0gdmFsdWVzKGQzLm1hcChkYXRhLCB4KSk7XHJcbiAgbGV0IHlEb21haW4gPSB2YWx1ZXMoZDMubWFwKGRhdGEsIHkpKTtcclxuXHJcbiAgLy8gQmluIHRoZSBheGVzOiBudW1lcmljYWwgb3IgY2F0ZWdvcmljYWxcclxuICBsZXQgeEJpbnMsIHlCaW5zO1xyXG4gIGlmICh4RG9tYWluLnNpemUgPiAxMCkgeyBcclxuICAgIGxldCBiaW4gPSBkMy5iaW4oKS52YWx1ZSh4KTtcclxuICAgIHhCaW5zID0gYmluKGRhdGEpO1xyXG4gIH1cclxuICBlbHNlIHtcclxuICAgIHhCaW5zID0gYmluQ2F0ZWdvcmljYWwoZGF0YSwgeCk7ICAgIFxyXG4gIH1cclxuICBpZiAoeURvbWFpbi5zaXplID4gMTApIHsgXHJcbiAgICBsZXQgYmluID0gZDMuYmluKCkudmFsdWUoeSk7XHJcbiAgICB5QmlucyA9IGJpbihkYXRhKTtcclxuICB9XHJcbiAgZWxzZSB7XHJcbiAgICB5QmlucyA9IGJpbkNhdGVnb3JpY2FsKGRhdGEsIHkpOyAgICBcclxuICB9XHJcblxyXG4gIC8vIE5vdyBmaW5kIHRoZSBpbnRlcnNlY3Rpb25zXHJcbiAgcmV0dXJuIGZpbmRJbnRlcnNlY3Rpb25zKHhCaW5zLCB5Qmlucyk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEdhdGhlclBsb3QoZGF0YSwge1xyXG4gIHggPSAoW3hdKSA9PiB4LCAvLyBnaXZlbiBkIGluIGRhdGEsIHJldHVybnMgdGhlIHgtdmFsdWVcclxuICB5ID0gKFssIHldKSA9PiB5LCAvLyBnaXZlbiBkIGluIGRhdGEsIHJldHVybnMgdGhlIHktdmFsdWVcclxuICBjID0gKFssICwgY10pID0+IGMsXHJcbiAgc3BhY2luZyA9IDQsXHJcbiAgd2lkdGggPSA2NDAsIC8vIG91dGVyIHdpZHRoLCBpbiBwaXhlbHNcclxuICBoZWlnaHQgPSA0MDAsIC8vIG91dGVyIGhlaWdodCwgaW4gcGl4ZWxzXHJcbiAgbWFyZ2luVG9wID0gMzAsIC8vIHRvcCBtYXJnaW4sIGluIHBpeGVsc1xyXG4gIG1hcmdpblJpZ2h0ID0gMzAsIC8vIHJpZ2h0IG1hcmdpbiwgaW4gcGl4ZWxzXHJcbiAgbWFyZ2luQm90dG9tID0gMzAsIC8vIGJvdHRvbSBtYXJnaW4sIGluIHBpeGVsc1xyXG4gIG1hcmdpbkxlZnQgPSAzMCwgLy8gbGVmdCBtYXJnaW4sIGluIHBpeGVsc1xyXG4gIGNoYXJ0V2lkdGggPSB3aWR0aCAtIG1hcmdpbkxlZnQgLSBtYXJnaW5SaWdodCxcclxuICBjaGFydEhlaWdodCA9IGhlaWdodCAtIG1hcmdpblRvcCAtIG1hcmdpbkJvdHRvbSxcclxuICBzdHJva2UgPSAnbm9uZScsXHJcbiAgeFNvcnQgPSAxLFxyXG4gIHlTb3J0ID0gMSxcclxuICBjU29ydCA9IDAsXHJcbn0gPSB7fSkge1xyXG5cclxuICAvLyBGaW5kIHRoZSBpbnRlcnNlY3Rpb25cclxuICBsZXQgZ2F0aGVyQmlucyA9IGdhdGhlcjJEKGRhdGEsIHt4OiB4LCB5OiB5fSk7XHJcblxyXG4gIC8vIFNvcnQgYnkgdGhlIGxhcmdlc3QgYmluXHJcbiAgZ2F0aGVyQmlucyA9IGdhdGhlckJpbnMuc29ydCgoYSwgYikgPT4gYi5sZW5ndGggLSBhLmxlbmd0aCk7XHJcblxyXG4gIC8vIFN0YXJ0aW5nIHdpdGggdGhlIGxhcmdlc3QsIGFkZCB0aGUgYmlucyBvbmUgYnkgb25lIHRvIHRoZSBwbG90XHJcbiAgbGV0IGFzcGVjdCA9IGNoYXJ0V2lkdGggLyBjaGFydEhlaWdodDtcclxuICBsZXQgY29scyA9IFtdO1xyXG4gIGxldCByb3dzID0gW107XHJcblxyXG4gIGdhdGhlckJpbnMuZm9yRWFjaCh2ID0+IHsgIFxyXG5cclxuICAgIGxldCB4RGltLCB5RGltO1xyXG5cclxuICAgIC8vIExvb2sgdXAgdGhlIHJvd3MgYW5kIGNvbHVtbnNcclxuICAgIGxldCBuZHggPSBjb2xzLmZpbmRJbmRleChjID0+IGMueDAgPT09IHYueDApO1xyXG4gICAgbGV0IG5keSA9IHJvd3MuZmluZEluZGV4KHIgPT4gci55MCA9PT0gdi55MCk7XHJcblxyXG4gICAgLy8gQ2FzZSAwOiBmaXJzdCBjZWxsIHBsYWNlZFxyXG4gICAgaWYgKGNvbHMubGVuZ3RoID09PSAwICYmIHJvd3MubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHhEaW0gPSBNYXRoLmNlaWwoTWF0aC5zcXJ0KGFzcGVjdCAqIGRhdGEubGVuZ3RoKSk7XHJcbiAgICAgIGlmICh4RGltID4gdi5sZW5ndGgpIHhEaW0gPSB2Lmxlbmd0aDtcclxuICAgICAgeURpbSA9IE1hdGguY2VpbCh2Lmxlbmd0aCAvIHhEaW0pO1xyXG4gICAgfVxyXG4gICAgLy8gQ2FzZSAxOiBubyBjb2x1bW4gb3Igcm93IGdpdmVuXHJcbiAgICBlbHNlIGlmIChuZHggPT09IC0xICYmIG5keSA9PT0gLTEpIHtcclxuICAgICAgeERpbSA9IE1hdGguY2VpbChNYXRoLnNxcnQoYXNwZWN0ICogdi5sZW5ndGgpKTtcclxuICAgICAgeURpbSA9IE1hdGguY2VpbCh2Lmxlbmd0aCAvIHhEaW0pO1xyXG4gICAgfVxyXG4gICAgLy8gQ2FzZSAyOiBubyBjb2x1bW4gZ2l2ZW5cclxuICAgIGVsc2UgaWYgKG5keCA9PT0gLTEpIHtcclxuICAgICAgeURpbSA9IHJvd3NbbmR5XS55RGltO1xyXG4gICAgICB4RGltID0gTWF0aC5jZWlsKHYubGVuZ3RoIC8geURpbSk7XHJcbiAgICB9XHJcbiAgICAvLyBDYXNlIDM6IG5vIHJvdyBnaXZlblxyXG4gICAgZWxzZSBpZiAobmR5ID09PSAtMSkge1xyXG4gICAgICB4RGltID0gY29sc1tuZHhdLnhEaW07XHJcbiAgICAgIHlEaW0gPSBNYXRoLmNlaWwodi5sZW5ndGggLyB4RGltKTtcclxuICAgIH1cclxuICAgIC8vIENhc2UgNDogYm90aCBjb2x1bW4gYW5kIHJvdyBnaXZlblxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHhEaW0gPSBjb2xzW25keF0ueERpbTtcclxuICAgICAgeURpbSA9IHJvd3NbbmR5XS55RGltO1xyXG4gICAgICBpZiAoeERpbSAqIHlEaW0gPCB2Lmxlbmd0aCkge1xyXG4gICAgICAgIHlEaW0gPSBNYXRoLmNlaWwodi5sZW5ndGggLyB4RGltKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIE5vdyBhZGQgdGhlIG1pc3NpbmcgY29sdW1ucyBhbmQgcm93c1xyXG4gICAgaWYgKG5keCA9PT0gLTEpIGNvbHMucHVzaCh7IHgwOiB2LngwLCB4MTogdi54MSwgeERpbTogeERpbSB9KTtcclxuICAgIGlmIChuZHkgPT09IC0xKSByb3dzLnB1c2goeyB5MDogdi55MCwgeTE6IHYueTEsIHlEaW06IHlEaW0gfSk7XHJcblxyXG4gICAgLy8gU3RvcmUgdGhlIGRpbWVuc2lvbnNcclxuICAgIHYueERpbSA9IHhEaW07XHJcbiAgICB2LnlEaW0gPSB5RGltO1xyXG4gIH0pO1xyXG5cclxuICBsZXQgY21wID0gKGEsIGIpID0+IHtcclxuICAgIGlmIChhIDwgYikgcmV0dXJuIC0xO1xyXG4gICAgaWYgKGEgPiBiKSByZXR1cm4gMTtcclxuICAgIHJldHVybiAwO1xyXG4gIH07XHJcbiAgXHJcbiAgLy8gU29ydCB0aGUgcGxvdHNcclxuICBnYXRoZXJCaW5zLnNvcnQoKGEsIGIpID0+IHtcclxuICAgIGxldCB4UmVzID0gIHhTb3J0ICogY21wKGEueDAsIGIueDApO1xyXG4gICAgbGV0IHlSZXMgPSAteVNvcnQgKiBjbXAoYS55MCwgYi55MCk7XHJcbiAgICBpZiAoeFJlcyAhPT0gMCkgcmV0dXJuIHhSZXM7XHJcbiAgICByZXR1cm4geVJlcztcclxuICB9KTtcclxuXHJcbiAgLy8gTm93IGZpZ3VyZSBvdXQgdGhlIG1heGltdW0gd2lkdGggYW5kIGhlaWdodCBcclxuICBsZXQgaXRlbUNvbHMgPSBjb2xzLnJlZHVjZSgoYWNjLCBjb2wpID0+IGFjYyArIGNvbC54RGltLCAwKTtcclxuICBsZXQgaXRlbVJvd3MgPSByb3dzLnJlZHVjZSgoYWNjLCByb3cpID0+IGFjYyArIHJvdy55RGltLCAwKTtcclxuICBsZXQgaXRlbVdpZHRoID0gKGNoYXJ0V2lkdGggLSBzcGFjaW5nICogKGNvbHMubGVuZ3RoIC0gMSkpIC8gaXRlbUNvbHM7XHJcbiAgbGV0IGl0ZW1IZWlnaHQgPSAoY2hhcnRIZWlnaHQgLSBzcGFjaW5nICogKHJvd3MubGVuZ3RoIC0gMSkpIC8gaXRlbVJvd3M7XHJcbiAgbGV0IGl0ZW1TaXplID0gTWF0aC5taW4oaXRlbVdpZHRoLCBpdGVtSGVpZ2h0KTtcclxuICBsZXQgeFBhZGRpbmcgPSAoY2hhcnRXaWR0aCAtIGl0ZW1TaXplICogaXRlbUNvbHMpIC8gY29scy5sZW5ndGg7XHJcbiAgbGV0IHlQYWRkaW5nID0gKGNoYXJ0SGVpZ2h0IC0gaXRlbVNpemUgKiBpdGVtUm93cykgLyByb3dzLmxlbmd0aDtcclxuXHJcbiAgLy8gTm93IGRvIHRoZSBjZWxsIGxheW91dFxyXG4gIGNvbHMuc29ydCgoYSwgYikgPT4gIHhTb3J0ICogY21wKGEueDAsIGIueDApKTtcclxuICByb3dzLnNvcnQoKGEsIGIpID0+IC15U29ydCAqIGNtcChhLnkwLCBiLnkwKSk7XHJcbiAgXHJcbiAgbGV0IHBvc3ggPSB4UGFkZGluZyAvIDI7XHJcbiAgZm9yIChsZXQgcHggPSAwOyBweCA8IGNvbHMubGVuZ3RoOyBweCsrKSB7XHJcbiAgICBjb2xzW3B4XS54ID0gcG9zeDtcclxuICAgIGNvbHNbcHhdLndpZHRoID0gY29sc1tweF0ueERpbSAqIGl0ZW1TaXplO1xyXG4gICAgcG9zeCArPSBjb2xzW3B4XS53aWR0aCArIHhQYWRkaW5nO1xyXG4gIH1cclxuICBsZXQgcG9zeSA9IHlQYWRkaW5nIC8gMjtcclxuICBmb3IgKGxldCBweSA9IDA7IHB5IDwgcm93cy5sZW5ndGg7IHB5KyspIHtcclxuICAgIHJvd3NbcHldLnkgPSBwb3N5O1xyXG4gICAgcm93c1tweV0uaGVpZ2h0ID0gcm93c1tweV0ueURpbSAqIGl0ZW1TaXplO1xyXG4gICAgcG9zeSArPSByb3dzW3B5XS5oZWlnaHQgKyB5UGFkZGluZztcclxuICB9XHJcbiAgXHJcbiAgLy8gbGV0IHBvc3ggPSB4UGFkZGluZyAvIDI7XHJcbiAgZm9yIChsZXQgcHggPSAwOyBweCA8IGNvbHMubGVuZ3RoOyBweCsrKSB7XHJcbiAgICBmb3IgKGxldCBweSA9IDA7IHB5IDwgcm93cy5sZW5ndGg7IHB5KyspIHtcclxuICAgICAgbGV0IG9mZnNldCA9IHB4ICogcm93cy5sZW5ndGggKyBweTtcclxuICAgICAgZ2F0aGVyQmluc1tvZmZzZXRdLnggPSBjb2xzW3B4XS54O1xyXG4gICAgICBnYXRoZXJCaW5zW29mZnNldF0ueSA9IHJvd3NbcHldLnk7XHJcbiAgICAgIGdhdGhlckJpbnNbb2Zmc2V0XS53aWR0aCA9IGNvbHNbcHhdLndpZHRoO1xyXG4gICAgICBnYXRoZXJCaW5zW29mZnNldF0uaGVpZ2h0ID0gcm93c1tweV0uaGVpZ2h0O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gVGltZSB0byBkbyBpbi1jZWxsIGxheW91dFxyXG4gIGdhdGhlckJpbnMuZm9yRWFjaCh2ID0+IHtcclxuXHJcbiAgICAvLyBTb3J0IHRoZSBkYXRhIGJhc2VkIG9uIGNvbG9yXHJcbiAgICBpZiAoY1NvcnQpIHYuc29ydCgoZDEsIGQyKSA9PiBjU29ydCAqIGNtcChjKGQxKSwgYyhkMikpKTtcclxuXHJcbiAgICAvLyBQb3NpdGlvbiB0cmFja2luZ1xyXG4gICAgbGV0IHB4ID0gaXRlbVNpemUgLyAyLjA7XHJcbiAgICBsZXQgcHkgPSB2LmhlaWdodCAtIGl0ZW1TaXplIC8gMi4wO1xyXG5cclxuICAgIC8vIFN0ZXAgdGhyb3VnaCBhbGwgb2YgdGhlIHBvaW50c1xyXG4gICAgdi5mb3JFYWNoKGQgPT4ge1xyXG4gICAgICBkLmN4ID0gcHg7XHJcbiAgICAgIGQuY3kgPSBweTtcclxuICAgICAgZC5yID0gaXRlbVNpemUgLyAyLjA7XHJcbiAgICAgIHB4ICs9IGl0ZW1TaXplO1xyXG4gICAgICBpZiAocHggPiB2LndpZHRoKSB7XHJcbiAgICAgICAgcHggPSBpdGVtU2l6ZSAvIDIuMDtcclxuICAgICAgICBweSAtPSBpdGVtU2l6ZTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IEMgPSBkMy5tYXAoZGF0YSwgYyk7XHJcbiAgY29uc3QgY1NjYWxlID0gZ2F0aGVyQ29sb3IoQyk7XHJcblxyXG4gIGNvbnN0IHN2ZyA9IGQzLmNyZWF0ZShcInN2Z1wiKVxyXG4gICAgICAuYXR0cihcIndpZHRoXCIsIHdpZHRoKVxyXG4gICAgICAuYXR0cihcImhlaWdodFwiLCBoZWlnaHQpXHJcbiAgICAgIC5hdHRyKFwiZmlsbFwiLCAnbm9uZScpXHJcbiAgICAgIC5hdHRyKFwidmlld0JveFwiLCBbMCwgMCwgd2lkdGgsIGhlaWdodF0pXHJcbiAgICAgIC5hdHRyKFwic3R5bGVcIiwgXCJtYXgtd2lkdGg6IDEwMCU7IGhlaWdodDogYXV0bzsgaGVpZ2h0OiBpbnRyaW5zaWM7XCIpO1xyXG5cclxuICBjb25zdCBjaGFydCA9IHN2Zy5hcHBlbmQoXCJnXCIpXHJcbiAgICAgIC5hdHRyKFwic3Ryb2tlXCIsIHN0cm9rZSlcclxuICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZCA9PiBgdHJhbnNsYXRlKCR7bWFyZ2luTGVmdH0sJHttYXJnaW5Ub3B9KWApXHJcbiAgICAgIC5hdHRyKFwiZmlsbFwiLCAnbm9uZScpXHJcbiAgICAgIC5hdHRyKFwic3Ryb2tlLXdpZHRoXCIsICcxLjAnKTtcclxuICBcclxuICBjb25zdCBncm91cHMgPSBjaGFydC5hcHBlbmQoXCJnXCIpXHJcbiAgICAuc2VsZWN0QWxsKFwiZ1wiKVxyXG4gICAgICAuZGF0YShnYXRoZXJCaW5zKVxyXG4gICAgLmpvaW4oXCJnXCIpXHJcbiAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGQgPT4gYHRyYW5zbGF0ZSgke2QueH0sJHtkLnl9KWApO1xyXG5cclxuICBsZXQgcG9pbnRzID0gZ3JvdXBzLnNlbGVjdEFsbChcImNpcmNsZVwiKVxyXG4gICAgLmRhdGEoZCA9PiBkKVxyXG4gICAgLmpvaW4oXCJjaXJjbGVcIilcclxuICAgICAgLmF0dHIoXCJjeFwiLCBkID0+IGQuY3gpXHJcbiAgICAgIC5hdHRyKFwiY3lcIiwgZCA9PiBkLmN5KVxyXG4gICAgICAuYXR0cihcInJcIiwgZCA9PiBkLnIpXHJcbiAgICAgIC5hdHRyKFwiZmlsbFwiLCBkID0+IGNTY2FsZShjKGQpKSk7XHJcblxyXG4gIGxldCBheGlzID0gc3ZnLmFwcGVuZCgncGF0aCcpXHJcbiAgICAuYXR0cignc3Ryb2tlJywgJ2JsYWNrJylcclxuICAgIC5hdHRyKCdmaWxsJywgJ25vbmUnKVxyXG4gICAgLmF0dHIoJ2QnLCBgTSR7bWFyZ2luTGVmdH0sJHttYXJnaW5Ub3B9ViR7aGVpZ2h0IC0gbWFyZ2luQm90dG9tfUgke3dpZHRoIC0gbWFyZ2luUmlnaHR9YCk7XHJcblxyXG4gIGxldCBob3J6QmFuZHMgPSBzdmcuYXBwZW5kKCdnJylcclxuICAgIC5zZWxlY3RBbGwoJ3BhdGgnKVxyXG4gICAgICAuZGF0YShjb2xzKVxyXG4gICAgLmpvaW4oJ3BhdGgnKVxyXG4gICAgICAuYXR0cignc3Ryb2tlJywgJ2JsYWNrJylcclxuICAgICAgLmF0dHIoJ3N0cm9rZS13aWR0aCcsIDAuNSlcclxuICAgICAgLmF0dHIoJ2QnLCBkID0+IGBNJHtkLnggKyBtYXJnaW5MZWZ0ICsgZC53aWR0aH0sJHtoZWlnaHQgLSBtYXJnaW5Cb3R0b219djEwaCR7LWQud2lkdGh9YClcclxuXHJcbiAgbGV0IGhvcnpMYWJlbHMgPSBzdmcuYXBwZW5kKCdnJylcclxuICAgIC5zZWxlY3RBbGwoJ3RleHQnKVxyXG4gICAgICAuZGF0YShjb2xzKVxyXG4gICAgLmpvaW4oJ3RleHQnKVxyXG4gICAgICAudGV4dChkID0+IGQueDEpXHJcbiAgICAgIC5hdHRyKFwidGV4dC1hbmNob3JcIiwgXCJlbmRcIilcclxuICAgICAgLmF0dHIoJ2ZpbGwnLCAnYmxhY2snKVxyXG4gICAgICAuYXR0cigneCcsIGQgPT4gZC54ICsgbWFyZ2luTGVmdCArIGQud2lkdGgpXHJcbiAgICAgIC5hdHRyKCd5JywgaGVpZ2h0IC0gMi4wKTtcclxuXHJcbiAgbGV0IHZlcnRCYW5kcyA9IHN2Zy5hcHBlbmQoJ2cnKVxyXG4gICAgLnNlbGVjdEFsbCgncGF0aCcpXHJcbiAgICAgIC5kYXRhKHJvd3MpXHJcbiAgICAuam9pbigncGF0aCcpXHJcbiAgICAgIC5hdHRyKCdzdHJva2UnLCAnYmxhY2snKVxyXG4gICAgICAuYXR0cignc3Ryb2tlLXdpZHRoJywgMC41KVxyXG4gICAgICAuYXR0cignZCcsIGQgPT4gYE0ke21hcmdpbkxlZnR9LCR7ZC55ICsgbWFyZ2luVG9wfWgtMTB2JHtkLmhlaWdodH1gKTtcclxuXHJcbiAgbGV0IHZlcnRMYWJlbHMgPSBzdmcuYXBwZW5kKCdnJylcclxuICAgIC5zZWxlY3RBbGwoJ3RleHQnKVxyXG4gICAgICAuZGF0YShyb3dzKVxyXG4gICAgLmpvaW4oJ3RleHQnKVxyXG4gICAgICAudGV4dChkID0+IGQueTEpXHJcbiAgICAgIC5hdHRyKFwidGV4dC1hbmNob3JcIiwgXCJzdGFydFwiKVxyXG4gICAgICAuYXR0cignZmlsbCcsICdibGFjaycpXHJcbiAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCBkID0+IGB0cmFuc2xhdGUoMiwke2QueSArIG1hcmdpblRvcH0pcm90YXRlKDkwKWApO1xyXG5cclxuICByZXR1cm4gc3ZnLm5vZGUoKTtcclxufVxyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3Byb2JsZW0nKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnaml0dGVyVmFsdWUnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgneEF4aXMnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgneUF4aXMnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnY29sb3InKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnc29ydGluZycpIn1dfQ==
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../..";
window._ojs.paths.runtimeToRoot = "../../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb12" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Gatherplot: A Non-Overlapping Scatterplot"</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: Deokgun Park</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">    orcid: 0000-0003-0054-9944</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">    email: deokgun.park@uta.edu</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliations:</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">      - name: University of Texas at Arlington</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">        city: Arlington</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">        state: TX</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">        country: USA</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: Sung-Hee Kim</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co">    orcid: 0000-0002-9716-8349</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co">    email: sungheekim02@gmail.com</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliations:</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co">      - name: Dong-eui University</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co">        city: Busan</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co">        country: Republic of Korea</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: Niklas Elmqvist</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co">    orcid: 0000-0001-5805-5301</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="co">    email: elm@cs.au.dk</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliations:</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="co">      - name: Aarhus University</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="co">        city: Aarhus</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="co">        country: Denmark</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> bibliography.bib</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="co">    echo: false</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="co">    keep-hidden: true</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-responsive: true</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="co">    citations-hover: false</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="co">    footnotes-hover: false</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="co">    crossrefs-hover: false</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: accessible.scss</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>::: {.callout-important appearance="simple"}</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a><span class="fu">## Under Review {.unnumbered}</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>This paper is under review on the experimental track of the <span class="co">[</span><span class="ot">Journal of Visualization and Interaction</span><span class="co">](https://www.journalovi.org/)</span>.</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>::: {.callout-note appearance="simple" icon=false collapse=false}</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a><span class="fu">## Abstract {.unnumbered}</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Introduction</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>Scatterplots are a common tool for exploring multidimensional datasets, especially in the form of scatterplot matrices (SPLOMs).</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>However, scatterplots suffer from overplotting when categorical variables are mapped to one or two axes, or the same continuous variable is used for both axes.</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>Previous methods such as histograms or violin plots use aggregation, which makes brushing and linking difficult.</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Conclusion</span></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>We propose gatherplots, an extension of scatterplots to manage the overplotting problem.</span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>Gatherplots are a form of *unit visualization*, which avoid aggregation and maintain the identity of individual objects to ease visual perception.</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>In gatherplots, every visual mark that maps to the same position coalesces to form a packed entity, thereby making it easier to see the overview of data groupings.</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>The size and aspect ratio of marks can also be changed dynamically to make it easier to compare the composition of different groups.</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>In the case of a categorical variable vs. a categorical variable, we propose a heuristic to decide bin sizes for optimal space usage.</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>Results from a crowdsourced user study show that gatherplots enable people to assess data distribution more correctly than when using jittered scatterplots.</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Materials</span></span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>Source code for Gatherplots can be found at <span class="co">[</span><span class="ot">https://github.com/intuinno/gatherplot</span><span class="co">](https://github.com/intuinno/gatherplot)</span>.</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>Research materials associated with the crowdsourced user study can be found on OSF at <span class="co">[</span><span class="ot">https://osf.io/bk9cx/</span><span class="co">](https://osf.io/bk9cx/)</span>.</span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Data Collection</span></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>We conducted a crowdsourced user study on <span class="co">[</span><span class="ot">Amazon Mechanical Turk</span><span class="co">](https://www.mturk.com/)</span> involving participants drawn from the general population.</span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>We collected completion time, accuracy, and confidence for five different retrieval, ranking, and comparison tasks under four conditions: scatterplots with jittering, gatherplots with absolute mode, gatherplots with normalized mode, and gatherplots with a toggle to switch between absolute and normalized mode.</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Data Analysis</span></span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>Data collected from the crowdsourced survey were analyzed with respect to the accuracy (correct or incorrect), time spent, and confidence of estimation.</span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>Based on our hypotheses, we analyzed the different modes of layout for each type of question: retrieve value, absolute value task, and relative value task.</span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Analysis Results</span></span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>Gatherplots outperform jittering for accuracy as well as for the subjective confidence measure.</span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Implementation</span></span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a>We implemented a web-based demonstration of Gatherplots using <span class="co">[</span><span class="ot">D3</span><span class="co">](https://d3js.org/)</span> as well as using <span class="co">[</span><span class="ot">Observable JS</span><span class="co">](https://observablehq.com/)</span> in this article.</span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Demonstration</span></span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a>Beyond the embedded demonstration in this article, you can also find a live demo of Gatherplots at <span class="co">[</span><span class="ot">https://gatherplot.firebaseapp.com/</span><span class="co">](https://gatherplot.firebaseapp.com/)</span>.</span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Teaser --&gt;</span></span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a>::: {#fig-teaser layout-ncol=1}</span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a><span class="al">![Cylinders vs. MPG.](figures/teaser-1.svg)</span>{#fig-teaser1 fig-alt="Gatherplot showing MPG on the Y axis and Cylinders on the X axis for a car dataset of some 400 datapoints. Color is used to show three different origins: US (blue), Europe (orange), and Asia (green). The data is gathered in regular grids for each of the cylinder values clearly showing the distribution: four-cylinder cars have fairly uniform gas mileage, whereas six and eight-cylinder cars have lower gas mileage." .accessible-fig}</span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a><span class="al">![Cylinders vs. Origin.](figures/teaser-2.svg)</span>{#fig-teaser2 fig-alt="Gatherplot showing Origin on the Y axis and Cylinders on the X axis for a car dataset of some 400 datapoints. A blue-white color scale is used to show gas mileage. The data is gathered in regular grids for each of the three origins and four cylinder values (4, 5, 6, 8). The grid cells show the data distrbution: all eight cylinder cars are from the U.S., and high cylinder count seems to lead to lower gas mileage." .accessible-fig}</span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a><span class="al">![MPG vs. MPG.](figures/teaser-3.svg)</span>{#fig-teaser3 fig-alt="Gatherplot showing MPG on both the Y and X axis for a car dataset of some 400 datapoints. olor is used to show three different origins: US (blue), Europe (orange), and Asia (green). Because both X and Y axes use the same categorical mapping, the data is gathered together without overplotting to show that there are many cars with low gas mileage, and most of the low-mileage cars are from the United States." .accessible-fig}</span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a>**Cars dataset.**</span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a>Gatherplots showing a dataset related to cars, yielding overplotting in normal scatterplots.</span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a>The gatherplot in <span class="co">[</span><span class="ot">-@fig-teaser1</span><span class="co">]</span> shows Cylinders (categorical) vs. MPG (continuous), highlighting the overall distribution of MPG values of cars with different cylinders.</span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a>The brackets on the X-axis are used to indicate that the interval within the brackets represent the same value in the data.</span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a>The gatherplot in <span class="co">[</span><span class="ot">-@fig-teaser2</span><span class="co">]</span> shows <span class="in">`Cylinders`</span> (categorical) vs. <span class="in">`Origin`</span> (categorical), partitioning the graphical axes into intervals and packing points into groups for each interval. </span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a>In <span class="co">[</span><span class="ot">-@fig-teaser3</span><span class="co">]</span>, both X-axis and Y-axis show the same continuous variable (MPG).</span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a>All these cases would have caused overplotting for a scatterplot, resulting in dot-shaped or line-shaped point patterns where individual points cannot be identified.</span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ========================================================================== --&gt;</span></span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction {#intro}</span></span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true" tabindex="-1"></a>Scatterplots---one of the most common types of statistical graphics <span class="co">[</span><span class="ot">@Cleveland1988; @Elmqvist2008; @Utts1996</span><span class="co">]</span>---are often used to visualize two continuous variables using visual marks mapped to a two-dimensional Cartesian space, where the color, size, and shape of the marks can represent additional dimensions.</span>
<span id="cb12-114"><a href="#cb12-114" aria-hidden="true" tabindex="-1"></a>It can also be used for exploring multidimensional datasets in the form of scatterplot matrices (SPLOM), where all the possible</span>
<span id="cb12-115"><a href="#cb12-115" aria-hidden="true" tabindex="-1"></a>combinations of axes are presented in table form.</span>
<span id="cb12-116"><a href="#cb12-116" aria-hidden="true" tabindex="-1"></a>However, scatterplots are so-called *overlapping visualizations* <span class="co">[</span><span class="ot">@Fekete2002</span><span class="co">]</span> in that the visual marks representing individual data points may begin to overlap each other in screen space in situations when the marks are large, when there is insufficient screen space to fit all the data at the desired resolution, or simply when several data points share the same value.</span>
<span id="cb12-117"><a href="#cb12-117" aria-hidden="true" tabindex="-1"></a>In fact, realistic multidimensional datasets often contain categorical variables, such as nominal variables or discrete data dimensions with a small domain, which lead to many data points being mapped to the exact same screen position.</span>
<span id="cb12-118"><a href="#cb12-118" aria-hidden="true" tabindex="-1"></a>This kind of overlap is known as *overplotting* (or *overdrawing*) in visualization, and is problematic because it may lead to data points being entirely hidden by other points, which in turn may lead to the viewer making incorrect assessments of the data.</span>
<span id="cb12-119"><a href="#cb12-119" aria-hidden="true" tabindex="-1"></a>As can be seen in @fig-scatter-problems, there are three situations for mapping variables to axes in scatterplots when overplotting is inevitable:</span>
<span id="cb12-120"><a href="#cb12-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-121"><a href="#cb12-121" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Plotting **categorical vs.\ continuous variables** gives rise to line patterns (@fig-scatter-problems(a));</span>
<span id="cb12-122"><a href="#cb12-122" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Plotting **categorical vs.\ categorical variables** gives rise to single dot patterns (@fig-scatter-problems(b)); and</span>
<span id="cb12-123"><a href="#cb12-123" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Plotting the **same continuous variable on both axes** gives rise to diagonal line patterns (@fig-scatter-problems(c)).</span>
<span id="cb12-124"><a href="#cb12-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-125"><a href="#cb12-125" aria-hidden="true" tabindex="-1"></a>::: {#fig-scatter-problems}</span>
<span id="cb12-128"><a href="#cb12-128" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb12-129"><a href="#cb12-129" aria-hidden="true" tabindex="-1"></a><span class="in">//| panel: input</span></span>
<span id="cb12-130"><a href="#cb12-130" aria-hidden="true" tabindex="-1"></a><span class="in">viewof problem = Inputs.radio(problems, {format: x =&gt; x.name, value: problems.find(t =&gt; t.name === "(a) Line patterns")});</span></span>
<span id="cb12-131"><a href="#cb12-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-132"><a href="#cb12-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-135"><a href="#cb12-135" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb12-136"><a href="#cb12-136" aria-hidden="true" tabindex="-1"></a><span class="in">problems = [</span></span>
<span id="cb12-137"><a href="#cb12-137" aria-hidden="true" tabindex="-1"></a><span class="in">  {name: '(a) Line patterns', carX: 'Cylinders', carY: 'MPG'}, </span></span>
<span id="cb12-138"><a href="#cb12-138" aria-hidden="true" tabindex="-1"></a><span class="in">  {name: '(b) Dot patterns', carX: 'Cylinders', carY: 'Cylinders'},</span></span>
<span id="cb12-139"><a href="#cb12-139" aria-hidden="true" tabindex="-1"></a><span class="in">  {name: '(c) Diagonal patterns', carX: 'MPG', carY: 'MPG'}</span></span>
<span id="cb12-140"><a href="#cb12-140" aria-hidden="true" tabindex="-1"></a><span class="in">];</span></span>
<span id="cb12-141"><a href="#cb12-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-142"><a href="#cb12-142" aria-hidden="true" tabindex="-1"></a><span class="in">Plot.plot({</span></span>
<span id="cb12-143"><a href="#cb12-143" aria-hidden="true" tabindex="-1"></a><span class="in">  inset: 8,</span></span>
<span id="cb12-144"><a href="#cb12-144" aria-hidden="true" tabindex="-1"></a><span class="in">  grid: true,</span></span>
<span id="cb12-145"><a href="#cb12-145" aria-hidden="true" tabindex="-1"></a><span class="in">  color: {</span></span>
<span id="cb12-146"><a href="#cb12-146" aria-hidden="true" tabindex="-1"></a><span class="in">    legend: true,</span></span>
<span id="cb12-147"><a href="#cb12-147" aria-hidden="true" tabindex="-1"></a><span class="in">  },</span></span>
<span id="cb12-148"><a href="#cb12-148" aria-hidden="true" tabindex="-1"></a><span class="in">  marks: [</span></span>
<span id="cb12-149"><a href="#cb12-149" aria-hidden="true" tabindex="-1"></a><span class="in">    Plot.dot(cars, {x: problem.carX, y: problem.carY, r: 8 })</span></span>
<span id="cb12-150"><a href="#cb12-150" aria-hidden="true" tabindex="-1"></a><span class="in">  ]</span></span>
<span id="cb12-151"><a href="#cb12-151" aria-hidden="true" tabindex="-1"></a><span class="in">});</span></span>
<span id="cb12-152"><a href="#cb12-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-153"><a href="#cb12-153" aria-hidden="true" tabindex="-1"></a>**Scatterplot problems.**</span>
<span id="cb12-154"><a href="#cb12-154" aria-hidden="true" tabindex="-1"></a>Interactive scatterplot visualizing a car dataset with one continuous variable <span class="in">`MPG`</span> and one categorical variable <span class="in">`Cylinders`</span> showing limitations of scatterplots when plotting categorical variables on one or both axes.</span>
<span id="cb12-155"><a href="#cb12-155" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-156"><a href="#cb12-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-157"><a href="#cb12-157" aria-hidden="true" tabindex="-1"></a>Several approaches have been proposed to address this problem <span class="co">[</span><span class="ot">@Ellis2007</span><span class="co">]</span>, the most prominent being transparency, jittering, and clustering techniques.</span>
<span id="cb12-158"><a href="#cb12-158" aria-hidden="true" tabindex="-1"></a>The first, changing transparency, does not so much address the problem as sidestep it by making the visual marks semi-transparent so that an accumulation of overlapping points are still visible. </span>
<span id="cb12-159"><a href="#cb12-159" aria-hidden="true" tabindex="-1"></a>However, this does not scale for large datasets, and also causes blending issues if color is used to encode additional variables.</span>
<span id="cb12-160"><a href="#cb12-160" aria-hidden="true" tabindex="-1"></a>Jittering perturbs visual marks using a random displacement <span class="co">[</span><span class="ot">@Trutschl2003</span><span class="co">]</span> so that no mark falls on the exact same screen location as any other mark, but this approach is still prone to overplotting for large data.</span>
<span id="cb12-161"><a href="#cb12-161" aria-hidden="true" tabindex="-1"></a>It also introduces uncertainty that is not aptly communicated by the scatterplot since marks will no longer be placed at their true location on the Cartesian space.</span>
<span id="cb12-162"><a href="#cb12-162" aria-hidden="true" tabindex="-1"></a>Other approaches still attempt to organize overlapping marks into visual groups that summarize their distribution, such as histograms, violin plots, and kernel density estimation (KDE) plots <span class="co">[</span><span class="ot">@Fua1999; @Mayorga2013; @Im2013</span><span class="co">]</span>.</span>
<span id="cb12-163"><a href="#cb12-163" aria-hidden="true" tabindex="-1"></a>However, this comes at the cost of losing the identity of individual points, which can be problematic when filtering or searching; e.g, brushing data points is difficult in histograms <span class="co">[</span><span class="ot">@Im2013</span><span class="co">]</span>.</span>
<span id="cb12-164"><a href="#cb12-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-165"><a href="#cb12-165" aria-hidden="true" tabindex="-1"></a>In this paper, we propose the concept of *gathering* as an alternative to scattering and jittering, and then show how we can use this visual transformation to define a novel visualization technique called a *gatherplot*.</span>
<span id="cb12-166"><a href="#cb12-166" aria-hidden="true" tabindex="-1"></a>The gatherplot is an instance of a recently recognized family of visualization techniques called *unit visualizations* <span class="co">[</span><span class="ot">@Park2018</span><span class="co">]</span> that maintain a strict mapping between every data item and its unique visual mark, improving the understandability over aggregated representations as well as enabling more natural interactions.</span>
<span id="cb12-167"><a href="#cb12-167" aria-hidden="true" tabindex="-1"></a>Gathering is a generalization of the linear mapping used by scatterplots, and works by first partitioning the graphical axis into segments based on the data dimension and then organizing points into *packed groups* for each segment to avoid overplotting.</span>
<span id="cb12-168"><a href="#cb12-168" aria-hidden="true" tabindex="-1"></a>This means that the gather operation relaxes the continuous spatial mapping commonly used for a graphical axis; instead, each discrete segment occupies a certain interval of screen space that maps to the same data value.</span>
<span id="cb12-169"><a href="#cb12-169" aria-hidden="true" tabindex="-1"></a>This is communicated using graphical brackets on the axis that shows the value or interval for each segment (@fig-teaser(b)).</span>
<span id="cb12-170"><a href="#cb12-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-171"><a href="#cb12-171" aria-hidden="true" tabindex="-1"></a>The contributions of our paper are the following: (1) the gatherplot technique that applies the gather operation to scatterplots to mitigate overplotting; and (2) results from a crowdsourced graphical perception study on the effectiveness of gatherplots.</span>
<span id="cb12-172"><a href="#cb12-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-173"><a href="#cb12-173" aria-hidden="true" tabindex="-1"></a>Next in this paper, we review the literature on statistical graphics and overplotting.</span>
<span id="cb12-174"><a href="#cb12-174" aria-hidden="true" tabindex="-1"></a>We then present the gather operation and use it to define gatherplots.</span>
<span id="cb12-175"><a href="#cb12-175" aria-hidden="true" tabindex="-1"></a>We describe our implementation, followed by our crowdsourced evaluation.</span>
<span id="cb12-176"><a href="#cb12-176" aria-hidden="true" tabindex="-1"></a>We finally describe the GatherLens technique.</span>
<span id="cb12-177"><a href="#cb12-177" aria-hidden="true" tabindex="-1"></a>We close with conclusions and our future plans.</span>
<span id="cb12-178"><a href="#cb12-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-179"><a href="#cb12-179" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ========================================================================== --&gt;</span></span>
<span id="cb12-180"><a href="#cb12-180" aria-hidden="true" tabindex="-1"></a><span class="fu">## Background</span></span>
<span id="cb12-181"><a href="#cb12-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-182"><a href="#cb12-182" aria-hidden="true" tabindex="-1"></a>Scatterplots are classic statistical data graphics with many design variations to address challenges of scale, complexity, and specific tasks <span class="co">[</span><span class="ot">@DBLP:journals/tvcg/SarikayaG18</span><span class="co">]</span>.</span>
<span id="cb12-183"><a href="#cb12-183" aria-hidden="true" tabindex="-1"></a>Our goal with gatherplots is to generalize scatterplots to a representation that maintains its simplicity and familiarity while eliminating overplotting.</span>
<span id="cb12-184"><a href="#cb12-184" aria-hidden="true" tabindex="-1"></a>Partial or complete overplotting generally leads to visual clutter.</span>
<span id="cb12-185"><a href="#cb12-185" aria-hidden="true" tabindex="-1"></a>Ellis and Dix <span class="co">[</span><span class="ot">@Ellis2007</span><span class="co">]</span> survey the literature and derive a general approach to reduce clutter.</span>
<span id="cb12-186"><a href="#cb12-186" aria-hidden="true" tabindex="-1"></a>According to their treatment, there are three ways to reduce clutter in a visualization: by changing the visual appearance, by distorting visual space, or by presenting data over time.</span>
<span id="cb12-187"><a href="#cb12-187" aria-hidden="true" tabindex="-1"></a>Some trivial but impractical mechanisms they list include decreasing mark size, increasing display space, or animating the data.</span>
<span id="cb12-188"><a href="#cb12-188" aria-hidden="true" tabindex="-1"></a>Below we review more practical approaches based on appearance and distortion.</span>
<span id="cb12-189"><a href="#cb12-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-190"><a href="#cb12-190" aria-hidden="true" tabindex="-1"></a><span class="fu">### Appearance-based Methods</span></span>
<span id="cb12-191"><a href="#cb12-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-192"><a href="#cb12-192" aria-hidden="true" tabindex="-1"></a>Practical appearance-based approaches to mitigate overplotting include transparency, sampling, kernel density estimation (KDE), and aggregation.</span>
<span id="cb12-193"><a href="#cb12-193" aria-hidden="true" tabindex="-1"></a>Transparency changes the opacity of the visual marks, and has been shown to convey overlap for up to five occurrences <span class="co">[</span><span class="ot">@Zhai1996</span><span class="co">]</span>.</span>
<span id="cb12-194"><a href="#cb12-194" aria-hidden="true" tabindex="-1"></a>However, there is still an upper limit for how much overlap is perceptible to the user, and the blending caused by overlapping marks of different colors makes identifying colors difficult.</span>
<span id="cb12-195"><a href="#cb12-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-196"><a href="#cb12-196" aria-hidden="true" tabindex="-1"></a>*Sampling* uses stochastic methods to statistically reduce the data size to visualize <span class="co">[</span><span class="ot">@Dix2002</span><span class="co">]</span>.</span>
<span id="cb12-197"><a href="#cb12-197" aria-hidden="true" tabindex="-1"></a>This may reduce the amount of overplotting, but since the sampling is random, it cannot be reliably eliminated.</span>
<span id="cb12-198"><a href="#cb12-198" aria-hidden="true" tabindex="-1"></a>Furthermore, one of the core strengths of a scatterplot is its ability to show outliers effectively, whereas sampling will likely eliminate all outliers (due to the intrinsic nature of an outlier).</span>
<span id="cb12-199"><a href="#cb12-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-200"><a href="#cb12-200" aria-hidden="true" tabindex="-1"></a>Aggregation methods can also mitigate overplotting.</span>
<span id="cb12-201"><a href="#cb12-201" aria-hidden="true" tabindex="-1"></a>KDE <span class="co">[</span><span class="ot">@Silverman1986</span><span class="co">]</span> and other binned aggregations <span class="co">[</span><span class="ot">@Elmqvist2010; @Fua1999; @Mayorga2013; @Im2013</span><span class="co">]</span> replace a cluster of marks with a single entity that has a distinct visual representation. </span>
<span id="cb12-202"><a href="#cb12-202" aria-hidden="true" tabindex="-1"></a>Similarly, splatterplots <span class="co">[</span><span class="ot">@Mayorga2013</span><span class="co">]</span> combine individual marks with aggregated entities, using marks to show outliers and aggregated entities to show the general trends.</span>
<span id="cb12-203"><a href="#cb12-203" aria-hidden="true" tabindex="-1"></a>While aggregation techniques are effective against overplotting for continuous variables, they fare poorly for categorical ones.</span>
<span id="cb12-204"><a href="#cb12-204" aria-hidden="true" tabindex="-1"></a>Therefore, the generalized plot matrices (GPLOMs) <span class="co">[</span><span class="ot">@Im2013</span><span class="co">]</span> were proposed to solve this particular problem by adopting non-homogeneous plots into a matrix.</span>
<span id="cb12-205"><a href="#cb12-205" aria-hidden="true" tabindex="-1"></a>The technique uses a histogram for categorical vs. continuous variables, and a treemap for categorical vs. categorical variables.</span>
<span id="cb12-206"><a href="#cb12-206" aria-hidden="true" tabindex="-1"></a>While effective in providing overview, aggregated techniques sacrifice some compatibility with scatterplots since they no longer maintain object identity, meaning that each visual mark no longer represents a single data point.  </span>
<span id="cb12-207"><a href="#cb12-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-208"><a href="#cb12-208" aria-hidden="true" tabindex="-1"></a>::: {#fig-jittering}</span>
<span id="cb12-211"><a href="#cb12-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb12-212"><a href="#cb12-212" aria-hidden="true" tabindex="-1"></a><span class="in">//| panel: input</span></span>
<span id="cb12-213"><a href="#cb12-213" aria-hidden="true" tabindex="-1"></a><span class="in">viewof jitterValue = Inputs.range([0, 32], {value: 16, step: 1.0, label: "Amount of jitter"});</span></span>
<span id="cb12-214"><a href="#cb12-214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-215"><a href="#cb12-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-218"><a href="#cb12-218" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb12-219"><a href="#cb12-219" aria-hidden="true" tabindex="-1"></a><span class="in">jitter = Scatterplot(cars, {</span></span>
<span id="cb12-220"><a href="#cb12-220" aria-hidden="true" tabindex="-1"></a><span class="in">  x: d =&gt; d['Cylinders'],</span></span>
<span id="cb12-221"><a href="#cb12-221" aria-hidden="true" tabindex="-1"></a><span class="in">  y: d =&gt; d['Displacement'],</span></span>
<span id="cb12-222"><a href="#cb12-222" aria-hidden="true" tabindex="-1"></a><span class="in">  c: d =&gt; d['Origin'],</span></span>
<span id="cb12-223"><a href="#cb12-223" aria-hidden="true" tabindex="-1"></a><span class="in">  jitter: () =&gt; (Math.random() -0.5) * jitterValue,</span></span>
<span id="cb12-224"><a href="#cb12-224" aria-hidden="true" tabindex="-1"></a><span class="in">  width,</span></span>
<span id="cb12-225"><a href="#cb12-225" aria-hidden="true" tabindex="-1"></a><span class="in">  height: 600</span></span>
<span id="cb12-226"><a href="#cb12-226" aria-hidden="true" tabindex="-1"></a><span class="in">});</span></span>
<span id="cb12-227"><a href="#cb12-227" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-228"><a href="#cb12-228" aria-hidden="true" tabindex="-1"></a>**Interactive jittering scatterplots.**</span>
<span id="cb12-229"><a href="#cb12-229" aria-hidden="true" tabindex="-1"></a>Jittering (i.e., randomly displacing) the points in a scatterplot to reduce overplotting caused by categorical axes; in this case, the horizontal axis is mapped to <span class="in">`Cylinders`</span> and the vertical to <span class="in">`Displacement`</span> in a car dataset.</span>
<span id="cb12-230"><a href="#cb12-230" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-231"><a href="#cb12-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-232"><a href="#cb12-232" aria-hidden="true" tabindex="-1"></a><span class="fu">### Distortion-based Methods</span></span>
<span id="cb12-233"><a href="#cb12-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-234"><a href="#cb12-234" aria-hidden="true" tabindex="-1"></a>Distortion-based techniques avoid overplotting by changing the spatial mapping of the space and have the advantage to keep the identity of individual data points.</span>
<span id="cb12-235"><a href="#cb12-235" aria-hidden="true" tabindex="-1"></a>The canonical distortion technique is *jittering*, where a random displacement is used to subtly modify the exact screen space position of a data point (@fig-jittering).</span>
<span id="cb12-236"><a href="#cb12-236" aria-hidden="true" tabindex="-1"></a>This has the effect of spreading data points apart so that they are easier to distinguish.</span>
<span id="cb12-237"><a href="#cb12-237" aria-hidden="true" tabindex="-1"></a>However, naïve jittering mechanisms apply the displacement indiscriminately to all data points, regardless of whether they are overlapping or not.</span>
<span id="cb12-238"><a href="#cb12-238" aria-hidden="true" tabindex="-1"></a>This has the drawback of distorting points away from their true location on the visual canvas, and still does not completely eliminate overplotting.</span>
<span id="cb12-239"><a href="#cb12-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-240"><a href="#cb12-240" aria-hidden="true" tabindex="-1"></a>Bezerianos et al. <span class="co">[</span><span class="ot">-@Bezerianos2010</span><span class="co">]</span> use a more structured approach to displacement, where overlapping marks are organized onto the perimeter of a circle.</span>
<span id="cb12-241"><a href="#cb12-241" aria-hidden="true" tabindex="-1"></a>The circle is grown to a radius so that all marks fit, which means that its size is also an indication of the number of grouped points.</span>
<span id="cb12-242"><a href="#cb12-242" aria-hidden="true" tabindex="-1"></a>However, this mechanism still introduces uncertainty in the spatial mapping, and it is also not clear how well it scales for very dense data, as this can lead to a circle of arbitrarily large size.</span>
<span id="cb12-243"><a href="#cb12-243" aria-hidden="true" tabindex="-1"></a>Nevertheless, the approach is a good example of how deterministic displacement can be used to great effect for eliminating overplotting.</span>
<span id="cb12-244"><a href="#cb12-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-245"><a href="#cb12-245" aria-hidden="true" tabindex="-1"></a>Trutschl et al. <span class="co">[</span><span class="ot">-@Trutschl2003</span><span class="co">]</span> propose a deterministic displacement ("smart jittering") that adds meaning to the jittered position based on clustering results.</span>
<span id="cb12-246"><a href="#cb12-246" aria-hidden="true" tabindex="-1"></a>This makes it easier to understand the resulting spatial display.</span>
<span id="cb12-247"><a href="#cb12-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-248"><a href="#cb12-248" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data-aware Methods</span></span>
<span id="cb12-249"><a href="#cb12-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-250"><a href="#cb12-250" aria-hidden="true" tabindex="-1"></a>The most advanced and effective overplotting mitigations are data-aware, in that they determine instances of overplotting in a chart.</span>
<span id="cb12-251"><a href="#cb12-251" aria-hidden="true" tabindex="-1"></a>As a case in point, recent work by Chen et al. <span class="co">[</span><span class="ot">-@Chen2018</span><span class="co">]</span> use animation to cycle the depth value of overlapping points in a scatterplot over time to ensure that every point is shown on top at some point in the rotation.</span>
<span id="cb12-252"><a href="#cb12-252" aria-hidden="true" tabindex="-1"></a>This means that overplotting is alleviated by the notion of "guaranteed visibility over time" <span class="co">[</span><span class="ot">@Munzner2003</span><span class="co">]</span> presented by Munzner et al.</span>
<span id="cb12-253"><a href="#cb12-253" aria-hidden="true" tabindex="-1"></a>However, a common criticism for techniques designed to mitigate overplotting is that often do not scale to large dataset scales.</span>
<span id="cb12-254"><a href="#cb12-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-255"><a href="#cb12-255" aria-hidden="true" tabindex="-1"></a>Shneiderman et al.<span class="co">[</span><span class="ot">-@Shneiderman2000</span><span class="co">]</span> propose a data-aware structured displacement approach called *hieraxes*, which combines hierarchical browsing with two-dimensional scatterplots.</span>
<span id="cb12-256"><a href="#cb12-256" aria-hidden="true" tabindex="-1"></a>In hieraxes, a two-dimensional visual space is subdivided into rectangular segments for different categories in the data, and points are then coalesced into stacked groups inside the different segments.</span>
<span id="cb12-257"><a href="#cb12-257" aria-hidden="true" tabindex="-1"></a>This work inspired gatherplots, which refines the layout and design of hieraxes further.</span>
<span id="cb12-258"><a href="#cb12-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-259"><a href="#cb12-259" aria-hidden="true" tabindex="-1"></a>Microsoft's SandDance <span class="co">[</span><span class="ot">@Sanddance</span><span class="co">]</span> use atomic visual marks as the building block of a highly interactive and visual interface built on smooth transitions between different spatial mappings.</span>
<span id="cb12-260"><a href="#cb12-260" aria-hidden="true" tabindex="-1"></a>Drawing on an older experimental tool called Pivot from Microsoft Live Labs, SandDance now exists as a custom visual in the <span class="co">[</span><span class="ot">Microsoft Power BI tool</span><span class="co">](https://www.microsoft.com/en-us/garage/profiles/sanddance/)</span>.</span>
<span id="cb12-261"><a href="#cb12-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-262"><a href="#cb12-262" aria-hidden="true" tabindex="-1"></a>Keim et al. <span class="co">[</span><span class="ot">-@DBLP:journals/ivs/KeimHDJB10</span><span class="co">]</span> propose *generalized scatterplots* that use a data-aware combination of overlapping and distortion to avoid overplotting in a scatterplot display.</span>
<span id="cb12-263"><a href="#cb12-263" aria-hidden="true" tabindex="-1"></a>By balancing the overlapping and distortion, the user can achieve a display that conforms to their prior familiarity with scatterplots while retaining minimal occlusion and appropriate distortion of data points.</span>
<span id="cb12-264"><a href="#cb12-264" aria-hidden="true" tabindex="-1"></a>However, in contrast, our gatherplot approach instead balances legibility and visual accuracy (the deviation from the true mapped position of a point).</span>
<span id="cb12-265"><a href="#cb12-265" aria-hidden="true" tabindex="-1"></a>While gatherplots thus yield better legibility, they are also less visually scalable as well as accurate.</span>
<span id="cb12-266"><a href="#cb12-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-267"><a href="#cb12-267" aria-hidden="true" tabindex="-1"></a>Hieraxes <span class="co">[</span><span class="ot">@Shneiderman1996</span><span class="co">]</span>, SandDance <span class="co">[</span><span class="ot">@Sanddance</span><span class="co">]</span>, and gatherplots (that we present in this paper) are all examples of a recently recognized family of visualizations called *unit visualizations* <span class="co">[</span><span class="ot">@Park2018</span><span class="co">]</span> where the relation between data items and their mark is explicitly maintained. </span>
<span id="cb12-268"><a href="#cb12-268" aria-hidden="true" tabindex="-1"></a>This identity property between data and display is exemplified in visualizations such as unit charts, dotplots, and scatterplots.</span>
<span id="cb12-269"><a href="#cb12-269" aria-hidden="true" tabindex="-1"></a>It can be contrasted with *aggregated visualizations* that combine multiple data items intop a single visual mark, such as barcharts, piecharts, and histograms.</span>
<span id="cb12-270"><a href="#cb12-270" aria-hidden="true" tabindex="-1"></a>Our gatherplots technique shows how a unit visualization can be designed, evaluated, and even deployed from the ground up based on unit visualization principles.</span>
<span id="cb12-271"><a href="#cb12-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-272"><a href="#cb12-272" aria-hidden="true" tabindex="-1"></a>It is worth comparing gatherplots to ur own prior work on the Atom <span class="co">[</span><span class="ot">@Park2018</span><span class="co">]</span> grammar for unit visualization.^[Interestingly, gatherplots actually preceded the Atom grammar; in fact, our gatherplots design eventually led to the formulation of the more general ideas in Atom.</span>
<span id="cb12-273"><a href="#cb12-273" aria-hidden="true" tabindex="-1"></a>However, as these things go, the grammar itself turned out to be a larger and more actionable idea.]</span>
<span id="cb12-274"><a href="#cb12-274" aria-hidden="true" tabindex="-1"></a>Atom is a general-purpose visualization grammar with gathering (packing with no overlap) as one of the visual layout options. </span>
<span id="cb12-275"><a href="#cb12-275" aria-hidden="true" tabindex="-1"></a>In other words, the gatherplots technique can be more or less replicated using Atom. </span>
<span id="cb12-276"><a href="#cb12-276" aria-hidden="true" tabindex="-1"></a>However, our focus in this paper is on specialized design aspects of gatherplots, including the interval marks, streamgraph layout, and layout modes.</span>
<span id="cb12-277"><a href="#cb12-277" aria-hidden="true" tabindex="-1"></a>Also, where Atom is merely a grammar, this paper contributes a detailed user study involving the gatherplots technique in comparison to jittering.</span>
<span id="cb12-278"><a href="#cb12-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-279"><a href="#cb12-279" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualizing Categorical Variables</span></span>
<span id="cb12-280"><a href="#cb12-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-281"><a href="#cb12-281" aria-hidden="true" tabindex="-1"></a>While we have already ascertained that scatterplots are not optimal for categorical variables, there exists a multitude of visualization techniques that have been specifically designed for such data <span class="co">[</span><span class="ot">@Bederson2002; @Hofmann2000; @Kosara2006</span><span class="co">]</span>.</span>
<span id="cb12-282"><a href="#cb12-282" aria-hidden="true" tabindex="-1"></a>Simplest among them are histograms, which visualize the item count for each categorical value <span class="co">[</span><span class="ot">@Stevens1946</span><span class="co">]</span>.</span>
<span id="cb12-283"><a href="#cb12-283" aria-hidden="true" tabindex="-1"></a>Boxplots and violin plots show the distribution of continuous variables over categorical variables <span class="co">[</span><span class="ot">@Wickham2011</span><span class="co">]</span>.</span>
<span id="cb12-284"><a href="#cb12-284" aria-hidden="true" tabindex="-1"></a>While hieraxes, histograms, and treemaps are effective in dealing with categorical variables, it is difficult to extend these to continuous vs. categorical variables.</span>
<span id="cb12-285"><a href="#cb12-285" aria-hidden="true" tabindex="-1"></a>One way is to apply binning to continuous variables to create groups of values.</span>
<span id="cb12-286"><a href="#cb12-286" aria-hidden="true" tabindex="-1"></a>However, the optimal number of bins depends on statistical characteristics of the data and the required task.</span>
<span id="cb12-287"><a href="#cb12-287" aria-hidden="true" tabindex="-1"></a>Dot plots by Wilkinson <span class="co">[</span><span class="ot">-@Wilkinson1999</span><span class="co">]</span> renders continuous univariate variables without overplotting by stacking nodes within dot</span>
<span id="cb12-288"><a href="#cb12-288" aria-hidden="true" tabindex="-1"></a>size.</span>
<span id="cb12-289"><a href="#cb12-289" aria-hidden="true" tabindex="-1"></a>Dang et al. <span class="co">[</span><span class="ot">-@Dang2010</span><span class="co">]</span> extended this to scatterplots by stacking nodes whose values are similar in 3D visual space.</span>
<span id="cb12-290"><a href="#cb12-290" aria-hidden="true" tabindex="-1"></a>These pioneering works provide the theoretical background for the determination of optimal bin size for gatherplots.    </span>
<span id="cb12-291"><a href="#cb12-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-292"><a href="#cb12-292" aria-hidden="true" tabindex="-1"></a>Specialized versions of dot plots <span class="co">[</span><span class="ot">@Wilkinson1999</span><span class="co">]</span> have been imbued with their own monikers.</span>
<span id="cb12-293"><a href="#cb12-293" aria-hidden="true" tabindex="-1"></a>The R graphics package presents a version called a stripchart, which allows for both jittering and stacking categorical data in a one-dimensional scatterplot.</span>
<span id="cb12-294"><a href="#cb12-294" aria-hidden="true" tabindex="-1"></a>Beeswarm plots <span class="co">[</span><span class="ot">@beeswarm</span><span class="co">]</span> improves on stripcharts by allowing for closely packed, non-overlapping points.</span>
<span id="cb12-295"><a href="#cb12-295" aria-hidden="true" tabindex="-1"></a>The seaborn <span class="co">[</span><span class="ot">@Waskom2021</span><span class="co">]</span> statistical data visualization library for Python extends these chart types to two-dimensional space.</span>
<span id="cb12-296"><a href="#cb12-296" aria-hidden="true" tabindex="-1"></a>Stripplots (the name is somewhat unfortunate as it clashes with the strip plots technique for rendering univariate data as strips, yielding a plot reminiscent of a barcode) are 1D or 2D versions of stripcharts with random jittering where at least one axis is expected to be categorical.</span>
<span id="cb12-297"><a href="#cb12-297" aria-hidden="true" tabindex="-1"></a>Swarmplots are 2D versions of beeswarm plots that place points to avoid overlap.</span>
<span id="cb12-298"><a href="#cb12-298" aria-hidden="true" tabindex="-1"></a>In comparison, gatherplots partition the available space into stacked groups and then organize the marks inside each group into ordered grids.</span>
<span id="cb12-299"><a href="#cb12-299" aria-hidden="true" tabindex="-1"></a>This yields a richer visual language that allows for sorting marks based on color and even resize marks to fill the visual space.</span>
<span id="cb12-300"><a href="#cb12-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-301"><a href="#cb12-301" aria-hidden="true" tabindex="-1"></a>Another practical method for visualizing categorical data is for making inferences based on statistical and probabilistic data.</span>
<span id="cb12-302"><a href="#cb12-302" aria-hidden="true" tabindex="-1"></a>Cosmides and Toody <span class="co">[</span><span class="ot">-@Cosmides1996</span><span class="co">]</span> used frequency grids as discrete countable objects, and Micallef et al. <span class="co">[</span><span class="ot">-@Micallef2012</span><span class="co">]</span> extend this with six different area-proportional representations of categorical data organized into different classes.</span>
<span id="cb12-303"><a href="#cb12-303" aria-hidden="true" tabindex="-1"></a>Huron et al. <span class="co">[</span><span class="ot">-@Huron2013</span><span class="co">]</span> suggested using sedimentation as metaphor where individual objects coming from a data stream gradually transform into aggregated areas, or strata.</span>
<span id="cb12-304"><a href="#cb12-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-305"><a href="#cb12-305" aria-hidden="true" tabindex="-1"></a>Finally, Kinetica <span class="co">[</span><span class="ot">@DBLP:conf/chi/RzeszotarskiK14</span><span class="co">]</span>, beyond presenting a novel touch- and physics-based interaction for 2D scatterplots, provides a clustering algorithm where visual marks clump together with collision detection (and thus no overlap) based on their data ranges.</span>
<span id="cb12-306"><a href="#cb12-306" aria-hidden="true" tabindex="-1"></a>The clusters are similar to the partioned clusters in gatherplots, but are organically shaped, not arranged in orderly grid lines, and thus harder to compare.</span>
<span id="cb12-307"><a href="#cb12-307" aria-hidden="true" tabindex="-1"></a>The attraction approach used in Kinetica is reminiscent of the gravity model used for marks in dust &amp; magnet <span class="co">[</span><span class="ot">@DBLP:journals/ivs/YiMSJ05</span><span class="co">]</span>.</span>
<span id="cb12-308"><a href="#cb12-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-309"><a href="#cb12-309" aria-hidden="true" tabindex="-1"></a>::: {#fig-aspect-ratio layout-ncol=1}</span>
<span id="cb12-310"><a href="#cb12-310" aria-hidden="true" tabindex="-1"></a><span class="al">![Absolute mode.](figures/aspect-ratio-1.svg)</span>{#fig-aspect1 fig-alt="Gatherplot for a Titanic survivors dataset with Sex on the Y axis and Class on the X axis. Color encodes whether a person survived or not: dark red for Yes, and pink for No. In the grids formed by the categorical axes, gathered marks arranged in a regular grid show the data distribution. The grids have the same aspect ratio as the overall chart. All the marks are small and of equal size." .accessible-fig}</span>
<span id="cb12-311"><a href="#cb12-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-312"><a href="#cb12-312" aria-hidden="true" tabindex="-1"></a><span class="al">![Normalized mode.](figures/aspect-ratio-2.svg)</span>{#fig-aspect2 fig-alt="Gatherplot for a Titanic survivors dataset with Sex on the Y axis and Class on the X axis. Color encodes whether a person survived or not: dark red for Yes, and pink for No. In the grids formed by the categorical axes, gathered marks arranged in a regular grid show the data distribution. The grid cells are all uniform sized and the marks are sized to fill the available space." .accessible-fig}</span>
<span id="cb12-313"><a href="#cb12-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-314"><a href="#cb12-314" aria-hidden="true" tabindex="-1"></a><span class="al">![Streamgraph mode.](figures/aspect-ratio-3.svg)</span>{#fig-aspect3 fig-alt="Gatherplot for a Titanic survivors dataset with Age on the Y axis and Sex on the X axis. Color encodes the port of boarding for each passenger. The gender values on the X axis results in the chart being split horizontally into two streamgraphs." .accessible-fig}</span>
<span id="cb12-315"><a href="#cb12-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-316"><a href="#cb12-316" aria-hidden="true" tabindex="-1"></a>**Main layout modes for gatherplots.**</span>
<span id="cb12-317"><a href="#cb12-317" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">-@fig-aspect1</span><span class="co">]</span> absolute mode with constant aspect ratio, which maintains the aspect ratio; <span class="co">[</span><span class="ot">-@fig-aspect2</span><span class="co">]</span> normalized mode of <span class="co">[</span><span class="ot">-@fig-aspect1</span><span class="co">]</span>.</span>
<span id="cb12-318"><a href="#cb12-318" aria-hidden="true" tabindex="-1"></a>The rate of male survivors in each passenger class is not easy to compare.</span>
<span id="cb12-319"><a href="#cb12-319" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">-@fig-aspect3</span><span class="co">]</span> streamgraph mode, where each cluster maintains the number of element in the shorter edge, making it easier to see the distribution of the subgroups along the Y axis.</span>
<span id="cb12-320"><a href="#cb12-320" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-321"><a href="#cb12-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-322"><a href="#cb12-322" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ========================================================================== --&gt;</span></span>
<span id="cb12-323"><a href="#cb12-323" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Gather Transformation {#gather}</span></span>
<span id="cb12-324"><a href="#cb12-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-325"><a href="#cb12-325" aria-hidden="true" tabindex="-1"></a>Position along a common scale is the most salient of all visual variables <span class="co">[</span><span class="ot">@Bertin1983; @Cleveland1985</span><span class="co">]</span>, and so mapping a data dimension to positions on a graphical axis is a standard operation in data visualization.</span>
<span id="cb12-326"><a href="#cb12-326" aria-hidden="true" tabindex="-1"></a>We call this mapping a *visual transformation*.</span>
<span id="cb12-327"><a href="#cb12-327" aria-hidden="true" tabindex="-1"></a>However, most statistical treatments of data, such as Stevens' classical theory on the scale of measurements <span class="co">[</span><span class="ot">@Stevens1946</span><span class="co">]</span>, do not take the physical properties of display space into account.</span>
<span id="cb12-328"><a href="#cb12-328" aria-hidden="true" tabindex="-1"></a>This is our purpose in the following section.</span>
<span id="cb12-329"><a href="#cb12-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-330"><a href="#cb12-330" aria-hidden="true" tabindex="-1"></a><span class="fu">### Definition: The Gather Transformation</span></span>
<span id="cb12-331"><a href="#cb12-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-332"><a href="#cb12-332" aria-hidden="true" tabindex="-1"></a>We build on the previous idea of structured displacement <span class="co">[</span><span class="ot">@Bezerianos2010; @Shneiderman2000</span><span class="co">]</span> by proposing a novel visual transformation function called a *gather* transformation that non-linearly segments a graphical axis and organizes data points in each segment to eliminate overplotting.</span>
<span id="cb12-333"><a href="#cb12-333" aria-hidden="true" tabindex="-1"></a>More specifically, the graphical axis is subdivided into contiguous segments, one for each value in the categorical axis.</span>
<span id="cb12-334"><a href="#cb12-334" aria-hidden="true" tabindex="-1"></a>Data points as visual marks are then packed into the available display space without overlap (i.e., using a regular spacing).</span>
<span id="cb12-335"><a href="#cb12-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-336"><a href="#cb12-336" aria-hidden="true" tabindex="-1"></a>Several different methods exist for adapting the gather transformation to a dataset.</span>
<span id="cb12-337"><a href="#cb12-337" aria-hidden="true" tabindex="-1"></a>One approach is to keep the segments of equal size and find a constant visual mark size that ensures that all points fit within the most dense segment.</span>
<span id="cb12-338"><a href="#cb12-338" aria-hidden="true" tabindex="-1"></a>The constant mark size makes visual comparison straightforward.</span>
<span id="cb12-339"><a href="#cb12-339" aria-hidden="true" tabindex="-1"></a>Another approach is to adapt segment size to the density of the data while still keeping the mark size constant.</span>
<span id="cb12-340"><a href="#cb12-340" aria-hidden="true" tabindex="-1"></a>This will minimize empty space in the visual transformation and allows for maximizing mark size.</span>
<span id="cb12-341"><a href="#cb12-341" aria-hidden="true" tabindex="-1"></a>A third approach is to vary mark size proportionally to the number of points in a segment.</span>
<span id="cb12-342"><a href="#cb12-342" aria-hidden="true" tabindex="-1"></a>This will make comparison of the absolute number of points in each segment difficult, but may facilitate relative comparisons if marks are distinguished in some other way (e.g., using color).</span>
<span id="cb12-343"><a href="#cb12-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-344"><a href="#cb12-344" aria-hidden="true" tabindex="-1"></a>For data dimensions that have a very large number of unique values, it often makes sense to first quantize ("bin") the data so that the number of elements is kept manageable (on the order of 10 or less for most visualizations).</span>
<span id="cb12-345"><a href="#cb12-345" aria-hidden="true" tabindex="-1"></a>For example, a data dimension representing a person's age might heuristically be binned into ranges of 10 years: 0-9 years, 10-19 years, 20-29 years, and so on.</span>
<span id="cb12-346"><a href="#cb12-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-347"><a href="#cb12-347" aria-hidden="true" tabindex="-1"></a>In a gather transformation, the coordinate axis has been partitioned into segments, where the order of segments on the axis depends on the data.</span>
<span id="cb12-348"><a href="#cb12-348" aria-hidden="true" tabindex="-1"></a>For nominal data, the segments can be reordered freely, both by the algorithm and by the user.</span>
<span id="cb12-349"><a href="#cb12-349" aria-hidden="true" tabindex="-1"></a>For ordinal or quantized data, the order is given by the data relation.</span>
<span id="cb12-350"><a href="#cb12-350" aria-hidden="true" tabindex="-1"></a>Furthermore, it often makes sense to be able to order points inside each segment using the gathering transformation function, for example using a second data dimension (possibly visualized using color) to group related items together.</span>
<span id="cb12-351"><a href="#cb12-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-352"><a href="#cb12-352" aria-hidden="true" tabindex="-1"></a>Appropriate visual representations of data where the gather transformation has been applied are also important.</span>
<span id="cb12-353"><a href="#cb12-353" aria-hidden="true" tabindex="-1"></a>The *stacked entities* of gathered points should maintain object identity, so that each constituent point and their size is discernible as a discrete visual mark.</span>
<span id="cb12-354"><a href="#cb12-354" aria-hidden="true" tabindex="-1"></a>Similarly, a visual representation of the segmented graphical axis should externalize the segments as labeled intervals instead of labeled major and minor ticks; this will also communicate the discontinuous nature of the axis itself to the viewer.</span>
<span id="cb12-355"><a href="#cb12-355" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-356"><a href="#cb12-356" aria-hidden="true" tabindex="-1"></a><span class="fu">### Using the Gather Transformation</span></span>
<span id="cb12-357"><a href="#cb12-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-358"><a href="#cb12-358" aria-hidden="true" tabindex="-1"></a>Gatherplots minimize overplotting by segmenting each axis into intervals.</span>
<span id="cb12-359"><a href="#cb12-359" aria-hidden="true" tabindex="-1"></a>This allows us to resize segments according to the number of items falling into each segment so that segments with many data points become proportionally larger than those with fewer points.</span>
<span id="cb12-360"><a href="#cb12-360" aria-hidden="true" tabindex="-1"></a>Finally, if the data dimensions represent nominal data, it may make sense to use a global segment ordering function so that there is a minimum of lateral movement for the majority of points as they connect to adjacent axes.</span>
<span id="cb12-361"><a href="#cb12-361" aria-hidden="true" tabindex="-1"></a>This will also minimize line crossings between the parallel axes.</span>
<span id="cb12-362"><a href="#cb12-362" aria-hidden="true" tabindex="-1"></a>This particular visualization technique---a parallel coordinate plot with the gather transformation applied to each graphical axis---is essentially equivalent to *parallel sets* <span class="co">[</span><span class="ot">@Kosara2006</span><span class="co">]</span>.</span>
<span id="cb12-363"><a href="#cb12-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-364"><a href="#cb12-364" aria-hidden="true" tabindex="-1"></a>In fact, by applying our generalized gather transformation to the axis, we are actually proposing a new type of stacked visualization where each entity is still represented by lines.</span>
<span id="cb12-365"><a href="#cb12-365" aria-hidden="true" tabindex="-1"></a>In a sense, this technique combines parallel coordinates and parallel sets because the grouped lines maintain the illusion of a single entity for an axis with nominal categorical values (similar to parallel sets), yet integrates directly with a parallel coordinate axis with continuous values.</span>
<span id="cb12-366"><a href="#cb12-366" aria-hidden="true" tabindex="-1"></a>The main difference is that the new parallel coordinate/set variation allows each axis to be either categorical or continuous, meaning that one axis can represent the gender and the next can represent the height of person.</span>
<span id="cb12-367"><a href="#cb12-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-368"><a href="#cb12-368" aria-hidden="true" tabindex="-1"></a>::: {#fig-gatherplot}</span>
<span id="cb12-371"><a href="#cb12-371" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb12-372"><a href="#cb12-372" aria-hidden="true" tabindex="-1"></a><span class="in">//| panel: input</span></span>
<span id="cb12-373"><a href="#cb12-373" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-alt: "Interactive demonstration of a gatherplot implemented in JavaScript and Observable JS. The visualization shows a cars dataset of some 400 entries. The control panel allows a user to select which dimension to map to the two graphical axes and color."</span></span>
<span id="cb12-374"><a href="#cb12-374" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-cap: "Interactive gatherplot"</span></span>
<span id="cb12-375"><a href="#cb12-375" aria-hidden="true" tabindex="-1"></a><span class="in">viewof xAxis = Inputs.select(cars.columns, {label: "X Axis", value: cars.columns[0]});</span></span>
<span id="cb12-376"><a href="#cb12-376" aria-hidden="true" tabindex="-1"></a><span class="in">viewof yAxis = Inputs.select(cars.columns, {label: "Y Axis", value: cars.columns[1]});</span></span>
<span id="cb12-377"><a href="#cb12-377" aria-hidden="true" tabindex="-1"></a><span class="in">viewof color = Inputs.select(colors, {format: x =&gt; x.name, value: colors.find(t =&gt; t.name === "Cylinders"), label: "Color"});</span></span>
<span id="cb12-378"><a href="#cb12-378" aria-hidden="true" tabindex="-1"></a><span class="in">viewof sorting = Inputs.checkbox(["color"], {label: "Sorting"});</span></span>
<span id="cb12-379"><a href="#cb12-379" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-380"><a href="#cb12-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-383"><a href="#cb12-383" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb12-384"><a href="#cb12-384" aria-hidden="true" tabindex="-1"></a><span class="in">C = d3.map(cars, d =&gt; d[color.name]).sort();</span></span>
<span id="cb12-385"><a href="#cb12-385" aria-hidden="true" tabindex="-1"></a><span class="in">color.categorical ?</span></span>
<span id="cb12-386"><a href="#cb12-386" aria-hidden="true" tabindex="-1"></a><span class="in">  Swatches(d3.scaleOrdinal(new Set(C).values(), d3.schemeCategory10)) :</span></span>
<span id="cb12-387"><a href="#cb12-387" aria-hidden="true" tabindex="-1"></a><span class="in">  Legend(d3.scaleSequential().interpolator(d3.interpolateYlGnBu).domain(d3.extent(C)), {title: color.name}); </span></span>
<span id="cb12-388"><a href="#cb12-388" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-389"><a href="#cb12-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-392"><a href="#cb12-392" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb12-393"><a href="#cb12-393" aria-hidden="true" tabindex="-1"></a><span class="in">colors = [</span></span>
<span id="cb12-394"><a href="#cb12-394" aria-hidden="true" tabindex="-1"></a><span class="in">  {name: 'Name', categorical: true}, </span></span>
<span id="cb12-395"><a href="#cb12-395" aria-hidden="true" tabindex="-1"></a><span class="in">  {name: 'MPG', categorical: false}, </span></span>
<span id="cb12-396"><a href="#cb12-396" aria-hidden="true" tabindex="-1"></a><span class="in">  {name: 'Cylinders', categorical: true}, </span></span>
<span id="cb12-397"><a href="#cb12-397" aria-hidden="true" tabindex="-1"></a><span class="in">  {name: 'Displacement', categorical: false}, </span></span>
<span id="cb12-398"><a href="#cb12-398" aria-hidden="true" tabindex="-1"></a><span class="in">  {name: 'Horsepower', categorical: false}, </span></span>
<span id="cb12-399"><a href="#cb12-399" aria-hidden="true" tabindex="-1"></a><span class="in">  {name: 'Weight', categorical: false}, </span></span>
<span id="cb12-400"><a href="#cb12-400" aria-hidden="true" tabindex="-1"></a><span class="in">  {name: 'Acceleration', categorical: false}, </span></span>
<span id="cb12-401"><a href="#cb12-401" aria-hidden="true" tabindex="-1"></a><span class="in">  {name: 'Model', categorical: false}, </span></span>
<span id="cb12-402"><a href="#cb12-402" aria-hidden="true" tabindex="-1"></a><span class="in">  {name: 'Origin', categorical: true}</span></span>
<span id="cb12-403"><a href="#cb12-403" aria-hidden="true" tabindex="-1"></a><span class="in">];</span></span>
<span id="cb12-404"><a href="#cb12-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-405"><a href="#cb12-405" aria-hidden="true" tabindex="-1"></a><span class="in">gather = GatherPlot(cars, { </span></span>
<span id="cb12-406"><a href="#cb12-406" aria-hidden="true" tabindex="-1"></a><span class="in">  x: d =&gt; d[xAxis],</span></span>
<span id="cb12-407"><a href="#cb12-407" aria-hidden="true" tabindex="-1"></a><span class="in">  y: d =&gt; d[yAxis],</span></span>
<span id="cb12-408"><a href="#cb12-408" aria-hidden="true" tabindex="-1"></a><span class="in">  c: d =&gt; d[color.name],</span></span>
<span id="cb12-409"><a href="#cb12-409" aria-hidden="true" tabindex="-1"></a><span class="in">  ySort: sorting.indexOf('Y descending') === -1 ? 1 : -1,</span></span>
<span id="cb12-410"><a href="#cb12-410" aria-hidden="true" tabindex="-1"></a><span class="in">  xSort: sorting.indexOf('X descending') === -1 ? 1 : -1,</span></span>
<span id="cb12-411"><a href="#cb12-411" aria-hidden="true" tabindex="-1"></a><span class="in">  cSort: sorting.indexOf('color') === -1 ? 0 : 1,</span></span>
<span id="cb12-412"><a href="#cb12-412" aria-hidden="true" tabindex="-1"></a><span class="in">  width,</span></span>
<span id="cb12-413"><a href="#cb12-413" aria-hidden="true" tabindex="-1"></a><span class="in">  height: 600</span></span>
<span id="cb12-414"><a href="#cb12-414" aria-hidden="true" tabindex="-1"></a><span class="in">});</span></span>
<span id="cb12-415"><a href="#cb12-415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-416"><a href="#cb12-416" aria-hidden="true" tabindex="-1"></a>**Interactive gatherplot.**</span>
<span id="cb12-417"><a href="#cb12-417" aria-hidden="true" tabindex="-1"></a>Gatherplot of the cars dataset with controls for the horizontal and vertical axes as well as the dot color assignment.</span>
<span id="cb12-418"><a href="#cb12-418" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-419"><a href="#cb12-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-420"><a href="#cb12-420" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ========================================================================== --&gt;</span></span>
<span id="cb12-421"><a href="#cb12-421" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gatherplots: A 2D Gathering Representation {#gatherplots}</span></span>
<span id="cb12-422"><a href="#cb12-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-423"><a href="#cb12-423" aria-hidden="true" tabindex="-1"></a>Applying gathering to two perpendicular axes defining a Cartesian space results in a *gatherplot*: a 2D distortion-based extension of scatterplots that gathers data points into *stacked groups*, thereby eliminating overplotting without losing the identity of individual data points.</span>
<span id="cb12-424"><a href="#cb12-424" aria-hidden="true" tabindex="-1"></a>@fig-gatherplot provides an interactive gatherplot.</span>
<span id="cb12-425"><a href="#cb12-425" aria-hidden="true" tabindex="-1"></a>Compared to jittering, which relies on random permutation, gathering organizes visual marks according to visual features, so that the resulting group of objects forms a meta-object.</span>
<span id="cb12-426"><a href="#cb12-426" aria-hidden="true" tabindex="-1"></a>According to Haroz and Whitney <span class="co">[</span><span class="ot">-@Haroz2012</span><span class="co">]</span>, grouping marks by feature helps in performing perceptual tasks such as finding outliers, counting items, and seeing trends.</span>
<span id="cb12-427"><a href="#cb12-427" aria-hidden="true" tabindex="-1"></a>The technique is particularly designed for visualizing categorical variables.</span>
<span id="cb12-428"><a href="#cb12-428" aria-hidden="true" tabindex="-1"></a>Below we discuss the open design parameters for the technique, including layout, aspect ratio, and item shapes.</span>
<span id="cb12-429"><a href="#cb12-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-430"><a href="#cb12-430" aria-hidden="true" tabindex="-1"></a><span class="fu">### Layout</span></span>
<span id="cb12-431"><a href="#cb12-431" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-432"><a href="#cb12-432" aria-hidden="true" tabindex="-1"></a>Gatherplots eliminate overplotting by gathering marks with similar visual properties into *stacked groups*.</span>
<span id="cb12-433"><a href="#cb12-433" aria-hidden="true" tabindex="-1"></a>This is inspired by previous works such as hieraxes <span class="co">[</span><span class="ot">@Shneiderman2000</span><span class="co">]</span> or frequency grids <span class="co">[</span><span class="ot">@Micallef2012; @Cosmides1996</span><span class="co">]</span>.</span>
<span id="cb12-434"><a href="#cb12-434" aria-hidden="true" tabindex="-1"></a>However, there are many design possibilities for organizing the visual representation depending on the context, especially on the size distribution of each groups, the aspect ratio of assigned space, and the task at hand.</span>
<span id="cb12-435"><a href="#cb12-435" aria-hidden="true" tabindex="-1"></a>As a result, we derive the following three layout modes (see @fig-aspect-ratio):</span>
<span id="cb12-436"><a href="#cb12-436" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-437"><a href="#cb12-437" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Absolute mode**: Here stacked groups are sized to follow the aspect-ratio of the assigned region.</span>
<span id="cb12-438"><a href="#cb12-438" aria-hidden="true" tabindex="-1"></a>  The size of the items are determined by the maximum length dots which can fill the assigned region without overlapping.</span>
<span id="cb12-439"><a href="#cb12-439" aria-hidden="true" tabindex="-1"></a>  This means with the same assigned space, the groups with the maximum number of members determines the overall size of the nodes (@fig-aspect-ratio(a)). </span>
<span id="cb12-440"><a href="#cb12-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-441"><a href="#cb12-441" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Normalized mode**: In this mode, the mark size and aspect ratio is adapted so that every stacked group has equal dimensions.</span>
<span id="cb12-442"><a href="#cb12-442" aria-hidden="true" tabindex="-1"></a>  This makes it easier to investigate ratios when the user is interested in the relative distributions of subgroups rather than the absolute number of members.</span>
<span id="cb12-443"><a href="#cb12-443" aria-hidden="true" tabindex="-1"></a>  <span class="co">&lt;!-- Items also change their shape from a circle (absolute mode) to a rounded rectangle (@fig-aspect-ratio(b)).   --&gt;</span></span>
<span id="cb12-444"><a href="#cb12-444" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-445"><a href="#cb12-445" aria-hidden="true" tabindex="-1"></a>  Normalized mode is useful for two specific tasks:</span>
<span id="cb12-446"><a href="#cb12-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-447"><a href="#cb12-447" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>*Finding the ratio of the subgroups in a group* (@fig-aspect-ratio).</span>
<span id="cb12-448"><a href="#cb12-448" aria-hidden="true" tabindex="-1"></a>    Because groups of different size are normalized to the same geometric area, any comparison results in a relative comparison, which can aid statistical Bayesian reasoning <span class="co">[</span><span class="ot">@Micallef2012</span><span class="co">]</span>.</span>
<span id="cb12-449"><a href="#cb12-449" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-450"><a href="#cb12-450" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>*Finding the distribution of outliers*.</span>
<span id="cb12-451"><a href="#cb12-451" aria-hidden="true" tabindex="-1"></a>    When there are many items on the screen for absolute mode, all marks must be reduced in size.</span>
<span id="cb12-452"><a href="#cb12-452" aria-hidden="true" tabindex="-1"></a>    This can make outliers hard to locate.</span>
<span id="cb12-453"><a href="#cb12-453" aria-hidden="true" tabindex="-1"></a>    When normalized mode is used, the outliers are expanded to fill the assigned space, making them easier to see.  </span>
<span id="cb12-454"><a href="#cb12-454" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-455"><a href="#cb12-455" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Streamgraph mode**: Here stacked groups are reorganized so that they maintain the same number of elements in their shorter edge.</span>
<span id="cb12-456"><a href="#cb12-456" aria-hidden="true" tabindex="-1"></a>  This mode is used for regions where the ratio of width and height are drastically different (in our prototype implementation, we use a heuristic threshold aspect ratio value of 3 for activating this mode).</span>
<span id="cb12-457"><a href="#cb12-457" aria-hidden="true" tabindex="-1"></a>  This means there are usually many times more groups in the axis in parallel with shorter edges.</span>
<span id="cb12-458"><a href="#cb12-458" aria-hidden="true" tabindex="-1"></a>  A good example is for visualizing the population distribution with regards to gender and age; the resulting gatherplot approaches ThemeRiver <span class="co">[</span><span class="ot">@Havre2000</span><span class="co">]</span> as the number of entities increases (@fig-aspect-ratio(c)).</span>
<span id="cb12-459"><a href="#cb12-459" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-460"><a href="#cb12-460" aria-hidden="true" tabindex="-1"></a>The choice between absolute and streamgraph mode happens automatically based on the aspect ratio of assigned space and without the need for user intervention.</span>
<span id="cb12-461"><a href="#cb12-461" aria-hidden="true" tabindex="-1"></a>Therefore, only a simple interaction is required to toggle between absolute and normalized mode.</span>
<span id="cb12-462"><a href="#cb12-462" aria-hidden="true" tabindex="-1"></a>However, we do expose a setting to manually toggle between these modes as well.</span>
<span id="cb12-463"><a href="#cb12-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-464"><a href="#cb12-464" aria-hidden="true" tabindex="-1"></a><span class="fu">### Managing Continuous Variables</span></span>
<span id="cb12-465"><a href="#cb12-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-466"><a href="#cb12-466" aria-hidden="true" tabindex="-1"></a>To use gatherplots for continuous variables, we apply binning to partition the variable into discrete intervals.</span>
<span id="cb12-467"><a href="#cb12-467" aria-hidden="true" tabindex="-1"></a>The resulting visualization resembles dots plots by Wilkinson <span class="co">[</span><span class="ot">-@Wilkinson1999</span><span class="co">]</span>, where bin size is equal to dot size.</span>
<span id="cb12-468"><a href="#cb12-468" aria-hidden="true" tabindex="-1"></a>The size of individual bins is important for binning because it determines the spatial accuracy and legibility of the visualization.</span>
<span id="cb12-469"><a href="#cb12-469" aria-hidden="true" tabindex="-1"></a>We define *spatial accuracy* as the degree to which a mark in a gatherplot is mapped to the actual position it would have been mapped if the mapping had been continuous (like for a regular scatterplot).</span>
<span id="cb12-470"><a href="#cb12-470" aria-hidden="true" tabindex="-1"></a>*Legibility*, on the other hand, is the ability for a user to perceive individual marks in a unit visualization.</span>
<span id="cb12-471"><a href="#cb12-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-472"><a href="#cb12-472" aria-hidden="true" tabindex="-1"></a>Wilkinson proposed $.25n^{-1/2}$ as the optimal dot size for dot plots (although he also noted that an implementation should reduce size for overflow situations).</span>
<span id="cb12-473"><a href="#cb12-473" aria-hidden="true" tabindex="-1"></a>This creates reasonable dot plots for fixed aspect ratio of 5 to 1, which is common in statistical charts assuming normal distribution of nodes.   </span>
<span id="cb12-474"><a href="#cb12-474" aria-hidden="true" tabindex="-1"></a>However, gatherplot requires two different assumptions:</span>
<span id="cb12-475"><a href="#cb12-475" aria-hidden="true" tabindex="-1"></a>First, the aspect ratio varies according to the space given to the categorical variables.</span>
<span id="cb12-476"><a href="#cb12-476" aria-hidden="true" tabindex="-1"></a>Second, the dot size or bin size is determined by the global maximum in the dataset, which may not be in the same cluster.</span>
<span id="cb12-477"><a href="#cb12-477" aria-hidden="true" tabindex="-1"></a>Furthermore, because bin size is the same as dot size, selecting bin size can be thought of as a trade-off between accuracy and legibility.</span>
<span id="cb12-478"><a href="#cb12-478" aria-hidden="true" tabindex="-1"></a>Using very small bin size and dot size increases the spatial accuracy, but results in poor legibility, and vice versa.</span>
<span id="cb12-479"><a href="#cb12-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-480"><a href="#cb12-480" aria-hidden="true" tabindex="-1"></a>Balancing accuracy vs. legibility is common in visualization for large datasets; for example, splatterplots limit the information shown to users based on the available visual space <span class="co">[</span><span class="ot">@Mayorga2013</span><span class="co">]</span>.</span>
<span id="cb12-481"><a href="#cb12-481" aria-hidden="true" tabindex="-1"></a>Similarly, gatherplots choose bin size based on spatial accuracy and legibility.</span>
<span id="cb12-482"><a href="#cb12-482" aria-hidden="true" tabindex="-1"></a>When the visual space is small, we use a comparably large bin size to increase dot size, thus resulting in poor spatial accuracy and high legibility; for larger space allocations, the bins can be made smaller to increase accuracy without loss of legibility.</span>
<span id="cb12-483"><a href="#cb12-483" aria-hidden="true" tabindex="-1"></a>Our implementation iteratively finds a bin size as a trade-off between mark size and the most crowded bin; this is shown in @fig-optimal-bin. </span>
<span id="cb12-484"><a href="#cb12-484" aria-hidden="true" tabindex="-1"></a>Overall, this is an inherent weakness of unit visualizations: the need to make individual marks distinct means that the visual representation may become distorted, and the scalability of the visualization suffers overall.</span>
<span id="cb12-485"><a href="#cb12-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-486"><a href="#cb12-486" aria-hidden="true" tabindex="-1"></a>::: {#fig-optimal-bin layout-ncol=1}</span>
<span id="cb12-487"><a href="#cb12-487" aria-hidden="true" tabindex="-1"></a><span class="al">![Large display space.](figures/cont-size-1.svg)</span>{#fig-optimal-bin1 fig-alt="Gatherplot for a car dataset with MPG on the Y axis and unassigned X axis. Color is used to show three different origins: US (blue), Europe (orange), and Asia (green). The result is a streamgraph arrangement with each position on the Y axis showing a single gathered row of cars with the corresponding gas mileage." .accessible-fig}</span>
<span id="cb12-488"><a href="#cb12-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-489"><a href="#cb12-489" aria-hidden="true" tabindex="-1"></a><span class="al">![Small display space.](figures/cont-size-2.svg)</span>{#fig-optimal-bin2 fig-alt="Gatherplot for a car dataset with MPG on the Y axis and unassigned X axis. Color is used to show three different origins: US (blue), Europe (orange), and Asia (green). The result is a streamgraph arrangement with each position on the Y axis showing a single gathered row of cars with the corresponding gas mileage. This chart is shorter than the previous one, yielding larger mileage bins." .accessible-fig}</span>
<span id="cb12-490"><a href="#cb12-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-491"><a href="#cb12-491" aria-hidden="true" tabindex="-1"></a>**Choosing optimal bin size based on available display space.**</span>
<span id="cb12-492"><a href="#cb12-492" aria-hidden="true" tabindex="-1"></a>In <span class="co">[</span><span class="ot">-@fig-optimal-bin1</span><span class="co">]</span>, there is enough space so that the dot size can be maximized, improving spatial accuracy.</span>
<span id="cb12-493"><a href="#cb12-493" aria-hidden="true" tabindex="-1"></a>In comparison, in <span class="co">[</span><span class="ot">-@fig-optimal-bin2</span><span class="co">]</span> the assigned space is small, so the dot size is determined so that the most crowded bin interval will fit within the assigned space.</span>
<span id="cb12-494"><a href="#cb12-494" aria-hidden="true" tabindex="-1"></a>This results in two different overviews even though the two plots have identical aspect ratio.</span>
<span id="cb12-495"><a href="#cb12-495" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-496"><a href="#cb12-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-497"><a href="#cb12-497" aria-hidden="true" tabindex="-1"></a>@fig-cont-cont shows how gatherplots handle the situation when continuous variables are assigned to **both** axes, causing both to be binned.</span>
<span id="cb12-498"><a href="#cb12-498" aria-hidden="true" tabindex="-1"></a>The plot is using normalized mode with two random variables.</span>
<span id="cb12-499"><a href="#cb12-499" aria-hidden="true" tabindex="-1"></a>The normalized mode makes it easier to identify the outliers and the distribution of outliers.</span>
<span id="cb12-500"><a href="#cb12-500" aria-hidden="true" tabindex="-1"></a>Furthermore, the case of scatterplots with the same continuous variables on both axes can be treated as a special case of continuous vs. categorical variables.</span>
<span id="cb12-501"><a href="#cb12-501" aria-hidden="true" tabindex="-1"></a>Here, the gatherplot is rotated to maintain integrity with scatterplots (@fig-teaser(c)). </span>
<span id="cb12-502"><a href="#cb12-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-503"><a href="#cb12-503" aria-hidden="true" tabindex="-1"></a>One limitation of gatherplots is that the technique requires binning to manage a continuous variable, yet binning creates arbitrary boundaries that can be misleading.</span>
<span id="cb12-504"><a href="#cb12-504" aria-hidden="true" tabindex="-1"></a>However, using both gatherplots and scatterplots in different views makes this problem less severe because the analyst can simply choose the visual representation most suited for a particular task.</span>
<span id="cb12-505"><a href="#cb12-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-506"><a href="#cb12-506" aria-hidden="true" tabindex="-1"></a>::: {#fig-cont-cont layout-ncol=1}</span>
<span id="cb12-507"><a href="#cb12-507" aria-hidden="true" tabindex="-1"></a><span class="al">![Scatterplot.](figures/cont-cont-1.svg)</span>{#fig-cont-cont1 fig-alt="Scatterplot with 5,000 random data points and severe overplotting. The data is uniformly distributed along the Y axis and appears normally distributed on the X axis. The graph shows three separate colors: blue, cyan, and moss green." .accessible-fig}</span>
<span id="cb12-508"><a href="#cb12-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-509"><a href="#cb12-509" aria-hidden="true" tabindex="-1"></a><span class="al">![Absolute gatherplot.](figures/cont-cont-2.svg)</span>{#fig-cont-cont2 fig-alt="Gatherplot with absolute mode for the random 5,000-point dataset. Both the X and Y axes have been automatically binned by the algorithm. The cells resulting from this binning show ordered marks; the horizontal center area shows the most data points." .accessible-fig}</span>
<span id="cb12-510"><a href="#cb12-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-511"><a href="#cb12-511" aria-hidden="true" tabindex="-1"></a><span class="al">![Normalized gatherplot.](figures/cont-cont-3.svg)</span>{#fig-cont-cont3 fig-alt="Gatherplot with normalized mode for the random 5,000-point dataset. Both the X and Y axes have been automatically binned by the algorithm. Because of the normalization, marks in grid cells with few data points have been resized to fill the available space, making it easier to see outliers in the left and right side of the plot." .accessible-fig}</span>
<span id="cb12-512"><a href="#cb12-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-513"><a href="#cb12-513" aria-hidden="true" tabindex="-1"></a>**Using gatherplots to manage overplotting.**</span>
<span id="cb12-514"><a href="#cb12-514" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">-@fig-cont-cont1</span><span class="co">]</span> shows a scatterplot with 5,000 random numbers with severe overplotting in the center area.</span>
<span id="cb12-515"><a href="#cb12-515" aria-hidden="true" tabindex="-1"></a>In <span class="co">[</span><span class="ot">-@fig-cont-cont2</span><span class="co">]</span>, gathering is applied to create a more organized view.</span>
<span id="cb12-516"><a href="#cb12-516" aria-hidden="true" tabindex="-1"></a>However, the gathering resizes the items so small that it becomes difficult to detect outliers.</span>
<span id="cb12-517"><a href="#cb12-517" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">-@fig-cont-cont3</span><span class="co">]</span> shows normalized mode, where the outliers are enlarged.</span>
<span id="cb12-518"><a href="#cb12-518" aria-hidden="true" tabindex="-1"></a>This makes identifying the distribution of sparse regions easier.</span>
<span id="cb12-519"><a href="#cb12-519" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-520"><a href="#cb12-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-521"><a href="#cb12-521" aria-hidden="true" tabindex="-1"></a><span class="fu">### Undefined Axis Mapping</span></span>
<span id="cb12-522"><a href="#cb12-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-523"><a href="#cb12-523" aria-hidden="true" tabindex="-1"></a>Scatterplots have traditionally been used to view correlations between two variables.</span>
<span id="cb12-524"><a href="#cb12-524" aria-hidden="true" tabindex="-1"></a>However, for a multidimensional exploration, one subtle difficulty is when the user wants to see only the effect of a single variable.</span>
<span id="cb12-525"><a href="#cb12-525" aria-hidden="true" tabindex="-1"></a>In gatherplots, the logical extension of an undefined axis is the aggregation of all nodes in a single group along that axis.</span>
<span id="cb12-526"><a href="#cb12-526" aria-hidden="true" tabindex="-1"></a>@fig-matrix shows an example of this using a dataset on survivors of the Titanic.</span>
<span id="cb12-527"><a href="#cb12-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-528"><a href="#cb12-528" aria-hidden="true" tabindex="-1"></a>::: {#fig-matrix layout-ncol=1}</span>
<span id="cb12-529"><a href="#cb12-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-530"><a href="#cb12-530" aria-hidden="true" tabindex="-1"></a><span class="al">![All passengers.](figures/undefined-1.svg)</span>{#fig-matrix1 fig-alt="Gatherplot showing all passengers of the Titanic with no mapping to the X and Y axes. Each passenger is represented by a single red mark organized into a rectangular grid." .accessible-fig}</span>
<span id="cb12-531"><a href="#cb12-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-532"><a href="#cb12-532" aria-hidden="true" tabindex="-1"></a><span class="al">![All passengers colored by survival (pink = survived, gray = died).](figures/undefined-2.svg)</span>{#fig-matrix2 fig-alt="Gatherplot showing all passengers of the Titanic with no mapping to the X and Y axes. Each passenger is represented by a single mark organized into a rectangular grid. Marks are colored to show whether they survived (pink) or died (gray); approximately a quarter of the first dots in the grid to the left of the plot are colored pink." .accessible-fig}</span>
<span id="cb12-533"><a href="#cb12-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-534"><a href="#cb12-534" aria-hidden="true" tabindex="-1"></a><span class="al">![Passengers gathered by Class (pink = survived, gray = died).](figures/undefined-3.svg)</span>{#fig-matrix3 fig-alt="Gatherplot showing all passengers of the Titanic with the Class mapped to the X axis and no mapping to the Y axis. Class splits the horizontal space into four areas: First, Second, and Third class, and Crew. Marks are colored to show whether they survived (pink) or died (gray). First class has the highest survival rate; almost 75% of its dots are colored pink. A third of Second class is colored pink; less than a quarter of Third class and Crew are pink." .accessible-fig}</span>
<span id="cb12-535"><a href="#cb12-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-536"><a href="#cb12-536" aria-hidden="true" tabindex="-1"></a><span class="al">![Passengers gathered by Sex (pink = survived, gray = died).](figures/undefined-4.svg)</span>{#fig-matrix4 fig-alt="Gatherplot showing all passengers of the Titanic with the no mapping to the X axis and Sex mapped to the Y axis. Sex splits the vertical space into two areas: Female and Male. There are four times as many Male than Female marks on the plot. Marks are colored to show whether they survived (pink) or died (gray). Approximately 75% of the marks representing Female passengers are colored pink. Approximately 20% of the marks representing Male passengers are pink." .accessible-fig}</span>
<span id="cb12-537"><a href="#cb12-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-538"><a href="#cb12-538" aria-hidden="true" tabindex="-1"></a>**Gatherplot showing survivors of the *Titanic*.**</span>
<span id="cb12-539"><a href="#cb12-539" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">-@fig-matrix1</span><span class="co">]</span> All people on board.</span>
<span id="cb12-540"><a href="#cb12-540" aria-hidden="true" tabindex="-1"></a>Note that the X and Y axis are not defined.</span>
<span id="cb12-541"><a href="#cb12-541" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">-@fig-matrix2</span><span class="co">]</span> Color coding for survivors.</span>
<span id="cb12-542"><a href="#cb12-542" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">-@fig-matrix3</span><span class="co">]</span> Distribution of survivors over class variables.</span>
<span id="cb12-543"><a href="#cb12-543" aria-hidden="true" tabindex="-1"></a>Here the Y axis is undefined.</span>
<span id="cb12-544"><a href="#cb12-544" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">-@fig-matrix4</span><span class="co">]</span> Distribution of survivors over the gender.</span>
<span id="cb12-545"><a href="#cb12-545" aria-hidden="true" tabindex="-1"></a>Here the X axis is undefined.</span>
<span id="cb12-546"><a href="#cb12-546" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-547"><a href="#cb12-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-548"><a href="#cb12-548" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visual Design</span></span>
<span id="cb12-549"><a href="#cb12-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-550"><a href="#cb12-550" aria-hidden="true" tabindex="-1"></a>Gatherplots build on the same visual language as scatterplots.</span>
<span id="cb12-551"><a href="#cb12-551" aria-hidden="true" tabindex="-1"></a>However, some aspects are different; below we discuss our design choices for visual mark shape as well as tick marks.</span>
<span id="cb12-552"><a href="#cb12-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-553"><a href="#cb12-553" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visual Marks</span></span>
<span id="cb12-554"><a href="#cb12-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-555"><a href="#cb12-555" aria-hidden="true" tabindex="-1"></a>Scatterplots typically use a small circle or dot as a visual representation for items, but many variations exist that use glyph shapes to convey multidimensional variables <span class="co">[</span><span class="ot">@McDonnel2009; @Tufte1983; @Cleveland1988; @Chernoff1973</span><span class="co">]</span>.</span>
<span id="cb12-556"><a href="#cb12-556" aria-hidden="true" tabindex="-1"></a>This is also potentially useful for gatherplots; the layouts generated by gathering can contain any visual mark, even aggregated ones like pie charts or bar charts.</span>
<span id="cb12-557"><a href="#cb12-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-558"><a href="#cb12-558" aria-hidden="true" tabindex="-1"></a>In this paper we focus on unit visual marks, i.e. with one mark per data item.</span>
<span id="cb12-559"><a href="#cb12-559" aria-hidden="true" tabindex="-1"></a>In normalized mode, sometimes the aspect ratio of visual marks changes according to the aspect ratio of the space assigned to that value.</span>
<span id="cb12-560"><a href="#cb12-560" aria-hidden="true" tabindex="-1"></a>Also, as gathering changes the size of marks to fit in one cluster, sometimes the marks size becomes too small or too large compared to other marks.</span>
<span id="cb12-561"><a href="#cb12-561" aria-hidden="true" tabindex="-1"></a>This results in several unique design considerations for item shapes.</span>
<span id="cb12-562"><a href="#cb12-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-563"><a href="#cb12-563" aria-hidden="true" tabindex="-1"></a>Based on our experience testing several alternate designs, we recommend using a rectangle with constant rounded edge.</span>
<span id="cb12-564"><a href="#cb12-564" aria-hidden="true" tabindex="-1"></a>Using constant rounded edge allows the nodes to be circular when the mark is small, as in @fig-aspect-ratio(b), and a rectangle to show the degree of stretching, as shown in @fig-aspect-ratio(b).</span>
<span id="cb12-565"><a href="#cb12-565" aria-hidden="true" tabindex="-1"></a>As a disadvantage, it does yield less differentiable individual elements.</span>
<span id="cb12-566"><a href="#cb12-566" aria-hidden="true" tabindex="-1"></a>Stroke lines can be useful in some situations, but easily become dominant when nodes shrink below a certain size.</span>
<span id="cb12-567"><a href="#cb12-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-568"><a href="#cb12-568" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Interval Tick Marks</span></span>
<span id="cb12-569"><a href="#cb12-569" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-570"><a href="#cb12-570" aria-hidden="true" tabindex="-1"></a>Because we are representing ranges rather than single points, the single line type tick marks for scatterplots are not appropriate for gatherplots; instead, ticks should communicate the partitioned segments on the axes.</span>
<span id="cb12-571"><a href="#cb12-571" aria-hidden="true" tabindex="-1"></a>Without this visual representation, when the user is confronted with a number, it can be confusing to determine whether adjacent nodes with different offset has same value or not.</span>
<span id="cb12-572"><a href="#cb12-572" aria-hidden="true" tabindex="-1"></a>@fig-tick-mark shows design alternatives of tick mark for representing ranges.</span>
<span id="cb12-573"><a href="#cb12-573" aria-hidden="true" tabindex="-1"></a>Our implementations use bracket type markers to reduce density from adjacent ticks.</span>
<span id="cb12-574"><a href="#cb12-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-575"><a href="#cb12-575" aria-hidden="true" tabindex="-1"></a>::: {#fig-tick-mark layout-ncol=3}</span>
<span id="cb12-576"><a href="#cb12-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-577"><a href="#cb12-577" aria-hidden="true" tabindex="-1"></a><span class="al">![](figures/tick-marks-1.svg)</span>{#fig-tick-mark1 fig-alt="Simple vertical tick marks."}</span>
<span id="cb12-578"><a href="#cb12-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-579"><a href="#cb12-579" aria-hidden="true" tabindex="-1"></a><span class="al">![](figures/tick-marks-2.svg)</span>{#fig-tick-mark2 fig-alt="Double-sided arrows."}</span>
<span id="cb12-580"><a href="#cb12-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-581"><a href="#cb12-581" aria-hidden="true" tabindex="-1"></a><span class="al">![](figures/tick-marks-3.svg)</span>{#fig-tick-mark3 fig-alt="Double-sided arrows with tick marks."}</span>
<span id="cb12-582"><a href="#cb12-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-583"><a href="#cb12-583" aria-hidden="true" tabindex="-1"></a><span class="al">![](figures/tick-marks-4.svg)</span>{#fig-tick-mark4 fig-alt="Square brackets."}</span>
<span id="cb12-584"><a href="#cb12-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-585"><a href="#cb12-585" aria-hidden="true" tabindex="-1"></a><span class="al">![](figures/tick-marks-5.svg)</span>{#fig-tick-mark5 fig-alt="Angle brackets."}</span>
<span id="cb12-586"><a href="#cb12-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-587"><a href="#cb12-587" aria-hidden="true" tabindex="-1"></a><span class="al">![](figures/tick-marks-6.svg)</span>{#fig-tick-mark6 fig-alt="Curly brackets."}</span>
<span id="cb12-588"><a href="#cb12-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-589"><a href="#cb12-589" aria-hidden="true" tabindex="-1"></a>**Various tick mark types.**</span>
<span id="cb12-590"><a href="#cb12-590" aria-hidden="true" tabindex="-1"></a>The blue dotted region represents the area between adjacent tick</span>
<span id="cb12-591"><a href="#cb12-591" aria-hidden="true" tabindex="-1"></a>marks.</span>
<span id="cb12-592"><a href="#cb12-592" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">-@fig-tick-mark1</span><span class="co">]</span> is a typical line type tick mark for scatterplots.</span>
<span id="cb12-593"><a href="#cb12-593" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">-@fig-tick-mark2</span><span class="co">]</span> lacks guidelines, which will make anchoring easier.</span>
<span id="cb12-594"><a href="#cb12-594" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">-@fig-tick-mark3</span><span class="co">]</span> creates a packed region between adjacent marks. </span>
<span id="cb12-595"><a href="#cb12-595" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">-@fig-tick-mark4</span><span class="co">]</span> uses less clutter, but <span class="co">[</span><span class="ot">-@fig-tick-mark5</span><span class="co">]</span> is the least cluttered.</span>
<span id="cb12-596"><a href="#cb12-596" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">-@fig-tick-mark6</span><span class="co">]</span> is the final recommendation, with the data label in the orange region.</span>
<span id="cb12-597"><a href="#cb12-597" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-598"><a href="#cb12-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-599"><a href="#cb12-599" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interaction</span></span>
<span id="cb12-600"><a href="#cb12-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-601"><a href="#cb12-601" aria-hidden="true" tabindex="-1"></a>Gatherplots support the same types of interactions as scatterplots.</span>
<span id="cb12-602"><a href="#cb12-602" aria-hidden="true" tabindex="-1"></a>However, some additional interaction techniques are required to specifically control the gathering transformation. </span>
<span id="cb12-603"><a href="#cb12-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-604"><a href="#cb12-604" aria-hidden="true" tabindex="-1"></a>For example, when exploring multidimensional datasets, it is crucial to have a mechanism to filter unwanted data.</span>
<span id="cb12-605"><a href="#cb12-605" aria-hidden="true" tabindex="-1"></a>To support this process in gatherplots, we provide an optional mechanism to go back to the original continuous linear scale function.</span>
<span id="cb12-606"><a href="#cb12-606" aria-hidden="true" tabindex="-1"></a>We allow each axis tick have an interactive control to be filtered out (minimize) or focused (maximized).</span>
<span id="cb12-607"><a href="#cb12-607" aria-hidden="true" tabindex="-1"></a>This is called *axis folding*, because it can be illustrated by folding a paper.</span>
<span id="cb12-608"><a href="#cb12-608" aria-hidden="true" tabindex="-1"></a>When minimized or folded, the visualization space is shrunk by applying linear scales instead of non-linear gather scales.</span>
<span id="cb12-609"><a href="#cb12-609" aria-hidden="true" tabindex="-1"></a>This results in overplotting, as if a scatterplot was used for that axis.</span>
<span id="cb12-610"><a href="#cb12-610" aria-hidden="true" tabindex="-1"></a>Maximization simply folds all other values except the value of the interest to assign maximum visual space to that value.</span>
<span id="cb12-611"><a href="#cb12-611" aria-hidden="true" tabindex="-1"></a>@fig-axis-folding shows axis folding applied to second class adult passengers in the Titanic dataset.</span>
<span id="cb12-612"><a href="#cb12-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-613"><a href="#cb12-613" aria-hidden="true" tabindex="-1"></a>::: {#fig-axis-folding}</span>
<span id="cb12-614"><a href="#cb12-614" aria-hidden="true" tabindex="-1"></a><span class="al">![](figures/axis-folding.svg)</span>{fig-alt="Gatherplot showing the passengers  of the *Titanic*. Class (First, Second, Third, Crew) has been mapped to the X axis and Age (Child, Adult) to the Y axis. Color is used for the boarding Port; Cherbourg, Belfast, Southhampton, and Queenstown. Child, Second Class, and Crew has been minized to not show details. First and Third Class Adults are showing as large blocks of marks organized in an orderly grid. For the first class, the Ports are mostly evenly distributed. For Third Class, most of them boarded in Southhampton."}</span>
<span id="cb12-615"><a href="#cb12-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-616"><a href="#cb12-616" aria-hidden="true" tabindex="-1"></a>**Survivors of the *Titanic* using gatherplots.**</span>
<span id="cb12-617"><a href="#cb12-617" aria-hidden="true" tabindex="-1"></a>The X axis is class of passengers, where second class passengers and crew are minimized (indicated by the single tick marks). </span>
<span id="cb12-618"><a href="#cb12-618" aria-hidden="true" tabindex="-1"></a>The Y axis is age, where the adult value is maximized (the child value has a single tick mark, indicating it is minimized).</span>
<span id="cb12-619"><a href="#cb12-619" aria-hidden="true" tabindex="-1"></a>This view makes it easy to compare first class adults and third class adults. </span>
<span id="cb12-620"><a href="#cb12-620" aria-hidden="true" tabindex="-1"></a>Note that even in the minimized state, we can get an overview about the second class and crew by the color line, which communicates the underlying distribution.</span>
<span id="cb12-621"><a href="#cb12-621" aria-hidden="true" tabindex="-1"></a>This is due to sorting over the color dimension.</span>
<span id="cb12-622"><a href="#cb12-622" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-623"><a href="#cb12-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-624"><a href="#cb12-624" aria-hidden="true" tabindex="-1"></a><span class="fu">### Implementation</span></span>
<span id="cb12-625"><a href="#cb12-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-626"><a href="#cb12-626" aria-hidden="true" tabindex="-1"></a>We have implemented a web-based demonstration of gatherplots using <span class="co">[</span><span class="ot">D3</span><span class="co">](http://www.d3js.org)</span> and <span class="co">[</span><span class="ot">Angular</span><span class="co">](http://www.angular.org)</span>.</span>
<span id="cb12-627"><a href="#cb12-627" aria-hidden="true" tabindex="-1"></a>The prototype allows users to load various datasets into a gatherplot.</span>
<span id="cb12-628"><a href="#cb12-628" aria-hidden="true" tabindex="-1"></a>The visualization can be compared to scatterplots and jittered scatterplots with a single click.</span>
<span id="cb12-629"><a href="#cb12-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-630"><a href="#cb12-630" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ========================================================================== --&gt;</span></span>
<span id="cb12-631"><a href="#cb12-631" aria-hidden="true" tabindex="-1"></a><span class="fu">## Evaluation {#sec-eval}</span></span>
<span id="cb12-632"><a href="#cb12-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-633"><a href="#cb12-633" aria-hidden="true" tabindex="-1"></a>This study was designed to demonstrate the effectiveness of gatherplots, in particular its different layout modes with categorical vs. categorical variables.</span>
<span id="cb12-634"><a href="#cb12-634" aria-hidden="true" tabindex="-1"></a>Crowdsourcing platforms have been widely used and have shown to be reliable platforms for evaluation studies <span class="co">[</span><span class="ot">@Paolacci2010; @Willett2013</span><span class="co">]</span>.</span>
<span id="cb12-635"><a href="#cb12-635" aria-hidden="true" tabindex="-1"></a>Therefore, we conducted our experiment on <span class="co">[</span><span class="ot">Amazon Mechanical Turk</span><span class="co">](https://www.mturk.com)</span>.</span>
<span id="cb12-636"><a href="#cb12-636" aria-hidden="true" tabindex="-1"></a>This also gave us the opportunity to study the utility of the technique for the general population, who do not have specific statistical training.</span>
<span id="cb12-637"><a href="#cb12-637" aria-hidden="true" tabindex="-1"></a>Research materials associated with the study can be found on OSF at <span class="co">[</span><span class="ot">https://osf.io/bk9cx/</span><span class="co">](https://osf.io/bk9cx/)</span>.</span>
<span id="cb12-638"><a href="#cb12-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-639"><a href="#cb12-639" aria-hidden="true" tabindex="-1"></a><span class="fu">### Experimental Design</span></span>
<span id="cb12-640"><a href="#cb12-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-641"><a href="#cb12-641" aria-hidden="true" tabindex="-1"></a>We selected jittered scatterplots as the baseline condition, as this technique is a widely accepted standard technique maintaining consistency with scatterplots.</span>
<span id="cb12-642"><a href="#cb12-642" aria-hidden="true" tabindex="-1"></a>We also wanted to measure the efficiency of different modes of gatherplots.</span>
<span id="cb12-643"><a href="#cb12-643" aria-hidden="true" tabindex="-1"></a>Therefore, we designed the experiment to have four conditions: scatterplots with jittering (jitter), gatherplots with absolute mode (absolute), gatherplots with normalized mode (normalized), and gatherplots with a toggle to switch between absolute and normalized mode (both).</span>
<span id="cb12-644"><a href="#cb12-644" aria-hidden="true" tabindex="-1"></a>We adopted a between-subjects design to eliminate learning effects from experiencing other modes.</span>
<span id="cb12-645"><a href="#cb12-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-646"><a href="#cb12-646" aria-hidden="true" tabindex="-1"></a><span class="fu">### Participants</span></span>
<span id="cb12-647"><a href="#cb12-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-648"><a href="#cb12-648" aria-hidden="true" tabindex="-1"></a>A total of 240 participants (103 female) completed our survey.</span>
<span id="cb12-649"><a href="#cb12-649" aria-hidden="true" tabindex="-1"></a>Participants were compensated for their time and labor with compensation consistent with the U.S. federal minimum wage ($7.25/hour at the time of research).</span>
<span id="cb12-650"><a href="#cb12-650" aria-hidden="true" tabindex="-1"></a>Because some questions asked about concepts of absolute numbers and probability, we limited participants to the United States to reduce the influence of language.</span>
<span id="cb12-651"><a href="#cb12-651" aria-hidden="true" tabindex="-1"></a>To ensure the quality of the workers, the qualification of workers were the approval rate of more than 0.95 with number of hits approved to be more than 1,000.</span>
<span id="cb12-652"><a href="#cb12-652" aria-hidden="true" tabindex="-1"></a>Only three of 240 participants reported not using English as their first language.</span>
<span id="cb12-653"><a href="#cb12-653" aria-hidden="true" tabindex="-1"></a>119 people had more than bachelor's degree, with 42 people having a high school degree.</span>
<span id="cb12-654"><a href="#cb12-654" aria-hidden="true" tabindex="-1"></a>We filtered random clickers by removing any trials where the completion time was shorter than a reasonable time (5 seconds). </span>
<span id="cb12-655"><a href="#cb12-655" aria-hidden="true" tabindex="-1"></a>This yielded a total of 211 participants.</span>
<span id="cb12-656"><a href="#cb12-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-657"><a href="#cb12-657" aria-hidden="true" tabindex="-1"></a><span class="fu">### Task</span></span>
<span id="cb12-658"><a href="#cb12-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-659"><a href="#cb12-659" aria-hidden="true" tabindex="-1"></a>Scatterplots can support many types of tasks <span class="co">[</span><span class="ot">@DBLP:journals/tvcg/SarikayaG18</span><span class="co">]</span>.</span>
<span id="cb12-660"><a href="#cb12-660" aria-hidden="true" tabindex="-1"></a>Based on Sarikaya and Gleicher's analysis <span class="co">[</span><span class="ot">-@DBLP:journals/tvcg/SarikayaG18</span><span class="co">]</span>, we selected retrieving a value as a low-level task, and comparing and ranking as a high-level task.</span>
<span id="cb12-661"><a href="#cb12-661" aria-hidden="true" tabindex="-1"></a>For the comparing and ranking task, two different types of questions were asked: the tasks to consider absolute values such as frequency and tasks that consider relative values such as percentage.</span>
<span id="cb12-662"><a href="#cb12-662" aria-hidden="true" tabindex="-1"></a>Therefore, for one visualization, 5 different questions were generated.</span>
<span id="cb12-663"><a href="#cb12-663" aria-hidden="true" tabindex="-1"></a>For gatherplots, our interest is in the difference between task considering absolute values and relative values.</span>
<span id="cb12-664"><a href="#cb12-664" aria-hidden="true" tabindex="-1"></a>The five tasks are as follows:</span>
<span id="cb12-665"><a href="#cb12-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-666"><a href="#cb12-666" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**T1**: retrieve value considering one subgroup.</span>
<span id="cb12-667"><a href="#cb12-667" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**T2**: comparing absolute size of subgroup between groups.</span>
<span id="cb12-668"><a href="#cb12-668" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**T3**: ranking absolute size of subgroup between groups.</span>
<span id="cb12-669"><a href="#cb12-669" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**T4**: comparing relative size of subgroup between groups.</span>
<span id="cb12-670"><a href="#cb12-670" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**T5**: ranking relative size of subgroup between groups.</span>
<span id="cb12-671"><a href="#cb12-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-672"><a href="#cb12-672" aria-hidden="true" tabindex="-1"></a>To reduce the chance of one chart being optimal by luck for a specific task, two charts of same problem structure were provided.</span>
<span id="cb12-673"><a href="#cb12-673" aria-hidden="true" tabindex="-1"></a>This yielded a total of 10 questions for each participant.</span>
<span id="cb12-674"><a href="#cb12-674" aria-hidden="true" tabindex="-1"></a>Each question was followed by the question asking confidence of estimation with a 7-point Likert scale, and the time spent for each question was measured.</span>
<span id="cb12-675"><a href="#cb12-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-676"><a href="#cb12-676" aria-hidden="true" tabindex="-1"></a>::: {#fig-study layout-ncol=1}</span>
<span id="cb12-677"><a href="#cb12-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-678"><a href="#cb12-678" aria-hidden="true" tabindex="-1"></a><span class="al">![The Gatherplot stimulus and the task; this is a relative comparison task (**T4**).](figures/study1.png)</span>{#fig-study1 fig-alt="Screenshot of a survey question with a gatherplot visualizing the Titanic passenger dataset on top and a question at the bottom. The gatherplot shows Class (First, Second, Third, Crew) on the X axis and Sex (Female, Male) on the Y axis. This yields a grid with two rows and four columns. Marks are colored based on whether they survived or not; cyan for yes, and blue for no. Marks are freely sized to fill the available size in each grid cell. The question at the bottom says 'Among the four groups, the number of female survivors are the highest in first class.' The options are Agree, Disagree, or Don't Know/Can't Determine. In particular, in the First Class Female grid cell, there is an absolutely majority of cyan cells with only very few blue cells. The proportion of cyan cells is much lower for the Male First Class passengenrs, indicating that the statement is true." .accessible-fig}</span>
<span id="cb12-679"><a href="#cb12-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-680"><a href="#cb12-680" aria-hidden="true" tabindex="-1"></a><span class="al">![The confidence question as a 7-point Likert scale.](figures/study2.png)</span>{#fig-study2 fig-alt="Screenshot of a multiple-choice question with seven choices as a radio button, representing a Likert-scale question. The question reads 'Please select how much you agree or disagree with the following statement: I am confident of my estimation.' The options are Strongly Disagree, Disagree, Somewhat Disagree, Neither Agree/Disagree, Somewhat Agree, Agree, Strongly Agree." .accessible-fig}</span>
<span id="cb12-681"><a href="#cb12-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-682"><a href="#cb12-682" aria-hidden="true" tabindex="-1"></a>**Example study screenshot.**</span>
<span id="cb12-683"><a href="#cb12-683" aria-hidden="true" tabindex="-1"></a>The study consisted of a total of 10 questions, each asked on a screen like this.</span>
<span id="cb12-684"><a href="#cb12-684" aria-hidden="true" tabindex="-1"></a>A full example survey is shown in the supplemental material on OSF.</span>
<span id="cb12-685"><a href="#cb12-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-686"><a href="#cb12-686" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-687"><a href="#cb12-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-688"><a href="#cb12-688" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dataset</span></span>
<span id="cb12-689"><a href="#cb12-689" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-690"><a href="#cb12-690" aria-hidden="true" tabindex="-1"></a>We used a dataset on the survivors of the sinking of the *Titanic* in 1912.</span>
<span id="cb12-691"><a href="#cb12-691" aria-hidden="true" tabindex="-1"></a>Each of the 2,201 survivors had four dimensions, which were all categorical variables: <span class="in">`class`</span> (4 levels), <span class="in">`sex`</span> (2 levels), <span class="in">`port of entry`</span> (4 levels), and <span class="in">`survival status`</span> (2 levels).</span>
<span id="cb12-692"><a href="#cb12-692" aria-hidden="true" tabindex="-1"></a>The five tasks above were asked for two views with different dimensions.</span>
<span id="cb12-693"><a href="#cb12-693" aria-hidden="true" tabindex="-1"></a>One view visualized class on X-axis, sex on Y-axis, and survival using color.</span>
<span id="cb12-694"><a href="#cb12-694" aria-hidden="true" tabindex="-1"></a>The second view visualized survived on the X-axis, class on the Y-axis, and port of entry using color.</span>
<span id="cb12-695"><a href="#cb12-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-696"><a href="#cb12-696" aria-hidden="true" tabindex="-1"></a>@fig-study shows an example study stimulus screen for the *Titanic* dataset using a normalized (space-filling) gatherplot for task **T4**.</span>
<span id="cb12-697"><a href="#cb12-697" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">OSF</span><span class="co">](https://osf.io/bk9cx/)</span> repository contains a file <span class="in">`qualtrics-study.pdf`</span> showing a full run of an experiment (10 questions).</span>
<span id="cb12-698"><a href="#cb12-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-699"><a href="#cb12-699" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hypotheses</span></span>
<span id="cb12-700"><a href="#cb12-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-701"><a href="#cb12-701" aria-hidden="true" tabindex="-1"></a>We believe that different types of tasks will favor from different type of layouts.</span>
<span id="cb12-702"><a href="#cb12-702" aria-hidden="true" tabindex="-1"></a>Therefore, our hypotheses are as follows:</span>
<span id="cb12-703"><a href="#cb12-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-704"><a href="#cb12-704" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**H1** - For retrieving value considering one subgroup (T1), both absolute and normalized modes will yield better accuracy than jitter mode.</span>
<span id="cb12-705"><a href="#cb12-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-706"><a href="#cb12-706" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**H2** - For tasks considering absolute values (T2 and T3), absolute mode will yield the best accuracy over other modes.</span>
<span id="cb12-707"><a href="#cb12-707" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-708"><a href="#cb12-708" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**H3** - For tasks considering relative values (T4 and T5), normalized mode will yield the best accuracy over other modes.</span>
<span id="cb12-709"><a href="#cb12-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-710"><a href="#cb12-710" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results</span></span>
<span id="cb12-711"><a href="#cb12-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-712"><a href="#cb12-712" aria-hidden="true" tabindex="-1"></a>The results were analyzed with respect to the accuracy (correct or incorrect), time spent, and confidence of estimation.</span>
<span id="cb12-713"><a href="#cb12-713" aria-hidden="true" tabindex="-1"></a>Based on our hypotheses, we analyzed the different modes of layout for each type of question: retrieve value, absolute value task, and relative value task.</span>
<span id="cb12-714"><a href="#cb12-714" aria-hidden="true" tabindex="-1"></a>In total, we recruited 42 participants for jitter, 56 participants for absolute, 56 participants for normalized, and 57 participants for interactive mode.</span>
<span id="cb12-715"><a href="#cb12-715" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">OSF</span><span class="co">](https://osf.io/bk9cx/)</span> repository contains code and data for replicating our data analysis.</span>
<span id="cb12-716"><a href="#cb12-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-717"><a href="#cb12-717" aria-hidden="true" tabindex="-1"></a>::: {#fig-results layout-ncol=3}</span>
<span id="cb12-718"><a href="#cb12-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-719"><a href="#cb12-719" aria-hidden="true" tabindex="-1"></a><span class="al">![Accuracy.](plots/vis-accuracy.svg)</span>{#fig-vis-accuracy fig-alt="Accuracy dotplot showing jitter with an accuracy around 0.45; the rest (absolute, normalized, both) are around 0.6."}</span>
<span id="cb12-720"><a href="#cb12-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-721"><a href="#cb12-721" aria-hidden="true" tabindex="-1"></a><span class="al">![Completion time.](plots/vis-time.svg)</span>{#fig-vis-time fig-alt="Completion time dotplot showing jitter with a time around 32 seconds, absolute and normalized around 36 seconds, and both around 48 seconds."}</span>
<span id="cb12-722"><a href="#cb12-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-723"><a href="#cb12-723" aria-hidden="true" tabindex="-1"></a><span class="al">![Perceived confidence.](plots/vis-confidence.svg)</span>{#fig-vis-confidence fig-alt="Perceived confidence dotplot showing jitter and normalized with a confidence around 5 and absolute and both around 5.5 (1--7 Likert scale)."}</span>
<span id="cb12-724"><a href="#cb12-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-725"><a href="#cb12-725" aria-hidden="true" tabindex="-1"></a>**Performance results.**</span>
<span id="cb12-726"><a href="#cb12-726" aria-hidden="true" tabindex="-1"></a>Effect of visualization on accuracy, completion time, and perceived confidence.</span>
<span id="cb12-727"><a href="#cb12-727" aria-hidden="true" tabindex="-1"></a>Error bars show 95\% confidence intervals calculated using bootstrapping ($N=1,000$ repetitions).}</span>
<span id="cb12-728"><a href="#cb12-728" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-729"><a href="#cb12-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-730"><a href="#cb12-730" aria-hidden="true" tabindex="-1"></a>::: {#fig-results-detail layout-ncol=3}</span>
<span id="cb12-731"><a href="#cb12-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-732"><a href="#cb12-732" aria-hidden="true" tabindex="-1"></a><span class="al">![Accuracy.](plots/taskxvis-accuracy.svg)</span>{#fig-taskxvis-accuracy fig-alt="Accuracy dotplot showing jitter, absolute, normalized, and both for tasks T1--T5."}</span>
<span id="cb12-733"><a href="#cb12-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-734"><a href="#cb12-734" aria-hidden="true" tabindex="-1"></a><span class="al">![Completion time.](plots/taskxvis-time.svg)</span>{#fig-taskxvis-time fig-alt="Completion time dotplot showing jitter, absolute, normalized, and both for tasks T1--T5."}</span>
<span id="cb12-735"><a href="#cb12-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-736"><a href="#cb12-736" aria-hidden="true" tabindex="-1"></a><span class="al">![Perceived confidence.](plots/taskxvis-confidence.svg)</span>{#fig-taskxvis-confidence fig-alt="Perceived confidence dotplot showing jitter, absolute, normalized, and both for tasks T1--T5."}</span>
<span id="cb12-737"><a href="#cb12-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-738"><a href="#cb12-738" aria-hidden="true" tabindex="-1"></a>**Detailed performance results.**</span>
<span id="cb12-739"><a href="#cb12-739" aria-hidden="true" tabindex="-1"></a>Effect of visualization and task (T1--T5) on accuracy, completion time, and perceived confidence.</span>
<span id="cb12-740"><a href="#cb12-740" aria-hidden="true" tabindex="-1"></a>Error bars show 95\% confidence intervals calculated using bootstrapping ($N=1,000$ repetitions).</span>
<span id="cb12-741"><a href="#cb12-741" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-742"><a href="#cb12-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-743"><a href="#cb12-743" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Accuracy</span></span>
<span id="cb12-744"><a href="#cb12-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-745"><a href="#cb12-745" aria-hidden="true" tabindex="-1"></a>Accuracy performance results are summarized in @fig-vis-accuracy, with detailed accuracy results by visualization type and task in @fig-taskxvis-accuracy.</span>
<span id="cb12-746"><a href="#cb12-746" aria-hidden="true" tabindex="-1"></a>The number and percentage of participants who answered correct and incorrect answers are shown in @fig-correctness.</span>
<span id="cb12-747"><a href="#cb12-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-748"><a href="#cb12-748" aria-hidden="true" tabindex="-1"></a>Based on the effect sizes and 95% confidence intervals, we see evidence that jittering yielded lower accuracy than other conditions, which were more or less equivalent in accuracy.</span>
<span id="cb12-749"><a href="#cb12-749" aria-hidden="true" tabindex="-1"></a>This trend seems to mostly persist across all five tasks.</span>
<span id="cb12-750"><a href="#cb12-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-751"><a href="#cb12-751" aria-hidden="true" tabindex="-1"></a>::: {#fig-correctness layout-ncol=2}</span>
<span id="cb12-752"><a href="#cb12-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-753"><a href="#cb12-753" aria-hidden="true" tabindex="-1"></a><span class="al">![Task T1.](plots/task-performance-1.svg)</span>{#fig-correctness1 fig-alt="Correctness results from our crowdsourced user study."}</span>
<span id="cb12-754"><a href="#cb12-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-755"><a href="#cb12-755" aria-hidden="true" tabindex="-1"></a><span class="al">![Task T2.](plots/task-performance-2.svg)</span>{#fig-correctness2 fig-alt="Correctness results from our crowdsourced user study."}</span>
<span id="cb12-756"><a href="#cb12-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-757"><a href="#cb12-757" aria-hidden="true" tabindex="-1"></a><span class="al">![Task T3.](plots/task-performance-3.svg)</span>{#fig-correctness3 fig-alt="Correctness results from our crowdsourced user study."}</span>
<span id="cb12-758"><a href="#cb12-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-759"><a href="#cb12-759" aria-hidden="true" tabindex="-1"></a><span class="al">![Task T4.](plots/task-performance-4.svg)</span>{#fig-correctness4 fig-alt="Correctness results from our crowdsourced user study."}</span>
<span id="cb12-760"><a href="#cb12-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-761"><a href="#cb12-761" aria-hidden="true" tabindex="-1"></a><span class="al">![Task T5.](plots/task-performance-5.svg)</span>{#fig-correctness5 fig-alt="Correctness results from our crowdsourced user study."}</span>
<span id="cb12-762"><a href="#cb12-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-763"><a href="#cb12-763" aria-hidden="true" tabindex="-1"></a>**Correctness results from our crowdsourced user study.**</span>
<span id="cb12-764"><a href="#cb12-764" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">-@fig-correctness1</span><span class="co">]</span> Correctness for retrieving value (T1).</span>
<span id="cb12-765"><a href="#cb12-765" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">-@fig-correctness2</span><span class="co">]</span> Correctness for absolute comparison (T2).</span>
<span id="cb12-766"><a href="#cb12-766" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">-@fig-correctness3</span><span class="co">]</span> Corrnectness for absolute ranking (T3).</span>
<span id="cb12-767"><a href="#cb12-767" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">-@fig-correctness4</span><span class="co">]</span> Correctness for relative/normalized comparison (T4).</span>
<span id="cb12-768"><a href="#cb12-768" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">-@fig-correctness5</span><span class="co">]</span> Correctness for relative/normalized ranking (T5).</span>
<span id="cb12-769"><a href="#cb12-769" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-770"><a href="#cb12-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-771"><a href="#cb12-771" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Completion Time</span></span>
<span id="cb12-772"><a href="#cb12-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-773"><a href="#cb12-773" aria-hidden="true" tabindex="-1"></a>Completion time performance results are summarized in @fig-vis-time, with detailed accuracy results by visualization type and task in @fig-taskxvis-time.</span>
<span id="cb12-774"><a href="#cb12-774" aria-hidden="true" tabindex="-1"></a>For the retrieve-value task (T1), on average, the completion time (sec) for each interface was for jitter 31.79, absolute 36.83, normalized 36.55, and both 49.21.</span>
<span id="cb12-775"><a href="#cb12-775" aria-hidden="true" tabindex="-1"></a>For the absolute-value task (T2 and T3), on average, the completion time (sec) for each interface was for jitter 29.45, absolute 37.98, normalized 34.84, and both 50.73.</span>
<span id="cb12-776"><a href="#cb12-776" aria-hidden="true" tabindex="-1"></a>For relative-value task (T4 and T5), on average, the completion time for each interface was for jitter 31.77, absolute 32.27, normalized 34.95, and both 46.60.</span>
<span id="cb12-777"><a href="#cb12-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-778"><a href="#cb12-778" aria-hidden="true" tabindex="-1"></a>Based on the results, we see evidence that the both condition (absolute and normalized accessed using a toggle) yielded longer completion times than the other conditions, although this is not consistent across tasks.</span>
<span id="cb12-779"><a href="#cb12-779" aria-hidden="true" tabindex="-1"></a>There is also some evidence that jitter on average yielded a shorter completion time, but again not consistently across all five tasks.</span>
<span id="cb12-780"><a href="#cb12-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-781"><a href="#cb12-781" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Confidence</span></span>
<span id="cb12-782"><a href="#cb12-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-783"><a href="#cb12-783" aria-hidden="true" tabindex="-1"></a>The participants self-reported level of confidence was reported using a 7-point Likert-scale rating.</span>
<span id="cb12-784"><a href="#cb12-784" aria-hidden="true" tabindex="-1"></a>Confidence performance results are summarized in @fig-vis-confidence, with detailed accuracy results by visualization type and task in @fig-taskxvis-confidence.</span>
<span id="cb12-785"><a href="#cb12-785" aria-hidden="true" tabindex="-1"></a>This data shows some evidence that jittering and normalized mode instilled lower confidence than absolute and both modes.</span>
<span id="cb12-786"><a href="#cb12-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-787"><a href="#cb12-787" aria-hidden="true" tabindex="-1"></a>For the value-retrieving task (T1), a Kruskal-Wallis non-parametric test revealed that the type of interface had significant impact on the confidence level ($\chi^2(3) = 74.57 p &lt; 0.01$).</span>
<span id="cb12-788"><a href="#cb12-788" aria-hidden="true" tabindex="-1"></a>The mean rating for each interface was for jitter 4.8, absolute 6.3, normalized 6.0, and both 6.25.</span>
<span id="cb12-789"><a href="#cb12-789" aria-hidden="true" tabindex="-1"></a>A post-hoc Pairwise Wilcoxon Rank Sum test was employed with Bonferroni correction to adjust for multiple comparisons.</span>
<span id="cb12-790"><a href="#cb12-790" aria-hidden="true" tabindex="-1"></a>The jitter interface was significantly lower than the other three modes ($ p &lt; 0.01$ for all cases).</span>
<span id="cb12-791"><a href="#cb12-791" aria-hidden="true" tabindex="-1"></a>There was no difference between absolute, normalized, and both interfaces.</span>
<span id="cb12-792"><a href="#cb12-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-793"><a href="#cb12-793" aria-hidden="true" tabindex="-1"></a>For absolute-value tasks (T2 and T3), a Kruskal-Wallis non-parametric test revealed that the type of interface had significant impact on the confidence level ($\chi^2(3) = 18.32, p &lt; 0.01$).</span>
<span id="cb12-794"><a href="#cb12-794" aria-hidden="true" tabindex="-1"></a>The mean rating for each interface was jitter 5.4, absolute 5.7, normalized 5.0, and both 5.8.</span>
<span id="cb12-795"><a href="#cb12-795" aria-hidden="true" tabindex="-1"></a>A post-hoc Pairwise Wilcoxon Rank Sum test was employed with Bonferroni correction to adjust for multiple comparisons.</span>
<span id="cb12-796"><a href="#cb12-796" aria-hidden="true" tabindex="-1"></a>The interface with both modes was significantly higher than normalized and jitter mode ($p &lt; 0.01$ for both); however, there was no difference with the absolute mode.</span>
<span id="cb12-797"><a href="#cb12-797" aria-hidden="true" tabindex="-1"></a>The interface with absolute mode was significantly higher than normalized and jitter mode ($p &lt; 0.01$).</span>
<span id="cb12-798"><a href="#cb12-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-799"><a href="#cb12-799" aria-hidden="true" tabindex="-1"></a>For relative-value tasks (T4 and T5), a Kruskal-Wallis non-parametric test revealed that the type of interface did not have significant impact on the relative tasks ($\chi^2(3) = 4.1, p = 0.2$).</span>
<span id="cb12-800"><a href="#cb12-800" aria-hidden="true" tabindex="-1"></a>The mean rating was jitter 4.7, absolute 4.9, relative 4.9, and both 4.8.</span>
<span id="cb12-801"><a href="#cb12-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-802"><a href="#cb12-802" aria-hidden="true" tabindex="-1"></a>One possibility for explaining this result is that the relative task is more difficult than the other tasks.</span>
<span id="cb12-803"><a href="#cb12-803" aria-hidden="true" tabindex="-1"></a>The low correct percentage of questions are also shown in @fig-correctness.</span>
<span id="cb12-804"><a href="#cb12-804" aria-hidden="true" tabindex="-1"></a>To see that, we tested the confidence level between task types.</span>
<span id="cb12-805"><a href="#cb12-805" aria-hidden="true" tabindex="-1"></a>A Kruskal-Wallis non-parametric test revealed that the type of task had significant impact on the confidence level ($\chi^2(2) = 148.1, p &lt; 0.01$).</span>
<span id="cb12-806"><a href="#cb12-806" aria-hidden="true" tabindex="-1"></a>The mean rating for retrieving value 5.9, absolute 5.5, and normalized 4.8.</span>
<span id="cb12-807"><a href="#cb12-807" aria-hidden="true" tabindex="-1"></a>The post-hoc Pairwise Wilcoxon Rank Sum test was employed with Bonferroni correction to adjust for multiple comparisons, and showed that all three task types were significantly different ($p &lt; 0.01$ for all cases).</span>
<span id="cb12-808"><a href="#cb12-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-809"><a href="#cb12-809" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ========================================================================== --&gt;</span></span>
<span id="cb12-810"><a href="#cb12-810" aria-hidden="true" tabindex="-1"></a><span class="fu">## Discussion</span></span>
<span id="cb12-811"><a href="#cb12-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-812"><a href="#cb12-812" aria-hidden="true" tabindex="-1"></a>Our results show that the gatherplots technique enable people to assess data distribution more quickly and more correctly than when using jittered scatterplots.</span>
<span id="cb12-813"><a href="#cb12-813" aria-hidden="true" tabindex="-1"></a>It is plausible that the ordered grid layout used for marks in the gatherplots technique better supports quickly estimating (or even counting) the marks compared to merely randomly jittering the points.</span>
<span id="cb12-814"><a href="#cb12-814" aria-hidden="true" tabindex="-1"></a>However, there are several limitations to this work that may affect its generalizability and overall utility.</span>
<span id="cb12-815"><a href="#cb12-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-816"><a href="#cb12-816" aria-hidden="true" tabindex="-1"></a>By virtue of being a unit visualization <span class="co">[</span><span class="ot">@Park2018</span><span class="co">]</span>, where each data point is assigned a unique visual mark, the gatherplots technique is not primarily designed for large scale datasets. </span>
<span id="cb12-817"><a href="#cb12-817" aria-hidden="true" tabindex="-1"></a>For situations with several thousands or more data points, the corresponding visual marks will become so small that they are not easily distinguishable as individual units.</span>
<span id="cb12-818"><a href="#cb12-818" aria-hidden="true" tabindex="-1"></a>Accordingly, the user study presented in this paper was limited to the Titanic dataset with only some 2,200 data points. </span>
<span id="cb12-819"><a href="#cb12-819" aria-hidden="true" tabindex="-1"></a>We suspect that many of these findings will not bear out for datasets only an order of magnitude larger.</span>
<span id="cb12-820"><a href="#cb12-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-821"><a href="#cb12-821" aria-hidden="true" tabindex="-1"></a>Analogously, gatherplots are not suitable for conveying datasets with a large number of data dimensions. </span>
<span id="cb12-822"><a href="#cb12-822" aria-hidden="true" tabindex="-1"></a>The technique is currently only designed with a single categorical dimension per geometric axis, plus one assigned to mark color.</span>
<span id="cb12-823"><a href="#cb12-823" aria-hidden="true" tabindex="-1"></a>The axes could presumably be subdivided into multiple categories, similar to the Dataopsy technique <span class="co">[</span><span class="ot">@DBLP:journals/tvcg/HoqueE24</span><span class="co">]</span>, but that is beyond the scope of this paper.</span>
<span id="cb12-824"><a href="#cb12-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-825"><a href="#cb12-825" aria-hidden="true" tabindex="-1"></a>We chose to include an interactive setting---``both''---in our experiment where participants were allowed to toggle between absolutel and normalized mode.</span>
<span id="cb12-826"><a href="#cb12-826" aria-hidden="true" tabindex="-1"></a>However, the results show that this condition yielded significantly longer completion times with little to no improvement in accuracy or confidence.</span>
<span id="cb12-827"><a href="#cb12-827" aria-hidden="true" tabindex="-1"></a>The increased completion time may not be a surprise because of the toggle interaction.</span>
<span id="cb12-828"><a href="#cb12-828" aria-hidden="true" tabindex="-1"></a>Furthermore, the fact that both absolute and normalized mode had no specific benefit in their own right also explains why their combination was also not superior.</span>
<span id="cb12-829"><a href="#cb12-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-830"><a href="#cb12-830" aria-hidden="true" tabindex="-1"></a>Finally, the gatherplots technique includes carefully designed interval marks to convey the fact that a gatherplot axis is partitioned rather than continuous.</span>
<span id="cb12-831"><a href="#cb12-831" aria-hidden="true" tabindex="-1"></a>Nevertheless, we have not evaluated the efficacy of this visual language.</span>
<span id="cb12-832"><a href="#cb12-832" aria-hidden="true" tabindex="-1"></a>Since regular scatterplots use continuous axes, it is not clear how well a novice user will grasp the partitioned nature of a gatherplot.</span>
<span id="cb12-833"><a href="#cb12-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-834"><a href="#cb12-834" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ========================================================================== --&gt;</span></span>
<span id="cb12-835"><a href="#cb12-835" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusion and Future Work</span></span>
<span id="cb12-836"><a href="#cb12-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-837"><a href="#cb12-837" aria-hidden="true" tabindex="-1"></a>We have proposed the concept of the gather transformation, which enables space-filling layout without overdrawing while maintaining object constancy.</span>
<span id="cb12-838"><a href="#cb12-838" aria-hidden="true" tabindex="-1"></a>We then applied this transformation to scatterplots, resulting in gatherplots, a generalization of scatterplots, which enable overview without clutter.</span>
<span id="cb12-839"><a href="#cb12-839" aria-hidden="true" tabindex="-1"></a>While gatherplots are optimal for categorical variables, it can also be used to ameliorate overplotting caused by continuous ordinal variables.</span>
<span id="cb12-840"><a href="#cb12-840" aria-hidden="true" tabindex="-1"></a>We discussed several aspects of gatherplots including layout, coloring, tick format, and matrix formations.</span>
<span id="cb12-841"><a href="#cb12-841" aria-hidden="true" tabindex="-1"></a>We also evaluated the technique with a crowdsourced user study showing that gatherplots are generally more effective than jittering, and absolute and relative mode serve specific types of tasks better.</span>
<span id="cb12-842"><a href="#cb12-842" aria-hidden="true" tabindex="-1"></a>Finally, we applied the gathering transformation to a Magic Lens interaction for local control; this lens has three different layout modes.</span>
<span id="cb12-843"><a href="#cb12-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-844"><a href="#cb12-844" aria-hidden="true" tabindex="-1"></a>We believe that gathering is a general framework that captures the transition between overlapping and space-filling visualizations while maintaining object identities.</span>
<span id="cb12-845"><a href="#cb12-845" aria-hidden="true" tabindex="-1"></a>In the future, we plan on studying the application of this framework to other visual representations.</span>
<span id="cb12-846"><a href="#cb12-846" aria-hidden="true" tabindex="-1"></a>For example, overplotting is a common problem when visualizing categorical variables in a parallel coordinates plot.</span>
<span id="cb12-847"><a href="#cb12-847" aria-hidden="true" tabindex="-1"></a>Parallel sets aggregate elements for the same value of a categorical variable into blocks, but loses the identity of objects.</span>
<span id="cb12-848"><a href="#cb12-848" aria-hidden="true" tabindex="-1"></a>By applying the gathering framework, parallel sets can be reconstructed to render individual lines instead of block lines, which would enable combining both categorical and continuous variables.</span>
<span id="cb12-849"><a href="#cb12-849" aria-hidden="true" tabindex="-1"></a>Furthermore, we also want to study additional gathering-based interaction techniques beyond the GatherLens proposed here.</span>
<span id="cb12-850"><a href="#cb12-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-851"><a href="#cb12-851" aria-hidden="true" tabindex="-1"></a><span class="fu">## References {.unnumbered}</span></span>
<span id="cb12-852"><a href="#cb12-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-853"><a href="#cb12-853" aria-hidden="true" tabindex="-1"></a>::: {#refs}</span>
<span id="cb12-854"><a href="#cb12-854" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-855"><a href="#cb12-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-856"><a href="#cb12-856" aria-hidden="true" tabindex="-1"></a><span class="fu">## Research Material Statements {.unnumbered}</span></span>
<span id="cb12-857"><a href="#cb12-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-858"><a href="#cb12-858" aria-hidden="true" tabindex="-1"></a>Source code for the web-based reference implementation of Gatherplots can be found at <span class="co">[</span><span class="ot">https://github.com/intuinno/gatherplot</span><span class="co">](https://github.com/intuinno/gatherplot)</span>.</span>
<span id="cb12-859"><a href="#cb12-859" aria-hidden="true" tabindex="-1"></a>A live demo of this implementation is linked at <span class="co">[</span><span class="ot">https://gatherplot.firebaseapp.com/</span><span class="co">](https://gatherplot.firebaseapp.com/)</span>.</span>
<span id="cb12-860"><a href="#cb12-860" aria-hidden="true" tabindex="-1"></a>This interactive article also contains a Gaterplot implementation.</span>
<span id="cb12-861"><a href="#cb12-861" aria-hidden="true" tabindex="-1"></a>The raw results from the crowdsourced user study (reported in @sec-eval) can be found on OSF at <span class="co">[</span><span class="ot">https://osf.io/bk9cx/</span><span class="co">](https://osf.io/bk9cx/)</span>.</span>
<span id="cb12-862"><a href="#cb12-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-863"><a href="#cb12-863" aria-hidden="true" tabindex="-1"></a><span class="fu">## Authorship {.unnumbered}</span></span>
<span id="cb12-864"><a href="#cb12-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-865"><a href="#cb12-865" aria-hidden="true" tabindex="-1"></a>**Deokgun Park**: Conceptualization, Investigation, Methodology, Software, Writing - Original Draft, Writing - Review &amp; Editing, Visualization.</span>
<span id="cb12-866"><a href="#cb12-866" aria-hidden="true" tabindex="-1"></a>**Sung-Hee Kim**: Data Curation, Formal Analysis, Investigation, Methodology, Validation, Visualization.</span>
<span id="cb12-867"><a href="#cb12-867" aria-hidden="true" tabindex="-1"></a>**Niklas Elmqvist**: Conceptualization, Investigation, Methodology, Software, Supervision, Writing - Original Draft, Writing - Review &amp; Editing, Visualization.</span>
<span id="cb12-868"><a href="#cb12-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-869"><a href="#cb12-869" aria-hidden="true" tabindex="-1"></a><span class="fu">## License {.unnumbered}</span></span>
<span id="cb12-870"><a href="#cb12-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-871"><a href="#cb12-871" aria-hidden="true" tabindex="-1"></a>This work is licensed under a <span class="co">[</span><span class="ot">Creative Commons Attribution 4.0 International License</span><span class="co">](https://creativecommons.org/licenses/by/4.0/)</span>.</span>
<span id="cb12-872"><a href="#cb12-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-873"><a href="#cb12-873" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conflict of Interest {.unnumbered}</span></span>
<span id="cb12-874"><a href="#cb12-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-875"><a href="#cb12-875" aria-hidden="true" tabindex="-1"></a>At the time of submission, **Niklas Elmqvist** is listed as an associate editor for the <span class="co">[</span><span class="ot">Journal of Visualization and Interaction</span><span class="co">](https://www.journalovi.org/)</span>.</span>
<span id="cb12-876"><a href="#cb12-876" aria-hidden="true" tabindex="-1"></a>The authors declare that there are no other competing interests.</span>
<span id="cb12-877"><a href="#cb12-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-880"><a href="#cb12-880" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb12-881"><a href="#cb12-881" aria-hidden="true" tabindex="-1"></a><span class="in">cars = FileAttachment("cars.csv").csv({ typed: true })</span></span>
<span id="cb12-882"><a href="#cb12-882" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-883"><a href="#cb12-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-886"><a href="#cb12-886" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb12-887"><a href="#cb12-887" aria-hidden="true" tabindex="-1"></a><span class="in">import {Legend, Swatches} from "@d3/color-legend"</span></span>
<span id="cb12-888"><a href="#cb12-888" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-889"><a href="#cb12-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-890"><a href="#cb12-890" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--</span></span>
<span id="cb12-891"><a href="#cb12-891" aria-hidden="true" tabindex="-1"></a><span class="co">// Copyright 2021 Observable, Inc.</span></span>
<span id="cb12-892"><a href="#cb12-892" aria-hidden="true" tabindex="-1"></a><span class="co">// Released under the ISC license.</span></span>
<span id="cb12-893"><a href="#cb12-893" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@d3/scatterplot</span></span>
<span id="cb12-894"><a href="#cb12-894" aria-hidden="true" tabindex="-1"></a><span class="co">--&gt;</span> </span>
<span id="cb12-897"><a href="#cb12-897" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb12-898"><a href="#cb12-898" aria-hidden="true" tabindex="-1"></a><span class="in">function Scatterplot(data, {</span></span>
<span id="cb12-899"><a href="#cb12-899" aria-hidden="true" tabindex="-1"></a><span class="in">  x = ([x]) =&gt; x, // given d in data, returns the (quantitative) x-value</span></span>
<span id="cb12-900"><a href="#cb12-900" aria-hidden="true" tabindex="-1"></a><span class="in">  y = ([, y]) =&gt; y, // given d in data, returns the (quantitative) y-value</span></span>
<span id="cb12-901"><a href="#cb12-901" aria-hidden="true" tabindex="-1"></a><span class="in">  c = ([, , c]) =&gt; c,</span></span>
<span id="cb12-902"><a href="#cb12-902" aria-hidden="true" tabindex="-1"></a><span class="in">  r = 3, // (fixed) radius of dots, in pixels</span></span>
<span id="cb12-903"><a href="#cb12-903" aria-hidden="true" tabindex="-1"></a><span class="in">  title, // given d in data, returns the title</span></span>
<span id="cb12-904"><a href="#cb12-904" aria-hidden="true" tabindex="-1"></a><span class="in">  marginTop = 20, // top margin, in pixels</span></span>
<span id="cb12-905"><a href="#cb12-905" aria-hidden="true" tabindex="-1"></a><span class="in">  marginRight = 30, // right margin, in pixels</span></span>
<span id="cb12-906"><a href="#cb12-906" aria-hidden="true" tabindex="-1"></a><span class="in">  marginBottom = 30, // bottom margin, in pixels</span></span>
<span id="cb12-907"><a href="#cb12-907" aria-hidden="true" tabindex="-1"></a><span class="in">  marginLeft = 40, // left margin, in pixels</span></span>
<span id="cb12-908"><a href="#cb12-908" aria-hidden="true" tabindex="-1"></a><span class="in">  inset = r * 2, // inset the default range, in pixels</span></span>
<span id="cb12-909"><a href="#cb12-909" aria-hidden="true" tabindex="-1"></a><span class="in">  insetTop = inset, // inset the default y-range</span></span>
<span id="cb12-910"><a href="#cb12-910" aria-hidden="true" tabindex="-1"></a><span class="in">  insetRight = inset, // inset the default x-range</span></span>
<span id="cb12-911"><a href="#cb12-911" aria-hidden="true" tabindex="-1"></a><span class="in">  insetBottom = inset, // inset the default y-range</span></span>
<span id="cb12-912"><a href="#cb12-912" aria-hidden="true" tabindex="-1"></a><span class="in">  insetLeft = inset, // inset the default x-range</span></span>
<span id="cb12-913"><a href="#cb12-913" aria-hidden="true" tabindex="-1"></a><span class="in">  width = 640, // outer width, in pixels</span></span>
<span id="cb12-914"><a href="#cb12-914" aria-hidden="true" tabindex="-1"></a><span class="in">  height = 400, // outer height, in pixels</span></span>
<span id="cb12-915"><a href="#cb12-915" aria-hidden="true" tabindex="-1"></a><span class="in">  xType = d3.scaleLinear, // type of x-scale</span></span>
<span id="cb12-916"><a href="#cb12-916" aria-hidden="true" tabindex="-1"></a><span class="in">  xDomain, // [xmin, xmax]</span></span>
<span id="cb12-917"><a href="#cb12-917" aria-hidden="true" tabindex="-1"></a><span class="in">  xRange = [marginLeft + insetLeft, width - marginRight - insetRight], // [left, right]</span></span>
<span id="cb12-918"><a href="#cb12-918" aria-hidden="true" tabindex="-1"></a><span class="in">  yType = d3.scaleLinear, // type of y-scale</span></span>
<span id="cb12-919"><a href="#cb12-919" aria-hidden="true" tabindex="-1"></a><span class="in">  yDomain, // [ymin, ymax]</span></span>
<span id="cb12-920"><a href="#cb12-920" aria-hidden="true" tabindex="-1"></a><span class="in">  yRange = [height - marginBottom - insetBottom, marginTop + insetTop], // [bottom, top]</span></span>
<span id="cb12-921"><a href="#cb12-921" aria-hidden="true" tabindex="-1"></a><span class="in">  cType = d3.scaleOrdinal,</span></span>
<span id="cb12-922"><a href="#cb12-922" aria-hidden="true" tabindex="-1"></a><span class="in">  cRange = d3.schemeCategory10,</span></span>
<span id="cb12-923"><a href="#cb12-923" aria-hidden="true" tabindex="-1"></a><span class="in">  xLabel, // a label for the x-axis</span></span>
<span id="cb12-924"><a href="#cb12-924" aria-hidden="true" tabindex="-1"></a><span class="in">  yLabel, // a label for the y-axis</span></span>
<span id="cb12-925"><a href="#cb12-925" aria-hidden="true" tabindex="-1"></a><span class="in">  xFormat, // a format specifier string for the x-axis</span></span>
<span id="cb12-926"><a href="#cb12-926" aria-hidden="true" tabindex="-1"></a><span class="in">  yFormat, // a format specifier string for the y-axis</span></span>
<span id="cb12-927"><a href="#cb12-927" aria-hidden="true" tabindex="-1"></a><span class="in">  jitter = () =&gt; 0.0,</span></span>
<span id="cb12-928"><a href="#cb12-928" aria-hidden="true" tabindex="-1"></a><span class="in">  fill = "none", // fill color for dots</span></span>
<span id="cb12-929"><a href="#cb12-929" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke = "currentColor", // stroke color for the dots</span></span>
<span id="cb12-930"><a href="#cb12-930" aria-hidden="true" tabindex="-1"></a><span class="in">  strokeWidth = 1.5, // stroke width for dots</span></span>
<span id="cb12-931"><a href="#cb12-931" aria-hidden="true" tabindex="-1"></a><span class="in">  halo = "#fff", // color of label halo</span></span>
<span id="cb12-932"><a href="#cb12-932" aria-hidden="true" tabindex="-1"></a><span class="in">  haloWidth = 3 // padding around the labels</span></span>
<span id="cb12-933"><a href="#cb12-933" aria-hidden="true" tabindex="-1"></a><span class="in">} = {}) {</span></span>
<span id="cb12-934"><a href="#cb12-934" aria-hidden="true" tabindex="-1"></a><span class="in">  // Compute values.</span></span>
<span id="cb12-935"><a href="#cb12-935" aria-hidden="true" tabindex="-1"></a><span class="in">  const X = d3.map(data, x);</span></span>
<span id="cb12-936"><a href="#cb12-936" aria-hidden="true" tabindex="-1"></a><span class="in">  const Y = d3.map(data, y);</span></span>
<span id="cb12-937"><a href="#cb12-937" aria-hidden="true" tabindex="-1"></a><span class="in">  const C = d3.map(data, c);</span></span>
<span id="cb12-938"><a href="#cb12-938" aria-hidden="true" tabindex="-1"></a><span class="in">  const T = title == null ? null : d3.map(data, title);</span></span>
<span id="cb12-939"><a href="#cb12-939" aria-hidden="true" tabindex="-1"></a><span class="in">  const I = d3.range(X.length).filter(i =&gt; !isNaN(X[i]) &amp;&amp; !isNaN(Y[i]));</span></span>
<span id="cb12-940"><a href="#cb12-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-941"><a href="#cb12-941" aria-hidden="true" tabindex="-1"></a><span class="in">  // Compute default domains.</span></span>
<span id="cb12-942"><a href="#cb12-942" aria-hidden="true" tabindex="-1"></a><span class="in">  if (xDomain === undefined) xDomain = d3.extent(X);</span></span>
<span id="cb12-943"><a href="#cb12-943" aria-hidden="true" tabindex="-1"></a><span class="in">  if (yDomain === undefined) yDomain = d3.extent(Y);</span></span>
<span id="cb12-944"><a href="#cb12-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-945"><a href="#cb12-945" aria-hidden="true" tabindex="-1"></a><span class="in">  // Construct scales and axes.</span></span>
<span id="cb12-946"><a href="#cb12-946" aria-hidden="true" tabindex="-1"></a><span class="in">  const xScale = xType(xDomain, xRange);</span></span>
<span id="cb12-947"><a href="#cb12-947" aria-hidden="true" tabindex="-1"></a><span class="in">  const yScale = yType(yDomain, yRange);</span></span>
<span id="cb12-948"><a href="#cb12-948" aria-hidden="true" tabindex="-1"></a><span class="in">  const cScale = cType(cRange);</span></span>
<span id="cb12-949"><a href="#cb12-949" aria-hidden="true" tabindex="-1"></a><span class="in">  const xAxis = d3.axisBottom(xScale).ticks(width / 80, xFormat);</span></span>
<span id="cb12-950"><a href="#cb12-950" aria-hidden="true" tabindex="-1"></a><span class="in">  const yAxis = d3.axisLeft(yScale).ticks(height / 50, yFormat);</span></span>
<span id="cb12-951"><a href="#cb12-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-952"><a href="#cb12-952" aria-hidden="true" tabindex="-1"></a><span class="in">  const svg = d3.create("svg")</span></span>
<span id="cb12-953"><a href="#cb12-953" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("width", width)</span></span>
<span id="cb12-954"><a href="#cb12-954" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("height", height)</span></span>
<span id="cb12-955"><a href="#cb12-955" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("viewBox", [0, 0, width, height])</span></span>
<span id="cb12-956"><a href="#cb12-956" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("style", "max-width: 100%; height: auto; height: intrinsic;");</span></span>
<span id="cb12-957"><a href="#cb12-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-958"><a href="#cb12-958" aria-hidden="true" tabindex="-1"></a><span class="in">  svg.append("g")</span></span>
<span id="cb12-959"><a href="#cb12-959" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("transform", `translate(0,${height - marginBottom})`)</span></span>
<span id="cb12-960"><a href="#cb12-960" aria-hidden="true" tabindex="-1"></a><span class="in">      .call(xAxis)</span></span>
<span id="cb12-961"><a href="#cb12-961" aria-hidden="true" tabindex="-1"></a><span class="in">      .call(g =&gt; g.select(".domain").remove())</span></span>
<span id="cb12-962"><a href="#cb12-962" aria-hidden="true" tabindex="-1"></a><span class="in">      .call(g =&gt; g.selectAll(".tick line").clone()</span></span>
<span id="cb12-963"><a href="#cb12-963" aria-hidden="true" tabindex="-1"></a><span class="in">          .attr("y2", marginTop + marginBottom - height)</span></span>
<span id="cb12-964"><a href="#cb12-964" aria-hidden="true" tabindex="-1"></a><span class="in">          .attr("stroke-opacity", 0.1))</span></span>
<span id="cb12-965"><a href="#cb12-965" aria-hidden="true" tabindex="-1"></a><span class="in">      .call(g =&gt; g.append("text")</span></span>
<span id="cb12-966"><a href="#cb12-966" aria-hidden="true" tabindex="-1"></a><span class="in">          .attr("x", width)</span></span>
<span id="cb12-967"><a href="#cb12-967" aria-hidden="true" tabindex="-1"></a><span class="in">          .attr("y", marginBottom - 4)</span></span>
<span id="cb12-968"><a href="#cb12-968" aria-hidden="true" tabindex="-1"></a><span class="in">          .attr("fill", "currentColor")</span></span>
<span id="cb12-969"><a href="#cb12-969" aria-hidden="true" tabindex="-1"></a><span class="in">          .attr("text-anchor", "end")</span></span>
<span id="cb12-970"><a href="#cb12-970" aria-hidden="true" tabindex="-1"></a><span class="in">          .text(xLabel));</span></span>
<span id="cb12-971"><a href="#cb12-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-972"><a href="#cb12-972" aria-hidden="true" tabindex="-1"></a><span class="in">  svg.append("g")</span></span>
<span id="cb12-973"><a href="#cb12-973" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("transform", `translate(${marginLeft},0)`)</span></span>
<span id="cb12-974"><a href="#cb12-974" aria-hidden="true" tabindex="-1"></a><span class="in">      .call(yAxis)</span></span>
<span id="cb12-975"><a href="#cb12-975" aria-hidden="true" tabindex="-1"></a><span class="in">      .call(g =&gt; g.select(".domain").remove())</span></span>
<span id="cb12-976"><a href="#cb12-976" aria-hidden="true" tabindex="-1"></a><span class="in">      .call(g =&gt; g.selectAll(".tick line").clone()</span></span>
<span id="cb12-977"><a href="#cb12-977" aria-hidden="true" tabindex="-1"></a><span class="in">          .attr("x2", width - marginLeft - marginRight)</span></span>
<span id="cb12-978"><a href="#cb12-978" aria-hidden="true" tabindex="-1"></a><span class="in">          .attr("stroke-opacity", 0.1))</span></span>
<span id="cb12-979"><a href="#cb12-979" aria-hidden="true" tabindex="-1"></a><span class="in">      .call(g =&gt; g.append("text")</span></span>
<span id="cb12-980"><a href="#cb12-980" aria-hidden="true" tabindex="-1"></a><span class="in">          .attr("x", -marginLeft)</span></span>
<span id="cb12-981"><a href="#cb12-981" aria-hidden="true" tabindex="-1"></a><span class="in">          .attr("y", 10)</span></span>
<span id="cb12-982"><a href="#cb12-982" aria-hidden="true" tabindex="-1"></a><span class="in">          .attr("fill", "currentColor")</span></span>
<span id="cb12-983"><a href="#cb12-983" aria-hidden="true" tabindex="-1"></a><span class="in">          .attr("text-anchor", "start")</span></span>
<span id="cb12-984"><a href="#cb12-984" aria-hidden="true" tabindex="-1"></a><span class="in">          .text(yLabel));</span></span>
<span id="cb12-985"><a href="#cb12-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-986"><a href="#cb12-986" aria-hidden="true" tabindex="-1"></a><span class="in">  if (T) svg.append("g")</span></span>
<span id="cb12-987"><a href="#cb12-987" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("font-family", "sans-serif")</span></span>
<span id="cb12-988"><a href="#cb12-988" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("font-size", 10)</span></span>
<span id="cb12-989"><a href="#cb12-989" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("stroke-linejoin", "round")</span></span>
<span id="cb12-990"><a href="#cb12-990" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("stroke-linecap", "round")</span></span>
<span id="cb12-991"><a href="#cb12-991" aria-hidden="true" tabindex="-1"></a><span class="in">    .selectAll("text")</span></span>
<span id="cb12-992"><a href="#cb12-992" aria-hidden="true" tabindex="-1"></a><span class="in">    .data(I)</span></span>
<span id="cb12-993"><a href="#cb12-993" aria-hidden="true" tabindex="-1"></a><span class="in">    .join("text")</span></span>
<span id="cb12-994"><a href="#cb12-994" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("dx", 7)</span></span>
<span id="cb12-995"><a href="#cb12-995" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("dy", "0.35em")</span></span>
<span id="cb12-996"><a href="#cb12-996" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("x", i =&gt; xScale(X[i]))</span></span>
<span id="cb12-997"><a href="#cb12-997" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("y", i =&gt; yScale(Y[i]))</span></span>
<span id="cb12-998"><a href="#cb12-998" aria-hidden="true" tabindex="-1"></a><span class="in">      .text(i =&gt; T[i])</span></span>
<span id="cb12-999"><a href="#cb12-999" aria-hidden="true" tabindex="-1"></a><span class="in">      .call(text =&gt; text.clone(true))</span></span>
<span id="cb12-1000"><a href="#cb12-1000" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("fill", "none")</span></span>
<span id="cb12-1001"><a href="#cb12-1001" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("stroke", halo)</span></span>
<span id="cb12-1002"><a href="#cb12-1002" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("stroke-width", haloWidth);</span></span>
<span id="cb12-1003"><a href="#cb12-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1004"><a href="#cb12-1004" aria-hidden="true" tabindex="-1"></a><span class="in">  svg.append("g")</span></span>
<span id="cb12-1005"><a href="#cb12-1005" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("fill", fill)</span></span>
<span id="cb12-1006"><a href="#cb12-1006" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("stroke", stroke)</span></span>
<span id="cb12-1007"><a href="#cb12-1007" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("stroke-width", strokeWidth)</span></span>
<span id="cb12-1008"><a href="#cb12-1008" aria-hidden="true" tabindex="-1"></a><span class="in">    .selectAll("circle")</span></span>
<span id="cb12-1009"><a href="#cb12-1009" aria-hidden="true" tabindex="-1"></a><span class="in">    .data(I)</span></span>
<span id="cb12-1010"><a href="#cb12-1010" aria-hidden="true" tabindex="-1"></a><span class="in">    .join("circle")</span></span>
<span id="cb12-1011"><a href="#cb12-1011" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("cx", i =&gt; xScale(X[i]) + jitter())</span></span>
<span id="cb12-1012"><a href="#cb12-1012" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("cy", i =&gt; yScale(Y[i]) + jitter())</span></span>
<span id="cb12-1013"><a href="#cb12-1013" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("stroke", i =&gt; cScale(C[i]))</span></span>
<span id="cb12-1014"><a href="#cb12-1014" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("r", r);</span></span>
<span id="cb12-1015"><a href="#cb12-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1016"><a href="#cb12-1016" aria-hidden="true" tabindex="-1"></a><span class="in">  return svg.node();</span></span>
<span id="cb12-1017"><a href="#cb12-1017" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb12-1018"><a href="#cb12-1018" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-1019"><a href="#cb12-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1022"><a href="#cb12-1022" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb12-1023"><a href="#cb12-1023" aria-hidden="true" tabindex="-1"></a><span class="in">function binCategorical(data, accessor) {</span></span>
<span id="cb12-1024"><a href="#cb12-1024" aria-hidden="true" tabindex="-1"></a><span class="in">  let bins = [];</span></span>
<span id="cb12-1025"><a href="#cb12-1025" aria-hidden="true" tabindex="-1"></a><span class="in">  data.forEach(v =&gt; {</span></span>
<span id="cb12-1026"><a href="#cb12-1026" aria-hidden="true" tabindex="-1"></a><span class="in">    let elem = bins.findIndex(bin =&gt; bin.v === accessor(v));</span></span>
<span id="cb12-1027"><a href="#cb12-1027" aria-hidden="true" tabindex="-1"></a><span class="in">    if (elem === -1) {</span></span>
<span id="cb12-1028"><a href="#cb12-1028" aria-hidden="true" tabindex="-1"></a><span class="in">      bins.push([]);</span></span>
<span id="cb12-1029"><a href="#cb12-1029" aria-hidden="true" tabindex="-1"></a><span class="in">      elem = bins.length - 1;</span></span>
<span id="cb12-1030"><a href="#cb12-1030" aria-hidden="true" tabindex="-1"></a><span class="in">      bins[elem].v = accessor(v);</span></span>
<span id="cb12-1031"><a href="#cb12-1031" aria-hidden="true" tabindex="-1"></a><span class="in">      bins[elem].x0 = accessor(v);</span></span>
<span id="cb12-1032"><a href="#cb12-1032" aria-hidden="true" tabindex="-1"></a><span class="in">      bins[elem].x1 = accessor(v);</span></span>
<span id="cb12-1033"><a href="#cb12-1033" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb12-1034"><a href="#cb12-1034" aria-hidden="true" tabindex="-1"></a><span class="in">    bins[elem].push(v);</span></span>
<span id="cb12-1035"><a href="#cb12-1035" aria-hidden="true" tabindex="-1"></a><span class="in">  });</span></span>
<span id="cb12-1036"><a href="#cb12-1036" aria-hidden="true" tabindex="-1"></a><span class="in">  return bins;</span></span>
<span id="cb12-1037"><a href="#cb12-1037" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb12-1038"><a href="#cb12-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1039"><a href="#cb12-1039" aria-hidden="true" tabindex="-1"></a><span class="in">function findIntersections(xBins, yBins) {</span></span>
<span id="cb12-1040"><a href="#cb12-1040" aria-hidden="true" tabindex="-1"></a><span class="in">  let plotBins = [];</span></span>
<span id="cb12-1041"><a href="#cb12-1041" aria-hidden="true" tabindex="-1"></a><span class="in">  xBins.forEach(xBin =&gt; {</span></span>
<span id="cb12-1042"><a href="#cb12-1042" aria-hidden="true" tabindex="-1"></a><span class="in">    yBins.forEach(yBin =&gt; {</span></span>
<span id="cb12-1043"><a href="#cb12-1043" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb12-1044"><a href="#cb12-1044" aria-hidden="true" tabindex="-1"></a><span class="in">      // Add this plot bin</span></span>
<span id="cb12-1045"><a href="#cb12-1045" aria-hidden="true" tabindex="-1"></a><span class="in">      let last = plotBins.push([]);</span></span>
<span id="cb12-1046"><a href="#cb12-1046" aria-hidden="true" tabindex="-1"></a><span class="in">      plotBins[last - 1].x0 = xBin.x0;</span></span>
<span id="cb12-1047"><a href="#cb12-1047" aria-hidden="true" tabindex="-1"></a><span class="in">      plotBins[last - 1].x1 = xBin.x1;</span></span>
<span id="cb12-1048"><a href="#cb12-1048" aria-hidden="true" tabindex="-1"></a><span class="in">      plotBins[last - 1].y0 = yBin.x0;</span></span>
<span id="cb12-1049"><a href="#cb12-1049" aria-hidden="true" tabindex="-1"></a><span class="in">      plotBins[last - 1].y1 = yBin.x1</span></span>
<span id="cb12-1050"><a href="#cb12-1050" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb12-1051"><a href="#cb12-1051" aria-hidden="true" tabindex="-1"></a><span class="in">      // Add the intersected elements</span></span>
<span id="cb12-1052"><a href="#cb12-1052" aria-hidden="true" tabindex="-1"></a><span class="in">      const intersection = xBin.filter(value =&gt; yBin.includes(value));</span></span>
<span id="cb12-1053"><a href="#cb12-1053" aria-hidden="true" tabindex="-1"></a><span class="in">      plotBins[last - 1].push(...intersection);</span></span>
<span id="cb12-1054"><a href="#cb12-1054" aria-hidden="true" tabindex="-1"></a><span class="in">    });</span></span>
<span id="cb12-1055"><a href="#cb12-1055" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb12-1056"><a href="#cb12-1056" aria-hidden="true" tabindex="-1"></a><span class="in">  });</span></span>
<span id="cb12-1057"><a href="#cb12-1057" aria-hidden="true" tabindex="-1"></a><span class="in">  return plotBins;</span></span>
<span id="cb12-1058"><a href="#cb12-1058" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb12-1059"><a href="#cb12-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1060"><a href="#cb12-1060" aria-hidden="true" tabindex="-1"></a><span class="in">function gatherColor(data) {</span></span>
<span id="cb12-1061"><a href="#cb12-1061" aria-hidden="true" tabindex="-1"></a><span class="in">  let cDomain = new Set(data);</span></span>
<span id="cb12-1062"><a href="#cb12-1062" aria-hidden="true" tabindex="-1"></a><span class="in">  if (cDomain.size &gt; 10 &amp;&amp; Number.isFinite(data[0])) {</span></span>
<span id="cb12-1063"><a href="#cb12-1063" aria-hidden="true" tabindex="-1"></a><span class="in">    return d3.scaleSequential()</span></span>
<span id="cb12-1064"><a href="#cb12-1064" aria-hidden="true" tabindex="-1"></a><span class="in">      .interpolator(d3.interpolateYlGnBu)    </span></span>
<span id="cb12-1065"><a href="#cb12-1065" aria-hidden="true" tabindex="-1"></a><span class="in">      .domain(d3.extent(data));</span></span>
<span id="cb12-1066"><a href="#cb12-1066" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb12-1067"><a href="#cb12-1067" aria-hidden="true" tabindex="-1"></a><span class="in">  else {</span></span>
<span id="cb12-1068"><a href="#cb12-1068" aria-hidden="true" tabindex="-1"></a><span class="in">    return d3.scaleOrdinal(d3.schemeCategory10)</span></span>
<span id="cb12-1069"><a href="#cb12-1069" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb12-1070"><a href="#cb12-1070" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb12-1071"><a href="#cb12-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1072"><a href="#cb12-1072" aria-hidden="true" tabindex="-1"></a><span class="in">function gather2D(data, {</span></span>
<span id="cb12-1073"><a href="#cb12-1073" aria-hidden="true" tabindex="-1"></a><span class="in">  x = ([x]) =&gt; x, // given d in data, returns the (quantitative) x-value</span></span>
<span id="cb12-1074"><a href="#cb12-1074" aria-hidden="true" tabindex="-1"></a><span class="in">  y = ([, y]) =&gt; y, // given d in data, returns the (quantitative) y-value</span></span>
<span id="cb12-1075"><a href="#cb12-1075" aria-hidden="true" tabindex="-1"></a><span class="in">} = {}) {</span></span>
<span id="cb12-1076"><a href="#cb12-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1077"><a href="#cb12-1077" aria-hidden="true" tabindex="-1"></a><span class="in">  // Extract the values</span></span>
<span id="cb12-1078"><a href="#cb12-1078" aria-hidden="true" tabindex="-1"></a><span class="in">  let values = iterable =&gt; new Set(iterable);</span></span>
<span id="cb12-1079"><a href="#cb12-1079" aria-hidden="true" tabindex="-1"></a><span class="in">  let xDomain = values(d3.map(data, x));</span></span>
<span id="cb12-1080"><a href="#cb12-1080" aria-hidden="true" tabindex="-1"></a><span class="in">  let yDomain = values(d3.map(data, y));</span></span>
<span id="cb12-1081"><a href="#cb12-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1082"><a href="#cb12-1082" aria-hidden="true" tabindex="-1"></a><span class="in">  // Bin the axes: numerical or categorical</span></span>
<span id="cb12-1083"><a href="#cb12-1083" aria-hidden="true" tabindex="-1"></a><span class="in">  let xBins, yBins;</span></span>
<span id="cb12-1084"><a href="#cb12-1084" aria-hidden="true" tabindex="-1"></a><span class="in">  if (xDomain.size &gt; 10) { </span></span>
<span id="cb12-1085"><a href="#cb12-1085" aria-hidden="true" tabindex="-1"></a><span class="in">    let bin = d3.bin().value(x);</span></span>
<span id="cb12-1086"><a href="#cb12-1086" aria-hidden="true" tabindex="-1"></a><span class="in">    xBins = bin(data);</span></span>
<span id="cb12-1087"><a href="#cb12-1087" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb12-1088"><a href="#cb12-1088" aria-hidden="true" tabindex="-1"></a><span class="in">  else {</span></span>
<span id="cb12-1089"><a href="#cb12-1089" aria-hidden="true" tabindex="-1"></a><span class="in">    xBins = binCategorical(data, x);    </span></span>
<span id="cb12-1090"><a href="#cb12-1090" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb12-1091"><a href="#cb12-1091" aria-hidden="true" tabindex="-1"></a><span class="in">  if (yDomain.size &gt; 10) { </span></span>
<span id="cb12-1092"><a href="#cb12-1092" aria-hidden="true" tabindex="-1"></a><span class="in">    let bin = d3.bin().value(y);</span></span>
<span id="cb12-1093"><a href="#cb12-1093" aria-hidden="true" tabindex="-1"></a><span class="in">    yBins = bin(data);</span></span>
<span id="cb12-1094"><a href="#cb12-1094" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb12-1095"><a href="#cb12-1095" aria-hidden="true" tabindex="-1"></a><span class="in">  else {</span></span>
<span id="cb12-1096"><a href="#cb12-1096" aria-hidden="true" tabindex="-1"></a><span class="in">    yBins = binCategorical(data, y);    </span></span>
<span id="cb12-1097"><a href="#cb12-1097" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb12-1098"><a href="#cb12-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1099"><a href="#cb12-1099" aria-hidden="true" tabindex="-1"></a><span class="in">  // Now find the intersections</span></span>
<span id="cb12-1100"><a href="#cb12-1100" aria-hidden="true" tabindex="-1"></a><span class="in">  return findIntersections(xBins, yBins);</span></span>
<span id="cb12-1101"><a href="#cb12-1101" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb12-1102"><a href="#cb12-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1103"><a href="#cb12-1103" aria-hidden="true" tabindex="-1"></a><span class="in">function GatherPlot(data, {</span></span>
<span id="cb12-1104"><a href="#cb12-1104" aria-hidden="true" tabindex="-1"></a><span class="in">  x = ([x]) =&gt; x, // given d in data, returns the x-value</span></span>
<span id="cb12-1105"><a href="#cb12-1105" aria-hidden="true" tabindex="-1"></a><span class="in">  y = ([, y]) =&gt; y, // given d in data, returns the y-value</span></span>
<span id="cb12-1106"><a href="#cb12-1106" aria-hidden="true" tabindex="-1"></a><span class="in">  c = ([, , c]) =&gt; c,</span></span>
<span id="cb12-1107"><a href="#cb12-1107" aria-hidden="true" tabindex="-1"></a><span class="in">  spacing = 4,</span></span>
<span id="cb12-1108"><a href="#cb12-1108" aria-hidden="true" tabindex="-1"></a><span class="in">  width = 640, // outer width, in pixels</span></span>
<span id="cb12-1109"><a href="#cb12-1109" aria-hidden="true" tabindex="-1"></a><span class="in">  height = 400, // outer height, in pixels</span></span>
<span id="cb12-1110"><a href="#cb12-1110" aria-hidden="true" tabindex="-1"></a><span class="in">  marginTop = 30, // top margin, in pixels</span></span>
<span id="cb12-1111"><a href="#cb12-1111" aria-hidden="true" tabindex="-1"></a><span class="in">  marginRight = 30, // right margin, in pixels</span></span>
<span id="cb12-1112"><a href="#cb12-1112" aria-hidden="true" tabindex="-1"></a><span class="in">  marginBottom = 30, // bottom margin, in pixels</span></span>
<span id="cb12-1113"><a href="#cb12-1113" aria-hidden="true" tabindex="-1"></a><span class="in">  marginLeft = 30, // left margin, in pixels</span></span>
<span id="cb12-1114"><a href="#cb12-1114" aria-hidden="true" tabindex="-1"></a><span class="in">  chartWidth = width - marginLeft - marginRight,</span></span>
<span id="cb12-1115"><a href="#cb12-1115" aria-hidden="true" tabindex="-1"></a><span class="in">  chartHeight = height - marginTop - marginBottom,</span></span>
<span id="cb12-1116"><a href="#cb12-1116" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke = 'none',</span></span>
<span id="cb12-1117"><a href="#cb12-1117" aria-hidden="true" tabindex="-1"></a><span class="in">  xSort = 1,</span></span>
<span id="cb12-1118"><a href="#cb12-1118" aria-hidden="true" tabindex="-1"></a><span class="in">  ySort = 1,</span></span>
<span id="cb12-1119"><a href="#cb12-1119" aria-hidden="true" tabindex="-1"></a><span class="in">  cSort = 0,</span></span>
<span id="cb12-1120"><a href="#cb12-1120" aria-hidden="true" tabindex="-1"></a><span class="in">} = {}) {</span></span>
<span id="cb12-1121"><a href="#cb12-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1122"><a href="#cb12-1122" aria-hidden="true" tabindex="-1"></a><span class="in">  // Find the intersection</span></span>
<span id="cb12-1123"><a href="#cb12-1123" aria-hidden="true" tabindex="-1"></a><span class="in">  let gatherBins = gather2D(data, {x: x, y: y});</span></span>
<span id="cb12-1124"><a href="#cb12-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1125"><a href="#cb12-1125" aria-hidden="true" tabindex="-1"></a><span class="in">  // Sort by the largest bin</span></span>
<span id="cb12-1126"><a href="#cb12-1126" aria-hidden="true" tabindex="-1"></a><span class="in">  gatherBins = gatherBins.sort((a, b) =&gt; b.length - a.length);</span></span>
<span id="cb12-1127"><a href="#cb12-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1128"><a href="#cb12-1128" aria-hidden="true" tabindex="-1"></a><span class="in">  // Starting with the largest, add the bins one by one to the plot</span></span>
<span id="cb12-1129"><a href="#cb12-1129" aria-hidden="true" tabindex="-1"></a><span class="in">  let aspect = chartWidth / chartHeight;</span></span>
<span id="cb12-1130"><a href="#cb12-1130" aria-hidden="true" tabindex="-1"></a><span class="in">  let cols = [];</span></span>
<span id="cb12-1131"><a href="#cb12-1131" aria-hidden="true" tabindex="-1"></a><span class="in">  let rows = [];</span></span>
<span id="cb12-1132"><a href="#cb12-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1133"><a href="#cb12-1133" aria-hidden="true" tabindex="-1"></a><span class="in">  gatherBins.forEach(v =&gt; {  </span></span>
<span id="cb12-1134"><a href="#cb12-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1135"><a href="#cb12-1135" aria-hidden="true" tabindex="-1"></a><span class="in">    let xDim, yDim;</span></span>
<span id="cb12-1136"><a href="#cb12-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1137"><a href="#cb12-1137" aria-hidden="true" tabindex="-1"></a><span class="in">    // Look up the rows and columns</span></span>
<span id="cb12-1138"><a href="#cb12-1138" aria-hidden="true" tabindex="-1"></a><span class="in">    let ndx = cols.findIndex(c =&gt; c.x0 === v.x0);</span></span>
<span id="cb12-1139"><a href="#cb12-1139" aria-hidden="true" tabindex="-1"></a><span class="in">    let ndy = rows.findIndex(r =&gt; r.y0 === v.y0);</span></span>
<span id="cb12-1140"><a href="#cb12-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1141"><a href="#cb12-1141" aria-hidden="true" tabindex="-1"></a><span class="in">    // Case 0: first cell placed</span></span>
<span id="cb12-1142"><a href="#cb12-1142" aria-hidden="true" tabindex="-1"></a><span class="in">    if (cols.length === 0 &amp;&amp; rows.length === 0) {</span></span>
<span id="cb12-1143"><a href="#cb12-1143" aria-hidden="true" tabindex="-1"></a><span class="in">      xDim = Math.ceil(Math.sqrt(aspect * data.length));</span></span>
<span id="cb12-1144"><a href="#cb12-1144" aria-hidden="true" tabindex="-1"></a><span class="in">      if (xDim &gt; v.length) xDim = v.length;</span></span>
<span id="cb12-1145"><a href="#cb12-1145" aria-hidden="true" tabindex="-1"></a><span class="in">      yDim = Math.ceil(v.length / xDim);</span></span>
<span id="cb12-1146"><a href="#cb12-1146" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb12-1147"><a href="#cb12-1147" aria-hidden="true" tabindex="-1"></a><span class="in">    // Case 1: no column or row given</span></span>
<span id="cb12-1148"><a href="#cb12-1148" aria-hidden="true" tabindex="-1"></a><span class="in">    else if (ndx === -1 &amp;&amp; ndy === -1) {</span></span>
<span id="cb12-1149"><a href="#cb12-1149" aria-hidden="true" tabindex="-1"></a><span class="in">      xDim = Math.ceil(Math.sqrt(aspect * v.length));</span></span>
<span id="cb12-1150"><a href="#cb12-1150" aria-hidden="true" tabindex="-1"></a><span class="in">      yDim = Math.ceil(v.length / xDim);</span></span>
<span id="cb12-1151"><a href="#cb12-1151" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb12-1152"><a href="#cb12-1152" aria-hidden="true" tabindex="-1"></a><span class="in">    // Case 2: no column given</span></span>
<span id="cb12-1153"><a href="#cb12-1153" aria-hidden="true" tabindex="-1"></a><span class="in">    else if (ndx === -1) {</span></span>
<span id="cb12-1154"><a href="#cb12-1154" aria-hidden="true" tabindex="-1"></a><span class="in">      yDim = rows[ndy].yDim;</span></span>
<span id="cb12-1155"><a href="#cb12-1155" aria-hidden="true" tabindex="-1"></a><span class="in">      xDim = Math.ceil(v.length / yDim);</span></span>
<span id="cb12-1156"><a href="#cb12-1156" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb12-1157"><a href="#cb12-1157" aria-hidden="true" tabindex="-1"></a><span class="in">    // Case 3: no row given</span></span>
<span id="cb12-1158"><a href="#cb12-1158" aria-hidden="true" tabindex="-1"></a><span class="in">    else if (ndy === -1) {</span></span>
<span id="cb12-1159"><a href="#cb12-1159" aria-hidden="true" tabindex="-1"></a><span class="in">      xDim = cols[ndx].xDim;</span></span>
<span id="cb12-1160"><a href="#cb12-1160" aria-hidden="true" tabindex="-1"></a><span class="in">      yDim = Math.ceil(v.length / xDim);</span></span>
<span id="cb12-1161"><a href="#cb12-1161" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb12-1162"><a href="#cb12-1162" aria-hidden="true" tabindex="-1"></a><span class="in">    // Case 4: both column and row given</span></span>
<span id="cb12-1163"><a href="#cb12-1163" aria-hidden="true" tabindex="-1"></a><span class="in">    else {</span></span>
<span id="cb12-1164"><a href="#cb12-1164" aria-hidden="true" tabindex="-1"></a><span class="in">      xDim = cols[ndx].xDim;</span></span>
<span id="cb12-1165"><a href="#cb12-1165" aria-hidden="true" tabindex="-1"></a><span class="in">      yDim = rows[ndy].yDim;</span></span>
<span id="cb12-1166"><a href="#cb12-1166" aria-hidden="true" tabindex="-1"></a><span class="in">      if (xDim * yDim &lt; v.length) {</span></span>
<span id="cb12-1167"><a href="#cb12-1167" aria-hidden="true" tabindex="-1"></a><span class="in">        yDim = Math.ceil(v.length / xDim);</span></span>
<span id="cb12-1168"><a href="#cb12-1168" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb12-1169"><a href="#cb12-1169" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb12-1170"><a href="#cb12-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1171"><a href="#cb12-1171" aria-hidden="true" tabindex="-1"></a><span class="in">    // Now add the missing columns and rows</span></span>
<span id="cb12-1172"><a href="#cb12-1172" aria-hidden="true" tabindex="-1"></a><span class="in">    if (ndx === -1) cols.push({ x0: v.x0, x1: v.x1, xDim: xDim });</span></span>
<span id="cb12-1173"><a href="#cb12-1173" aria-hidden="true" tabindex="-1"></a><span class="in">    if (ndy === -1) rows.push({ y0: v.y0, y1: v.y1, yDim: yDim });</span></span>
<span id="cb12-1174"><a href="#cb12-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1175"><a href="#cb12-1175" aria-hidden="true" tabindex="-1"></a><span class="in">    // Store the dimensions</span></span>
<span id="cb12-1176"><a href="#cb12-1176" aria-hidden="true" tabindex="-1"></a><span class="in">    v.xDim = xDim;</span></span>
<span id="cb12-1177"><a href="#cb12-1177" aria-hidden="true" tabindex="-1"></a><span class="in">    v.yDim = yDim;</span></span>
<span id="cb12-1178"><a href="#cb12-1178" aria-hidden="true" tabindex="-1"></a><span class="in">  });</span></span>
<span id="cb12-1179"><a href="#cb12-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1180"><a href="#cb12-1180" aria-hidden="true" tabindex="-1"></a><span class="in">  let cmp = (a, b) =&gt; {</span></span>
<span id="cb12-1181"><a href="#cb12-1181" aria-hidden="true" tabindex="-1"></a><span class="in">    if (a &lt; b) return -1;</span></span>
<span id="cb12-1182"><a href="#cb12-1182" aria-hidden="true" tabindex="-1"></a><span class="in">    if (a &gt; b) return 1;</span></span>
<span id="cb12-1183"><a href="#cb12-1183" aria-hidden="true" tabindex="-1"></a><span class="in">    return 0;</span></span>
<span id="cb12-1184"><a href="#cb12-1184" aria-hidden="true" tabindex="-1"></a><span class="in">  };</span></span>
<span id="cb12-1185"><a href="#cb12-1185" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb12-1186"><a href="#cb12-1186" aria-hidden="true" tabindex="-1"></a><span class="in">  // Sort the plots</span></span>
<span id="cb12-1187"><a href="#cb12-1187" aria-hidden="true" tabindex="-1"></a><span class="in">  gatherBins.sort((a, b) =&gt; {</span></span>
<span id="cb12-1188"><a href="#cb12-1188" aria-hidden="true" tabindex="-1"></a><span class="in">    let xRes =  xSort * cmp(a.x0, b.x0);</span></span>
<span id="cb12-1189"><a href="#cb12-1189" aria-hidden="true" tabindex="-1"></a><span class="in">    let yRes = -ySort * cmp(a.y0, b.y0);</span></span>
<span id="cb12-1190"><a href="#cb12-1190" aria-hidden="true" tabindex="-1"></a><span class="in">    if (xRes !== 0) return xRes;</span></span>
<span id="cb12-1191"><a href="#cb12-1191" aria-hidden="true" tabindex="-1"></a><span class="in">    return yRes;</span></span>
<span id="cb12-1192"><a href="#cb12-1192" aria-hidden="true" tabindex="-1"></a><span class="in">  });</span></span>
<span id="cb12-1193"><a href="#cb12-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1194"><a href="#cb12-1194" aria-hidden="true" tabindex="-1"></a><span class="in">  // Now figure out the maximum width and height </span></span>
<span id="cb12-1195"><a href="#cb12-1195" aria-hidden="true" tabindex="-1"></a><span class="in">  let itemCols = cols.reduce((acc, col) =&gt; acc + col.xDim, 0);</span></span>
<span id="cb12-1196"><a href="#cb12-1196" aria-hidden="true" tabindex="-1"></a><span class="in">  let itemRows = rows.reduce((acc, row) =&gt; acc + row.yDim, 0);</span></span>
<span id="cb12-1197"><a href="#cb12-1197" aria-hidden="true" tabindex="-1"></a><span class="in">  let itemWidth = (chartWidth - spacing * (cols.length - 1)) / itemCols;</span></span>
<span id="cb12-1198"><a href="#cb12-1198" aria-hidden="true" tabindex="-1"></a><span class="in">  let itemHeight = (chartHeight - spacing * (rows.length - 1)) / itemRows;</span></span>
<span id="cb12-1199"><a href="#cb12-1199" aria-hidden="true" tabindex="-1"></a><span class="in">  let itemSize = Math.min(itemWidth, itemHeight);</span></span>
<span id="cb12-1200"><a href="#cb12-1200" aria-hidden="true" tabindex="-1"></a><span class="in">  let xPadding = (chartWidth - itemSize * itemCols) / cols.length;</span></span>
<span id="cb12-1201"><a href="#cb12-1201" aria-hidden="true" tabindex="-1"></a><span class="in">  let yPadding = (chartHeight - itemSize * itemRows) / rows.length;</span></span>
<span id="cb12-1202"><a href="#cb12-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1203"><a href="#cb12-1203" aria-hidden="true" tabindex="-1"></a><span class="in">  // Now do the cell layout</span></span>
<span id="cb12-1204"><a href="#cb12-1204" aria-hidden="true" tabindex="-1"></a><span class="in">  cols.sort((a, b) =&gt;  xSort * cmp(a.x0, b.x0));</span></span>
<span id="cb12-1205"><a href="#cb12-1205" aria-hidden="true" tabindex="-1"></a><span class="in">  rows.sort((a, b) =&gt; -ySort * cmp(a.y0, b.y0));</span></span>
<span id="cb12-1206"><a href="#cb12-1206" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb12-1207"><a href="#cb12-1207" aria-hidden="true" tabindex="-1"></a><span class="in">  let posx = xPadding / 2;</span></span>
<span id="cb12-1208"><a href="#cb12-1208" aria-hidden="true" tabindex="-1"></a><span class="in">  for (let px = 0; px &lt; cols.length; px++) {</span></span>
<span id="cb12-1209"><a href="#cb12-1209" aria-hidden="true" tabindex="-1"></a><span class="in">    cols[px].x = posx;</span></span>
<span id="cb12-1210"><a href="#cb12-1210" aria-hidden="true" tabindex="-1"></a><span class="in">    cols[px].width = cols[px].xDim * itemSize;</span></span>
<span id="cb12-1211"><a href="#cb12-1211" aria-hidden="true" tabindex="-1"></a><span class="in">    posx += cols[px].width + xPadding;</span></span>
<span id="cb12-1212"><a href="#cb12-1212" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb12-1213"><a href="#cb12-1213" aria-hidden="true" tabindex="-1"></a><span class="in">  let posy = yPadding / 2;</span></span>
<span id="cb12-1214"><a href="#cb12-1214" aria-hidden="true" tabindex="-1"></a><span class="in">  for (let py = 0; py &lt; rows.length; py++) {</span></span>
<span id="cb12-1215"><a href="#cb12-1215" aria-hidden="true" tabindex="-1"></a><span class="in">    rows[py].y = posy;</span></span>
<span id="cb12-1216"><a href="#cb12-1216" aria-hidden="true" tabindex="-1"></a><span class="in">    rows[py].height = rows[py].yDim * itemSize;</span></span>
<span id="cb12-1217"><a href="#cb12-1217" aria-hidden="true" tabindex="-1"></a><span class="in">    posy += rows[py].height + yPadding;</span></span>
<span id="cb12-1218"><a href="#cb12-1218" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb12-1219"><a href="#cb12-1219" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb12-1220"><a href="#cb12-1220" aria-hidden="true" tabindex="-1"></a><span class="in">  // let posx = xPadding / 2;</span></span>
<span id="cb12-1221"><a href="#cb12-1221" aria-hidden="true" tabindex="-1"></a><span class="in">  for (let px = 0; px &lt; cols.length; px++) {</span></span>
<span id="cb12-1222"><a href="#cb12-1222" aria-hidden="true" tabindex="-1"></a><span class="in">    for (let py = 0; py &lt; rows.length; py++) {</span></span>
<span id="cb12-1223"><a href="#cb12-1223" aria-hidden="true" tabindex="-1"></a><span class="in">      let offset = px * rows.length + py;</span></span>
<span id="cb12-1224"><a href="#cb12-1224" aria-hidden="true" tabindex="-1"></a><span class="in">      gatherBins[offset].x = cols[px].x;</span></span>
<span id="cb12-1225"><a href="#cb12-1225" aria-hidden="true" tabindex="-1"></a><span class="in">      gatherBins[offset].y = rows[py].y;</span></span>
<span id="cb12-1226"><a href="#cb12-1226" aria-hidden="true" tabindex="-1"></a><span class="in">      gatherBins[offset].width = cols[px].width;</span></span>
<span id="cb12-1227"><a href="#cb12-1227" aria-hidden="true" tabindex="-1"></a><span class="in">      gatherBins[offset].height = rows[py].height;</span></span>
<span id="cb12-1228"><a href="#cb12-1228" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb12-1229"><a href="#cb12-1229" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb12-1230"><a href="#cb12-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1231"><a href="#cb12-1231" aria-hidden="true" tabindex="-1"></a><span class="in">  // Time to do in-cell layout</span></span>
<span id="cb12-1232"><a href="#cb12-1232" aria-hidden="true" tabindex="-1"></a><span class="in">  gatherBins.forEach(v =&gt; {</span></span>
<span id="cb12-1233"><a href="#cb12-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1234"><a href="#cb12-1234" aria-hidden="true" tabindex="-1"></a><span class="in">    // Sort the data based on color</span></span>
<span id="cb12-1235"><a href="#cb12-1235" aria-hidden="true" tabindex="-1"></a><span class="in">    if (cSort) v.sort((d1, d2) =&gt; cSort * cmp(c(d1), c(d2)));</span></span>
<span id="cb12-1236"><a href="#cb12-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1237"><a href="#cb12-1237" aria-hidden="true" tabindex="-1"></a><span class="in">    // Position tracking</span></span>
<span id="cb12-1238"><a href="#cb12-1238" aria-hidden="true" tabindex="-1"></a><span class="in">    let px = itemSize / 2.0;</span></span>
<span id="cb12-1239"><a href="#cb12-1239" aria-hidden="true" tabindex="-1"></a><span class="in">    let py = v.height - itemSize / 2.0;</span></span>
<span id="cb12-1240"><a href="#cb12-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1241"><a href="#cb12-1241" aria-hidden="true" tabindex="-1"></a><span class="in">    // Step through all of the points</span></span>
<span id="cb12-1242"><a href="#cb12-1242" aria-hidden="true" tabindex="-1"></a><span class="in">    v.forEach(d =&gt; {</span></span>
<span id="cb12-1243"><a href="#cb12-1243" aria-hidden="true" tabindex="-1"></a><span class="in">      d.cx = px;</span></span>
<span id="cb12-1244"><a href="#cb12-1244" aria-hidden="true" tabindex="-1"></a><span class="in">      d.cy = py;</span></span>
<span id="cb12-1245"><a href="#cb12-1245" aria-hidden="true" tabindex="-1"></a><span class="in">      d.r = itemSize / 2.0;</span></span>
<span id="cb12-1246"><a href="#cb12-1246" aria-hidden="true" tabindex="-1"></a><span class="in">      px += itemSize;</span></span>
<span id="cb12-1247"><a href="#cb12-1247" aria-hidden="true" tabindex="-1"></a><span class="in">      if (px &gt; v.width) {</span></span>
<span id="cb12-1248"><a href="#cb12-1248" aria-hidden="true" tabindex="-1"></a><span class="in">        px = itemSize / 2.0;</span></span>
<span id="cb12-1249"><a href="#cb12-1249" aria-hidden="true" tabindex="-1"></a><span class="in">        py -= itemSize;</span></span>
<span id="cb12-1250"><a href="#cb12-1250" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb12-1251"><a href="#cb12-1251" aria-hidden="true" tabindex="-1"></a><span class="in">    });</span></span>
<span id="cb12-1252"><a href="#cb12-1252" aria-hidden="true" tabindex="-1"></a><span class="in">  });</span></span>
<span id="cb12-1253"><a href="#cb12-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1254"><a href="#cb12-1254" aria-hidden="true" tabindex="-1"></a><span class="in">  const C = d3.map(data, c);</span></span>
<span id="cb12-1255"><a href="#cb12-1255" aria-hidden="true" tabindex="-1"></a><span class="in">  const cScale = gatherColor(C);</span></span>
<span id="cb12-1256"><a href="#cb12-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1257"><a href="#cb12-1257" aria-hidden="true" tabindex="-1"></a><span class="in">  const svg = d3.create("svg")</span></span>
<span id="cb12-1258"><a href="#cb12-1258" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("width", width)</span></span>
<span id="cb12-1259"><a href="#cb12-1259" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("height", height)</span></span>
<span id="cb12-1260"><a href="#cb12-1260" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("fill", 'none')</span></span>
<span id="cb12-1261"><a href="#cb12-1261" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("viewBox", [0, 0, width, height])</span></span>
<span id="cb12-1262"><a href="#cb12-1262" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("style", "max-width: 100%; height: auto; height: intrinsic;");</span></span>
<span id="cb12-1263"><a href="#cb12-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1264"><a href="#cb12-1264" aria-hidden="true" tabindex="-1"></a><span class="in">  const chart = svg.append("g")</span></span>
<span id="cb12-1265"><a href="#cb12-1265" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("stroke", stroke)</span></span>
<span id="cb12-1266"><a href="#cb12-1266" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("transform", d =&gt; `translate(${marginLeft},${marginTop})`)</span></span>
<span id="cb12-1267"><a href="#cb12-1267" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("fill", 'none')</span></span>
<span id="cb12-1268"><a href="#cb12-1268" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("stroke-width", '1.0');</span></span>
<span id="cb12-1269"><a href="#cb12-1269" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb12-1270"><a href="#cb12-1270" aria-hidden="true" tabindex="-1"></a><span class="in">  const groups = chart.append("g")</span></span>
<span id="cb12-1271"><a href="#cb12-1271" aria-hidden="true" tabindex="-1"></a><span class="in">    .selectAll("g")</span></span>
<span id="cb12-1272"><a href="#cb12-1272" aria-hidden="true" tabindex="-1"></a><span class="in">      .data(gatherBins)</span></span>
<span id="cb12-1273"><a href="#cb12-1273" aria-hidden="true" tabindex="-1"></a><span class="in">    .join("g")</span></span>
<span id="cb12-1274"><a href="#cb12-1274" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("transform", d =&gt; `translate(${d.x},${d.y})`);</span></span>
<span id="cb12-1275"><a href="#cb12-1275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1276"><a href="#cb12-1276" aria-hidden="true" tabindex="-1"></a><span class="in">  let points = groups.selectAll("circle")</span></span>
<span id="cb12-1277"><a href="#cb12-1277" aria-hidden="true" tabindex="-1"></a><span class="in">    .data(d =&gt; d)</span></span>
<span id="cb12-1278"><a href="#cb12-1278" aria-hidden="true" tabindex="-1"></a><span class="in">    .join("circle")</span></span>
<span id="cb12-1279"><a href="#cb12-1279" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("cx", d =&gt; d.cx)</span></span>
<span id="cb12-1280"><a href="#cb12-1280" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("cy", d =&gt; d.cy)</span></span>
<span id="cb12-1281"><a href="#cb12-1281" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("r", d =&gt; d.r)</span></span>
<span id="cb12-1282"><a href="#cb12-1282" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("fill", d =&gt; cScale(c(d)));</span></span>
<span id="cb12-1283"><a href="#cb12-1283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1284"><a href="#cb12-1284" aria-hidden="true" tabindex="-1"></a><span class="in">  let axis = svg.append('path')</span></span>
<span id="cb12-1285"><a href="#cb12-1285" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('stroke', 'black')</span></span>
<span id="cb12-1286"><a href="#cb12-1286" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('fill', 'none')</span></span>
<span id="cb12-1287"><a href="#cb12-1287" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('d', `M${marginLeft},${marginTop}V${height - marginBottom}H${width - marginRight}`);</span></span>
<span id="cb12-1288"><a href="#cb12-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1289"><a href="#cb12-1289" aria-hidden="true" tabindex="-1"></a><span class="in">  let horzBands = svg.append('g')</span></span>
<span id="cb12-1290"><a href="#cb12-1290" aria-hidden="true" tabindex="-1"></a><span class="in">    .selectAll('path')</span></span>
<span id="cb12-1291"><a href="#cb12-1291" aria-hidden="true" tabindex="-1"></a><span class="in">      .data(cols)</span></span>
<span id="cb12-1292"><a href="#cb12-1292" aria-hidden="true" tabindex="-1"></a><span class="in">    .join('path')</span></span>
<span id="cb12-1293"><a href="#cb12-1293" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr('stroke', 'black')</span></span>
<span id="cb12-1294"><a href="#cb12-1294" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr('stroke-width', 0.5)</span></span>
<span id="cb12-1295"><a href="#cb12-1295" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr('d', d =&gt; `M${d.x + marginLeft + d.width},${height - marginBottom}v10h${-d.width}`)</span></span>
<span id="cb12-1296"><a href="#cb12-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1297"><a href="#cb12-1297" aria-hidden="true" tabindex="-1"></a><span class="in">  let horzLabels = svg.append('g')</span></span>
<span id="cb12-1298"><a href="#cb12-1298" aria-hidden="true" tabindex="-1"></a><span class="in">    .selectAll('text')</span></span>
<span id="cb12-1299"><a href="#cb12-1299" aria-hidden="true" tabindex="-1"></a><span class="in">      .data(cols)</span></span>
<span id="cb12-1300"><a href="#cb12-1300" aria-hidden="true" tabindex="-1"></a><span class="in">    .join('text')</span></span>
<span id="cb12-1301"><a href="#cb12-1301" aria-hidden="true" tabindex="-1"></a><span class="in">      .text(d =&gt; d.x1)</span></span>
<span id="cb12-1302"><a href="#cb12-1302" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("text-anchor", "end")</span></span>
<span id="cb12-1303"><a href="#cb12-1303" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr('fill', 'black')</span></span>
<span id="cb12-1304"><a href="#cb12-1304" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr('x', d =&gt; d.x + marginLeft + d.width)</span></span>
<span id="cb12-1305"><a href="#cb12-1305" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr('y', height - 2.0);</span></span>
<span id="cb12-1306"><a href="#cb12-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1307"><a href="#cb12-1307" aria-hidden="true" tabindex="-1"></a><span class="in">  let vertBands = svg.append('g')</span></span>
<span id="cb12-1308"><a href="#cb12-1308" aria-hidden="true" tabindex="-1"></a><span class="in">    .selectAll('path')</span></span>
<span id="cb12-1309"><a href="#cb12-1309" aria-hidden="true" tabindex="-1"></a><span class="in">      .data(rows)</span></span>
<span id="cb12-1310"><a href="#cb12-1310" aria-hidden="true" tabindex="-1"></a><span class="in">    .join('path')</span></span>
<span id="cb12-1311"><a href="#cb12-1311" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr('stroke', 'black')</span></span>
<span id="cb12-1312"><a href="#cb12-1312" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr('stroke-width', 0.5)</span></span>
<span id="cb12-1313"><a href="#cb12-1313" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr('d', d =&gt; `M${marginLeft},${d.y + marginTop}h-10v${d.height}`);</span></span>
<span id="cb12-1314"><a href="#cb12-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1315"><a href="#cb12-1315" aria-hidden="true" tabindex="-1"></a><span class="in">  let vertLabels = svg.append('g')</span></span>
<span id="cb12-1316"><a href="#cb12-1316" aria-hidden="true" tabindex="-1"></a><span class="in">    .selectAll('text')</span></span>
<span id="cb12-1317"><a href="#cb12-1317" aria-hidden="true" tabindex="-1"></a><span class="in">      .data(rows)</span></span>
<span id="cb12-1318"><a href="#cb12-1318" aria-hidden="true" tabindex="-1"></a><span class="in">    .join('text')</span></span>
<span id="cb12-1319"><a href="#cb12-1319" aria-hidden="true" tabindex="-1"></a><span class="in">      .text(d =&gt; d.y1)</span></span>
<span id="cb12-1320"><a href="#cb12-1320" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr("text-anchor", "start")</span></span>
<span id="cb12-1321"><a href="#cb12-1321" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr('fill', 'black')</span></span>
<span id="cb12-1322"><a href="#cb12-1322" aria-hidden="true" tabindex="-1"></a><span class="in">      .attr('transform', d =&gt; `translate(2,${d.y + marginTop})rotate(90)`);</span></span>
<span id="cb12-1323"><a href="#cb12-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-1324"><a href="#cb12-1324" aria-hidden="true" tabindex="-1"></a><span class="in">  return svg.node();</span></span>
<span id="cb12-1325"><a href="#cb12-1325" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb12-1326"><a href="#cb12-1326" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>